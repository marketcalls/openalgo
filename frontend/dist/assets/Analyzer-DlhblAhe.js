import{r as n,j as e}from"./vendor-react-RhKMXzW9.js";import{u as X,B as g,e as t}from"./index-BI1ZbBzK.js";import{C as d,b as j,c as p,a as c}from"./card-C6VA_J5n.js";import{D as J,b as G,c as Y,d as q}from"./dialog-DwRXxEIa.js";import{I as C}from"./input-rKQRdAl-.js";import{L as _}from"./label-Cl8hR1Lw.js";import{T as K,a as Q,b as f,c as l,d as W,e as r}from"./table-BiQd8s4S.js";import{am as Z,p as ee,al as se,T as E,g as ae,an as te,v as re,t as le}from"./vendor-icons-Ca5eNZvr.js";import{h as T,o as R,a as z}from"./vendor-syntax-DzupMptF.js";import"./vendor-router-DdyOoyPF.js";import"./vendor-radix-gKv__6YA.js";const ne={NSE:"bg-cyan-500/10 text-cyan-600 border-cyan-500/30",NFO:"bg-purple-500/10 text-purple-600 border-purple-500/30",CDS:"bg-blue-500/10 text-blue-600 border-blue-500/30",BSE:"bg-gray-500/10 text-gray-600 border-gray-500/30",BFO:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",BCD:"bg-red-500/10 text-red-600 border-red-500/30",MCX:"bg-primary/10 text-primary border-primary/30",NCDEX:"bg-green-500/10 text-green-600 border-green-500/30"};function fe(){const{mode:k}=X(),o=k==="dark",[b,A]=n.useState(null),[B,y]=n.useState(!0),[m,L]=n.useState(""),[x,F]=n.useState(""),[h,O]=n.useState(null),[H,N]=n.useState(!1);n.useEffect(()=>{v()},[]);const v=async(s,a)=>{y(!0);try{const i=new URLSearchParams;s&&i.append("start_date",s),a&&i.append("end_date",a);const V=i.toString()?`/analyzer/api/data?${i}`:"/analyzer/api/data",S=await fetch(V,{credentials:"include"});if(S.ok){const D=await S.json();D.status==="success"&&A(D.data)}}catch(i){console.error("Error fetching analyzer data:",i)}finally{y(!1)}},I=s=>{s.preventDefault(),v(m,x)},U=()=>{const s=new URLSearchParams;m&&s.append("start_date",m),x&&s.append("end_date",x);const a=s.toString()?`/analyzer/export?${s}`:"/analyzer/export";window.location.href=a},$=s=>{O(s),N(!0)},P=s=>{if(s.api_type==="cancelorder")return`OrderID: ${s.orderid}`;let a=s.symbol||"";return s.quantity&&(a+=` (${s.quantity})`),s.api_type==="placesmartorder"&&s.position_size&&(a+=` [Size: ${s.position_size}]`),a},M=s=>{const a={...s};return delete a.apikey,a};if(B)return e.jsx("div",{className:"container mx-auto py-8 px-4 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const u=b?.stats||{total_requests:0,issues:{total:0},symbols:[],sources:[]},w=b?.requests||[];return e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Sandbox Request Monitor"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Review and validate your sandbox API requests before going live"})]}),e.jsxs("form",{onSubmit:I,className:"flex flex-wrap gap-4 items-end mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"start_date",children:"Start Date"}),e.jsx(C,{id:"start_date",type:"date",value:m,onChange:s=>L(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"end_date",children:"End Date"}),e.jsx(C,{id:"end_date",type:"date",value:x,onChange:s=>F(s.target.value)})]}),e.jsxs(g,{type:"submit",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Filter"]}),e.jsxs(g,{type:"button",variant:"secondary",onClick:U,children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Export to CSV"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsxs(d,{children:[e.jsx(j,{className:"pb-2",children:e.jsxs(p,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"Total Requests"]})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:u.total_requests}),e.jsx(t,{className:"mt-1",children:"Last 24 hours"})]})]}),e.jsxs(d,{children:[e.jsx(j,{className:"pb-2",children:e.jsxs(p,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"Issues Found"]})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-500",children:u.issues.total}),e.jsx(t,{variant:"secondary",className:"mt-1",children:"Needs Attention"})]})]}),e.jsxs(d,{children:[e.jsx(j,{className:"pb-2",children:e.jsxs(p,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),"Unique Symbols"]})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold",children:u.symbols.length}),e.jsx(t,{variant:"outline",className:"mt-1",children:"Tracked"})]})]}),e.jsxs(d,{children:[e.jsx(j,{className:"pb-2",children:e.jsxs(p,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),"Active Sources"]})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold",children:u.sources.length}),e.jsx(t,{variant:"outline",className:"mt-1",children:"Connected"})]})]})]}),e.jsx(d,{children:e.jsx(c,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(K,{children:[e.jsx(Q,{children:e.jsxs(f,{children:[e.jsx(l,{children:"Timestamp"}),e.jsx(l,{children:"API Type"}),e.jsx(l,{children:"Source"}),e.jsx(l,{children:"Details"}),e.jsx(l,{children:"Exchange"}),e.jsx(l,{children:"Action"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"View"})]})}),e.jsx(W,{children:w.length===0?e.jsx(f,{children:e.jsx(r,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No requests found"})}):w.map((s,a)=>e.jsxs(f,{className:"hover:bg-muted/50",children:[e.jsx(r,{className:"text-sm",children:s.timestamp}),e.jsx(r,{children:e.jsx(t,{variant:"default",children:s.api_type})}),e.jsx(r,{children:e.jsx(t,{variant:"secondary",className:"truncate max-w-[120px]",children:s.source})}),e.jsx(r,{className:"font-medium",children:P(s)}),e.jsx(r,{children:s.exchange&&e.jsx(t,{className:ne[s.exchange]||"",variant:"outline",children:s.exchange})}),e.jsx(r,{children:s.action&&e.jsx(t,{variant:s.action==="BUY"?"default":"destructive",children:s.action})}),e.jsx(r,{children:s.analysis.issues?e.jsxs(t,{variant:"secondary",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[e.jsx(E,{className:"h-3 w-3 mr-1"}),"Error"]}):e.jsxs(t,{variant:"secondary",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[e.jsx(re,{className:"h-3 w-3 mr-1"}),"Success"]})}),e.jsx(r,{children:e.jsxs(g,{size:"sm",onClick:()=>$(s),children:[e.jsx(le,{className:"h-4 w-4 mr-1"}),"View"]})})]},a))})]})})})}),e.jsx(J,{open:H,onOpenChange:N,children:e.jsxs(G,{className:"max-w-5xl",children:[e.jsx(Y,{children:e.jsx(q,{children:"Request Details"})}),h&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Request Data"}),e.jsx("div",{className:"rounded-lg overflow-hidden border",children:e.jsx(T,{language:"json",style:o?R:z,customStyle:{margin:0,padding:"1rem",fontSize:"0.75rem",maxHeight:"400px",background:o?"#1e1e1e":"#f8f8f8"},children:JSON.stringify(M(h.request_data),null,2)})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Response Data"}),e.jsx("div",{className:"rounded-lg overflow-hidden border",children:e.jsx(T,{language:"json",style:o?R:z,customStyle:{margin:0,padding:"1rem",fontSize:"0.75rem",maxHeight:"400px",background:o?"#1e1e1e":"#f8f8f8"},children:JSON.stringify(h.response_data||h.analysis,null,2)})})]})]})]})})]})}export{fe as default};
