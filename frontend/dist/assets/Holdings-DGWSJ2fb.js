import{r as l,j as e}from"./vendor-react-RhKMXzW9.js";import{t as V}from"./trading-BaqQof3B.js";import{d as z,o as U,B as T,c as m,e as S,s as o}from"./index-Cas4CFnG.js";import{C as h,b as u,d as j,c as p,a as q}from"./card-CVpMAb1u.js";import{T as A,a as O,b as L,c as d,d as Q,e as x}from"./table-D0IiNwW6.js";import{R as K,D as M,c as P,Y as I,L as Y}from"./vendor-icons-Chlwwn8V.js";import"./vendor-syntax-D6hV6JR3.js";import"./vendor-router-DdyOoyPF.js";import"./vendor-radix-B_grJx4K.js";function f(n){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(n)}function R(n){return`${n>=0?"+":""}${n.toFixed(2)}%`}function ae(){const{apiKey:n}=z(),[g,E]=l.useState([]),[t,H]=l.useState(null),[D,b]=l.useState(!0),[v,w]=l.useState(!1),[C,N]=l.useState(null),c=l.useCallback(async(s=!1)=>{if(!n){b(!1);return}s&&w(!0);try{const a=await V.getHoldings(n);a.status==="success"&&a.data?(E(a.data.holdings||[]),H(a.data.statistics),N(null)):N(a.message||"Failed to fetch holdings")}catch{N("Failed to fetch holdings")}finally{b(!1),w(!1)}},[n]);l.useEffect(()=>{c();const s=setInterval(()=>c(),3e4);return()=>clearInterval(s)},[c]),l.useEffect(()=>{const s=U(()=>{c()});return()=>s()},[c]);const $=()=>{const s=["Symbol","Exchange","Quantity","Product","P&L","P&L %"],a=g.map(r=>[o(r.symbol),o(r.exchange),o(r.quantity),o(r.product),o(r.pnl),o(r.pnlpercent)]),k=[s,...a].map(r=>r.join(",")).join(`
`),B=new Blob([k],{type:"text/csv"}),F=URL.createObjectURL(B),y=document.createElement("a");y.href=F,y.download=`holdings_${new Date().toISOString().split("T")[0]}.csv`,y.click()},i=s=>s>=0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Investor Summary"}),e.jsx("p",{className:"text-muted-foreground",children:"View your holdings portfolio"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(T,{variant:"outline",size:"sm",onClick:()=>c(!0),disabled:v,children:[e.jsx(K,{className:m("h-4 w-4 mr-2",v&&"animate-spin")}),"Refresh"]}),e.jsxs(T,{variant:"outline",size:"sm",onClick:$,children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Export"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsx(h,{children:e.jsxs(u,{className:"pb-2",children:[e.jsx(j,{children:"Total Holding Value"}),e.jsx(p,{className:"text-2xl text-primary",children:t?f(t.totalholdingvalue):"---"})]})}),e.jsx(h,{children:e.jsxs(u,{className:"pb-2",children:[e.jsx(j,{children:"Total Investment Value"}),e.jsx(p,{className:"text-2xl",children:t?f(t.totalinvvalue):"---"})]})}),e.jsx(h,{children:e.jsxs(u,{className:"pb-2",children:[e.jsx(j,{children:"Total Profit and Loss"}),e.jsx(p,{className:m("text-2xl",t&&i(t.totalprofitandloss)?"text-green-600":"text-red-600"),children:t?e.jsxs("div",{className:"flex items-center gap-1",children:[i(t.totalprofitandloss)?e.jsx(P,{className:"h-5 w-5"}):e.jsx(I,{className:"h-5 w-5"}),f(t.totalprofitandloss)]}):"---"})]})}),e.jsx(h,{children:e.jsxs(u,{className:"pb-2",children:[e.jsx(j,{children:"Total PnL Percentage"}),e.jsx(p,{className:m("text-2xl",t&&i(t.totalpnlpercentage)?"text-green-600":"text-red-600"),children:t?R(t.totalpnlpercentage):"---"})]})})]}),e.jsx(h,{children:e.jsx(q,{className:"p-0",children:D?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Y,{className:"h-8 w-8 animate-spin"})}):C?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:C}):g.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"No holdings found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(A,{children:[e.jsx(O,{children:e.jsxs(L,{children:[e.jsx(d,{children:"Trading Symbol"}),e.jsx(d,{children:"Exchange"}),e.jsx(d,{className:"text-right",children:"Quantity"}),e.jsx(d,{children:"Product"}),e.jsx(d,{className:"text-right",children:"Profit and Loss"}),e.jsx(d,{className:"text-right",children:"PnL Percentage"})]})}),e.jsx(Q,{children:g.map((s,a)=>e.jsxs(L,{children:[e.jsx(x,{className:"font-medium",children:s.symbol}),e.jsx(x,{children:e.jsx(S,{variant:"outline",children:s.exchange})}),e.jsx(x,{className:"text-right font-mono",children:s.quantity}),e.jsx(x,{children:e.jsx(S,{variant:"secondary",children:s.product})}),e.jsx(x,{className:m("text-right font-medium",i(s.pnl)?"text-green-600":"text-red-600"),children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[i(s.pnl)?e.jsx(P,{className:"h-4 w-4"}):e.jsx(I,{className:"h-4 w-4"}),f(s.pnl)]})}),e.jsx(x,{className:m("text-right",i(s.pnlpercent)?"text-green-600":"text-red-600"),children:R(s.pnlpercent)})]},`${s.symbol}-${s.exchange}-${a}`))})]})})})})]})}export{ae as default};
