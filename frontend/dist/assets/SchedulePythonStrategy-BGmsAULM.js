import{r as a,j as e}from"./vendor-react-CCyQGCED.js";import{B as r,s as i}from"./index-D0023jFM.js";import{p as S}from"./python-strategy-CJZEPEnb.js";import{C as v,d as N,a as I,b as P,c as B}from"./card-CDguRyHx.js";import{I as b}from"./input-D8_g_dg9.js";import{L as h}from"./label-BgxgrBuS.js";import{S as p}from"./skeleton-CAOG8cB0.js";import{b as F}from"./python-strategy-CJF1bPLS.js";import{N as w,as as q,V as C}from"./vendor-icons-CCn_k3dF.js";import{d as z,a as A,L as _}from"./vendor-router-Dzc1xxhr.js";import"./vendor-charts-l0_txfiz.js";import"./vendor-radix-CYVJEJRR.js";function Q(){const{strategyId:n}=z(),c=A(),[d,k]=a.useState(null),[T,x]=a.useState(!0),[y,g]=a.useState(!1),[m,f]=a.useState("09:15"),[u,j]=a.useState("15:30"),[l,o]=a.useState(["mon","tue","wed","thu","fri"]);a.useEffect(()=>{(async()=>{if(n)try{x(!0);const s=await S.getStrategy(n);k(s),s.schedule_start_time&&f(s.schedule_start_time),s.schedule_stop_time&&j(s.schedule_stop_time),s.schedule_days?.length&&o(s.schedule_days)}catch{i.error("Failed to load strategy","pythonStrategy"),c("/python")}finally{x(!1)}})()},[n]);const D=t=>{o(s=>s.includes(t)?s.filter(L=>L!==t):[...s,t])},E=async t=>{if(t.preventDefault(),!!n){if(l.length===0){i.error("Please select at least one day","pythonStrategy");return}if(!m){i.error("Start time is required","pythonStrategy");return}if(!u){i.error("Stop time is required","pythonStrategy");return}try{g(!0);const s=await S.scheduleStrategy(n,{start_time:m,stop_time:u,days:l});s.status==="success"?(i.success("Schedule saved successfully","pythonStrategy"),c("/python")):i.error(s.message||"Failed to save schedule","pythonStrategy")}catch{i.error("Failed to save schedule","pythonStrategy")}finally{g(!1)}}};return T?e.jsxs("div",{className:"container mx-auto py-6 max-w-2xl space-y-6",children:[e.jsx(p,{className:"h-8 w-32"}),e.jsx(p,{className:"h-12"}),e.jsx(p,{className:"h-64"})]}):d?d.status==="running"?e.jsxs("div",{className:"container mx-auto py-6 max-w-2xl space-y-6",children:[e.jsx(r,{variant:"ghost",asChild:!0,children:e.jsxs(_,{to:"/python",children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Back to Python Strategies"]})}),e.jsx(v,{children:e.jsx(N,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground",children:"Cannot modify schedule while strategy is running. Please stop the strategy first."})})})]}):e.jsxs("div",{className:"container mx-auto py-6 max-w-2xl space-y-6",children:[e.jsx(r,{variant:"ghost",asChild:!0,children:e.jsxs(_,{to:"/python",children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Back to Python Strategies"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Edit Schedule"}),e.jsx("p",{className:"text-muted-foreground",children:d.name})]}),e.jsxs(v,{children:[e.jsxs(I,{children:[e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),"Schedule Settings"]}),e.jsx(B,{children:"Set when the strategy should automatically start and stop (IST)"})]}),e.jsx(N,{children:e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(h,{htmlFor:"start_time",className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4"}),"Start Time (IST)"]}),e.jsx(b,{id:"start_time",type:"time",value:m,onChange:t=>f(t.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(h,{htmlFor:"stop_time",className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4"}),"Stop Time (IST)"]}),e.jsx(b,{id:"stop_time",type:"time",value:u,onChange:t=>j(t.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(h,{children:"Days to Run"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:F.map(t=>e.jsxs("button",{type:"button",className:`flex items-center gap-2 px-3 py-2 rounded-lg border cursor-pointer transition-colors ${l.includes(t.value)?"bg-primary text-primary-foreground border-primary":"bg-background hover:bg-muted"}`,onClick:()=>D(t.value),children:[e.jsx("div",{className:`h-4 w-4 rounded border flex items-center justify-center ${l.includes(t.value)?"bg-primary-foreground border-primary-foreground":"border-current"}`,children:l.includes(t.value)&&e.jsx("svg",{className:"h-3 w-3 text-primary",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})})}),e.jsx("span",{className:"text-sm font-medium",children:t.label})]},t.value))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{type:"button",variant:"outline",size:"sm",onClick:()=>o(["mon","tue","wed","thu","fri"]),children:"Weekdays"}),e.jsx(r,{type:"button",variant:"outline",size:"sm",onClick:()=>o(["sat","sun"]),children:"Weekend"}),e.jsx(r,{type:"button",variant:"outline",size:"sm",onClick:()=>o(["mon","tue","wed","thu","fri","sat","sun"]),children:"Every Day"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(r,{type:"button",variant:"outline",className:"flex-1",onClick:()=>c("/python"),children:"Cancel"}),e.jsx(r,{type:"submit",className:"flex-1",disabled:y,children:y?"Saving...":"Save Schedule"})]})]})})]})]}):null}export{Q as default};
