import{r as o,j as e}from"./vendor-react-CCyQGCED.js";import{B as d,s as m}from"./index-D0023jFM.js";import{c as N}from"./chartink-C5AXtcMr.js";import{A as v,a as C}from"./alert-Dlgyh2fF.js";import{C as S,a as b,b as k,c as q,d as w}from"./card-CDguRyHx.js";import{I as c}from"./input-D8_g_dg9.js";import{L as l}from"./label-BgxgrBuS.js";import{S as F,a as E,b as L,c as A,d as y}from"./select-DXT-lI-N.js";import{N as I,Z as T,I as D}from"./vendor-icons-CCn_k3dF.js";import{a as B,L as O}from"./vendor-router-Dzc1xxhr.js";import"./vendor-charts-l0_txfiz.js";import"./vendor-radix-CYVJEJRR.js";function U(){const h=B(),[u,x]=o.useState(!1),[t,r]=o.useState({name:"",strategy_type:"intraday",start_time:"09:15",end_time:"15:00",squareoff_time:"15:15"}),[i,p]=o.useState({}),j=()=>{const a={};if(t.name.trim()?t.name.length<3||t.name.length>50?a.name="Name must be between 3 and 50 characters":/^[a-zA-Z0-9\s\-_]+$/.test(t.name)||(a.name="Name can only contain letters, numbers, spaces, hyphens, and underscores"):a.name="Strategy name is required",t.strategy_type==="intraday"){const s=t.start_time,n=t.end_time,g=t.squareoff_time;!s||!n||!g?a.time="All time fields are required for intraday strategies":s>=n?a.time="Start time must be before end time":n>=g&&(a.time="End time must be before square off time")}return p(a),Object.keys(a).length===0},_=async a=>{if(a.preventDefault(),!j()){m.error("Please fix the form errors","chartink");return}try{x(!0);const s=await N.createStrategy({name:t.name,strategy_type:t.strategy_type,...t.strategy_type==="intraday"&&{start_time:t.start_time,end_time:t.end_time,squareoff_time:t.squareoff_time}});s.status==="success"?(m.success("Chartink strategy created successfully","chartink"),h(`/chartink/${s.data?.strategy_id}`)):m.error(s.message||"Failed to create strategy","chartink")}catch(s){const n=s instanceof Error?s.message:"Failed to create strategy";m.error(n,"chartink")}finally{x(!1)}},f=t.name?`chartink_${t.name.toLowerCase().replace(/\s+/g,"_")}`:"";return e.jsxs("div",{className:"container mx-auto py-6 max-w-2xl space-y-6",children:[e.jsx(d,{variant:"ghost",asChild:!0,children:e.jsxs(O,{to:"/chartink",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Back to Chartink Strategies"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Create Chartink Strategy"}),e.jsx("p",{className:"text-muted-foreground",children:"Set up a new Chartink webhook strategy to receive screener alerts"})]}),e.jsxs(S,{children:[e.jsxs(b,{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5"}),"Strategy Details"]}),e.jsx(q,{children:"Configure your Chartink strategy settings (NSE/BSE only)"})]}),e.jsx(w,{children:e.jsxs("form",{onSubmit:_,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"name",children:"Strategy Name"}),e.jsx(c,{id:"name",placeholder:"My Chartink Strategy",value:t.name,onChange:a=>r({...t,name:a.target.value}),className:i.name?"border-red-500":""}),i.name&&e.jsx("p",{className:"text-sm text-red-500",children:i.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"3-50 characters. Letters, numbers, spaces, hyphens, and underscores only."})]}),f&&e.jsxs(v,{children:[e.jsx(D,{className:"h-4 w-4"}),e.jsxs(C,{children:["Final strategy name:"," ",e.jsx("code",{className:"bg-muted px-1 rounded font-mono",children:f})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"strategy_type",children:"Strategy Type"}),e.jsxs(F,{value:t.strategy_type,onValueChange:a=>r({...t,strategy_type:a}),children:[e.jsx(E,{children:e.jsx(L,{placeholder:"Select type"})}),e.jsxs(A,{children:[e.jsx(y,{value:"intraday",children:"Intraday"}),e.jsx(y,{value:"positional",children:"Positional"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Intraday strategies have trading hours and auto square-off."})]}),t.strategy_type==="intraday"&&e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/50",children:[e.jsx("h4",{className:"font-medium",children:"Trading Hours"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"start_time",children:"Start Time"}),e.jsx(c,{id:"start_time",type:"time",value:t.start_time,onChange:a=>r({...t,start_time:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"end_time",children:"End Time"}),e.jsx(c,{id:"end_time",type:"time",value:t.end_time,onChange:a=>r({...t,end_time:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"squareoff_time",children:"Square Off"}),e.jsx(c,{id:"squareoff_time",type:"time",value:t.squareoff_time,onChange:a=>r({...t,squareoff_time:a.target.value})})]})]}),i.time&&e.jsx("p",{className:"text-sm text-red-500",children:i.time}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Orders will only be placed during trading hours. Positions will be squared off at the specified time."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(d,{type:"button",variant:"outline",className:"flex-1",onClick:()=>h("/chartink"),children:"Cancel"}),e.jsx(d,{type:"submit",className:"flex-1",disabled:u,children:u?"Creating...":"Create Strategy"})]})]})})]})]})}export{U as default};
