import{r as a,j as e}from"./vendor-react-CCyQGCED.js";import{B as i,s as b}from"./index-NHrG-O_Z.js";import{A as I,a as B}from"./alert-BoGaKMRC.js";import{C as u,a as m,b as x,c as $,d as p}from"./card-Cn20bp_v.js";import{I as J}from"./input-BylzFlgY.js";import{L as d}from"./label-_1WWiomg.js";import{S as N,a as C,b as w,c as S,d as j}from"./select-DcHsBqkV.js";import{J as X}from"./json-editor-CV344Puw.js";import{T as Q,a7 as P,Y as Z,p as ee,I as se,_ as ae}from"./vendor-icons-CCn_k3dF.js";import"./vendor-charts-l0_txfiz.js";import"./vendor-router-Dzc1xxhr.js";import"./vendor-radix-CYVJEJRR.js";import"./index-CCl19WGM.js";import"./index-xqfX1S8Y.js";const te=[{value:"NSE",label:"NSE"},{value:"NFO",label:"NFO"},{value:"BSE",label:"BSE"},{value:"BFO",label:"BFO"},{value:"CDS",label:"CDS"},{value:"MCX",label:"MCX"}],re=[{value:"MIS",label:"MIS - Intraday"},{value:"NRML",label:"NRML - Carry Forward"},{value:"CNC",label:"CNC - Delivery"}];function ye(){const[r,k]=a.useState("NHPC"),[n,E]=a.useState("NSE"),[R,D]=a.useState("MIS"),[L,M]=a.useState("BUY"),[O,H]=a.useState("1"),[G,g]=a.useState([]),[q,l]=a.useState(!1),[V,T]=a.useState(!1),[h,Y]=a.useState(""),[z,K]=a.useState(""),[f,U]=a.useState(null),y=a.useRef(null);a.useEffect(()=>{const s=async()=>{try{const c=await(await fetch("/api/config/host",{credentials:"include"})).json();U(c)}catch{U({host_server:window.location.origin,is_localhost:window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"})}},t=async()=>{try{const o=await fetch("/playground/api-key",{credentials:"include"});if(o.ok){const c=await o.json();K(c.api_key||"")}}catch{}};s(),t()},[]);const v=f?`${f.host_server}/api/v1/placeorder`:`${window.location.origin}/api/v1/placeorder`,A=a.useCallback(async s=>{if(s.length<2){g([]),l(!1);return}T(!0);try{const t=new URLSearchParams({q:s});n&&t.append("exchange",n);const c=await(await fetch(`/search/api/search?${t}`,{credentials:"include"})).json();g((c.results||[]).slice(0,10)),l(!0)}catch{g([])}finally{T(!1)}},[n]);a.useEffect(()=>{const s=setTimeout(()=>{r.length>=2&&A(r)},300);return()=>clearTimeout(s)},[r,A]),a.useEffect(()=>{const s=t=>{y.current&&!y.current.contains(t.target)&&l(!1)};return document.addEventListener("click",s),()=>document.removeEventListener("click",s)},[]);const W=s=>{k(s.symbol),E(s.exchange),l(!1)},F=(s=!0)=>{if(!r||!n){s&&b.error("Please select a symbol and exchange","system");return}Y(JSON.stringify({apikey:z||"YOUR_API_KEY",strategy:"GoCharting Alert",symbol:r,exchange:n,action:L,product:R,pricetype:"MARKET",quantity:O},null,2))};a.useEffect(()=>{F(!1)},[]);const _=async(s,t)=>{try{await navigator.clipboard.writeText(s),b.success(`${t} copied to clipboard`,"clipboard")}catch{b.error("Copy failed - please copy manually","system")}};return e.jsxs("div",{className:"container mx-auto py-6 px-4 max-w-6xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"GoCharting Configuration"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Generate webhook configuration for GoCharting strategy alerts"})]}),f?.is_localhost&&e.jsxs(I,{variant:"destructive",className:"mb-8",children:[e.jsx(Q,{className:"h-5 w-5"}),e.jsxs(B,{className:"ml-2",children:[e.jsx("strong",{children:"Webhook URL not accessible!"})," GoCharting cannot send alerts to localhost. Use ",e.jsx("strong",{children:"ngrok"}),", ",e.jsx("strong",{children:"Cloudflare Tunnel"}),","," ",e.jsx("strong",{children:"VS Code Dev Tunnel"}),", or a ",e.jsx("strong",{children:"custom domain"})," to expose your OpenAlgo instance to the internet. Update ",e.jsx("code",{children:"HOST_SERVER"})," in your ",e.jsx("code",{children:".env"})," file with your external URL."]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(u,{children:[e.jsxs(m,{children:[e.jsx(x,{className:"text-primary",children:"Webhook URL"}),e.jsx($,{children:"Use this URL in your GoCharting alerts"})]}),e.jsx(p,{children:e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-lg",children:[e.jsx("code",{className:"flex-1 text-sm font-mono truncate",title:v,children:v}),e.jsxs(i,{variant:"secondary",size:"sm",onClick:()=>_(v,"Webhook URL"),children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),"Copy"]})]})})]}),e.jsxs(u,{children:[e.jsx(m,{children:e.jsx(x,{children:"Configuration"})}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"symbol",children:"Symbol"}),e.jsxs("div",{className:"relative",ref:y,children:[e.jsx(J,{id:"symbol",type:"text",placeholder:"Search for symbol...",value:r,onChange:s=>k(s.target.value),onFocus:()=>{r.length>=2&&l(!0)},autoComplete:"off"}),V&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"})}),q&&G.length>0&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-background border rounded-lg shadow-lg max-h-64 overflow-y-auto",children:G.map((s,t)=>e.jsx("div",{className:"p-3 border-b last:border-b-0 hover:bg-muted cursor-pointer",onClick:()=>W(s),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.symbol}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s.name})]}),e.jsx("span",{className:"text-xs bg-primary text-primary-foreground px-2 py-1 rounded",children:s.exchange})]})},t))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"exchange",children:"Exchange"}),e.jsxs(N,{value:n,onValueChange:E,children:[e.jsx(C,{children:e.jsx(w,{placeholder:"Select Exchange"})}),e.jsx(S,{children:te.map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"product",children:"Product Type"}),e.jsxs(N,{value:R,onValueChange:D,children:[e.jsx(C,{children:e.jsx(w,{})}),e.jsx(S,{children:re.map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"action",children:"Action"}),e.jsxs(N,{value:L,onValueChange:M,children:[e.jsx(C,{children:e.jsx(w,{})}),e.jsxs(S,{children:[e.jsx(j,{value:"BUY",children:"BUY"}),e.jsx(j,{value:"SELL",children:"SELL"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"quantity",children:"Quantity"}),e.jsx(J,{id:"quantity",type:"number",min:"1",value:O,onChange:s=>H(s.target.value),placeholder:"Enter quantity"})]}),e.jsxs(i,{onClick:()=>F(),className:"w-full",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Generate JSON"]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(u,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(x,{children:"Generated JSON"}),e.jsxs(i,{variant:"secondary",size:"sm",onClick:()=>_(h,"JSON"),disabled:!h,children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),"Copy"]})]})}),e.jsx(p,{children:e.jsx("div",{className:"rounded-lg overflow-hidden border bg-background h-64",children:h?e.jsx(X,{value:h,readOnly:!0,className:"h-full"}):e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:e.jsx("p",{children:'Fill in the form and click "Generate JSON" to see the output'})})})})]}),e.jsxs(u,{className:"bg-accent text-accent-foreground",children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),"Need Help?"]})}),e.jsxs(p,{className:"space-y-4",children:[e.jsx("p",{children:"Learn how to set up automated trading using GoCharting webhooks with our comprehensive step-by-step guide."}),e.jsxs(I,{className:"bg-blue-500/10 border-blue-500",children:[e.jsx(se,{className:"h-4 w-4 text-blue-500"}),e.jsxs(B,{className:"ml-2 text-sm",children:[e.jsx("strong",{children:"Premium Required:"})," Webhook alerts require GoCharting Premium Plan."]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(i,{asChild:!0,variant:"outline",size:"sm",children:e.jsx("a",{href:"/docs/gocharting_webhook_setup.md",download:!0,children:"Download Guide"})}),e.jsx(i,{asChild:!0,variant:"default",size:"sm",children:e.jsxs("a",{href:"https://docs.openalgo.in/trading-platform/gocharting",target:"_blank",rel:"noopener noreferrer",children:["Online Docs",e.jsx(ae,{className:"h-4 w-4 ml-2"})]})})]})]})]})]})]})]})}export{ye as default};
