import{r as t,j as e}from"./vendor-react-RhKMXzW9.js";import{B as r,e as i,t as c}from"./index-C9Wavwzw.js";import{s as T}from"./strategy-EAFBTLx0.js";import{A as O,b as A,a as E}from"./alert-DGOIVryi.js";import{C as l,a as n,b as u,c as f,d as p}from"./card-RS00WnSr.js";import{S as o}from"./skeleton-CpUL_9nm.js";import{R as U,ay as N,aK as H,Z as I,P as B,s as P,a2 as W,i as $,t as V,aL as z,_ as F,c as q}from"./vendor-icons-BPjpxhHr.js";import{a as D,L as w}from"./vendor-router-D7kKkCmL.js";import"./vendor-radix-Cue1hf3Z.js";function se(){const d=D(),[m,b]=t.useState([]),[v,x]=t.useState(!0),[y,h]=t.useState(null),[C,g]=t.useState(null),j=async()=>{try{x(!0);const s=await T.getStrategies();b(s)}catch(s){console.error("Failed to fetch strategies:",s),c.error("Failed to load strategies")}finally{x(!1)}};t.useEffect(()=>{(async()=>{try{const R=await(await fetch("/api/config/host",{credentials:"include"})).json();g(R)}catch(a){console.error("Failed to fetch host config:",a),g({host_server:window.location.origin,is_localhost:window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"})}})()},[]),t.useEffect(()=>{j()},[]);const k=s=>`${C?.host_server||window.location.origin}/strategy/webhook/${s}`,S=async s=>{const a=k(s);try{await navigator.clipboard.writeText(a),h(s),c.success("Webhook URL copied to clipboard"),setTimeout(()=>h(null),2e3)}catch{c.error("Failed to copy URL")}},_=s=>{switch(s){case"LONG":return e.jsx(q,{className:"h-4 w-4 text-green-500"});case"SHORT":return e.jsx(F,{className:"h-4 w-4 text-red-500"});case"BOTH":return e.jsx(z,{className:"h-4 w-4 text-blue-500"});default:return null}},L=s=>({tradingview:"TradingView",amibroker:"Amibroker",python:"Python",metatrader:"Metatrader",excel:"Excel",others:"Others"})[s]||s;return v?e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(o,{className:"h-8 w-48"}),e.jsx(o,{className:"h-10 w-32"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(s=>e.jsx(o,{className:"h-48"},s))})]}):e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Webhook Strategies"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your trading strategies and webhook integrations"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{variant:"outline",size:"sm",onClick:j,children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(r,{onClick:()=>d("/strategy/new"),children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"New Strategy"]})]})]}),e.jsxs(O,{children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx(A,{children:"Webhook Integration"}),e.jsxs(E,{children:["Create strategies to receive alerts from TradingView, Amibroker, Python scripts, and more. Use keywords in your alert: ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"BUY"}),","," ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"SELL"}),","," ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"SHORT"}),","," ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"COVER"})]})]}),m.length===0?e.jsx(l,{className:"py-12",children:e.jsxs(n,{className:"flex flex-col items-center justify-center text-center",children:[e.jsx(I,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Strategies Yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Create your first webhook strategy to start receiving trading alerts."}),e.jsxs(r,{onClick:()=>d("/strategy/new"),children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Create Strategy"]})]})}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:m.map(s=>e.jsxs(l,{className:"relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 left-0 right-0 h-1 ${s.is_active?"bg-green-500":"bg-gray-300 dark:bg-gray-600"}`}),e.jsx(u,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(f,{className:"text-lg",children:s.name}),e.jsx(p,{children:L(s.platform)})]}),e.jsx(i,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"})]})}),e.jsxs(n,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[_(s.trading_mode),e.jsx("span",{className:"text-muted-foreground",children:s.trading_mode})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(i,{variant:"outline",className:"font-normal",children:s.is_intraday?"Intraday":"Positional"})})]}),s.is_intraday&&s.start_time&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.start_time," - ",s.end_time,s.squareoff_time&&` (SqOff: ${s.squareoff_time})`]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(r,{variant:"outline",size:"sm",className:"flex-1 justify-start text-xs font-mono truncate",onClick:()=>S(s.webhook_id),children:[y===s.webhook_id?e.jsx(P,{className:"h-3 w-3 mr-2 text-green-500"}):e.jsx(W,{className:"h-3 w-3 mr-2"}),e.jsxs("span",{className:"truncate",children:[".../",s.webhook_id.slice(0,8),"..."]})]})}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(r,{variant:"outline",size:"sm",className:"flex-1",asChild:!0,children:e.jsxs(w,{to:`/strategy/${s.id}/configure`,children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Symbols"]})}),e.jsx(r,{variant:"default",size:"sm",className:"flex-1",asChild:!0,children:e.jsxs(w,{to:`/strategy/${s.id}`,children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"View"]})})]})]})]},s.id))}),e.jsxs(l,{children:[e.jsxs(u,{children:[e.jsx(f,{className:"text-lg",children:"Alert Keywords Reference"}),e.jsx(p,{children:"Include these keywords in your alert message to trigger orders"})]}),e.jsx(n,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{className:"bg-green-500",children:"BUY"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Open long position"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{className:"bg-red-500",children:"SELL"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Close long position"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{className:"bg-orange-500",children:"SHORT"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Open short position"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{className:"bg-blue-500",children:"COVER"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Close short position"})]})]})})]})]})}export{se as default};
