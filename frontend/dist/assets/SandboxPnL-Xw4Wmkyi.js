import{r as j,j as e}from"./vendor-react-RhKMXzW9.js";import{B as D,c as r,e as c}from"./index-D71BpcWT.js";import{C as o,a as h,b as u,c as N}from"./card-xMAW5JBC.js";import{T as p,a as g,b as m,c as t,d as f,e as a}from"./table-DRNM7NjE.js";import{T as H,a as A,b as _,c as y}from"./tabs-Cn6xLnko.js";import{i as E,ai as v,aj as b,ak as T,al as z}from"./vendor-icons-D08EYFn4.js";import{L as I}from"./vendor-router-D7kKkCmL.js";import"./vendor-radix-Cue1hf3Z.js";function l(i){return new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(i)}function n(i){return i>0?"text-green-500":i<0?"text-red-500":""}function O(){const[i,P]=j.useState(null),[L,w]=j.useState(!0),[C,S]=j.useState("daily");j.useEffect(()=>{M()},[]);const M=async()=>{try{const s=await fetch("/sandbox/mypnl/api/data",{credentials:"include"});if(s.ok){const x=await s.json();x.status==="success"&&P(x.data)}}catch(s){console.error("Error fetching data:",s)}finally{w(!1)}};if(L)return e.jsx("div",{className:"container mx-auto py-8 px-4 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const d=i?.summary||{today_realized_pnl:0,positions_unrealized_pnl:0,holdings_unrealized_pnl:0,today_total_mtm:0,all_time_realized_pnl:0};return e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"My P&L History"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Track your daily and historical profit & loss"})]}),e.jsx(D,{asChild:!0,variant:"outline",children:e.jsxs(I,{to:"/sandbox",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Sandbox Config"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:[e.jsx(o,{children:e.jsxs(h,{className:"p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Realized P&L"}),e.jsx("div",{className:r("text-2xl font-bold",n(d.today_realized_pnl)),children:l(d.today_realized_pnl)}),e.jsx(c,{variant:d.today_realized_pnl>=0?"default":"destructive",className:"mt-1",children:"Today"})]})}),e.jsx(o,{children:e.jsxs(h,{className:"p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Positions MTM"}),e.jsx("div",{className:r("text-2xl font-bold",n(d.positions_unrealized_pnl)),children:l(d.positions_unrealized_pnl)}),e.jsx(c,{variant:"secondary",className:"mt-1",children:"Unrealized"})]})}),e.jsx(o,{children:e.jsxs(h,{className:"p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Holdings MTM"}),e.jsx("div",{className:r("text-2xl font-bold",n(d.holdings_unrealized_pnl)),children:l(d.holdings_unrealized_pnl)}),e.jsx(c,{variant:"outline",className:"mt-1",children:"Unrealized"})]})}),e.jsx(o,{className:"border-2 border-primary",children:e.jsxs(h,{className:"p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total MTM"}),e.jsx("div",{className:r("text-2xl font-bold",n(d.today_total_mtm)),children:l(d.today_total_mtm)}),e.jsx(c,{className:"mt-1",children:"Today"})]})}),e.jsx(o,{children:e.jsxs(h,{className:"p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"All-Time P&L"}),e.jsx("div",{className:r("text-2xl font-bold",n(d.all_time_realized_pnl)),children:l(d.all_time_realized_pnl)}),e.jsx(c,{variant:d.all_time_realized_pnl>=0?"default":"destructive",className:"mt-1",children:"Lifetime"})]})})]}),e.jsxs(H,{value:C,onValueChange:S,children:[e.jsxs(A,{className:"mb-4",children:[e.jsxs(_,{value:"daily",className:"gap-2",children:[e.jsx(v,{className:"h-4 w-4"}),"Date-wise P&L"]}),e.jsxs(_,{value:"positions",className:"gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),"Positions"]}),e.jsxs(_,{value:"holdings",className:"gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),"Holdings"]}),e.jsxs(_,{value:"trades",className:"gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),"Recent Trades"]})]}),e.jsx(y,{value:"daily",children:e.jsxs(o,{children:[e.jsx(u,{children:e.jsx(N,{children:"Date-wise P&L Report"})}),e.jsx(h,{children:i?.daily_pnl&&i.daily_pnl.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(p,{children:[e.jsx(g,{children:e.jsxs(m,{children:[e.jsx(t,{children:"Date"}),e.jsx(t,{className:"text-right",children:"Realized P&L"}),e.jsx(t,{className:"text-right",children:"Positions MTM"}),e.jsx(t,{className:"text-right",children:"Holdings MTM"}),e.jsx(t,{className:"text-right",children:"Total Unrealized"}),e.jsx(t,{className:"text-right",children:"Total MTM"}),e.jsx(t,{className:"text-right",children:"Portfolio Value"})]})}),e.jsx(f,{children:i.daily_pnl.map((s,x)=>e.jsxs(m,{children:[e.jsx(a,{className:"font-semibold",children:s.date}),e.jsx(a,{className:r("text-right",n(s.realized_pnl)),children:l(s.realized_pnl)}),e.jsx(a,{className:r("text-right",n(s.positions_unrealized)),children:l(s.positions_unrealized)}),e.jsx(a,{className:r("text-right",n(s.holdings_unrealized)),children:l(s.holdings_unrealized)}),e.jsx(a,{className:r("text-right",n(s.total_unrealized)),children:l(s.total_unrealized)}),e.jsx(a,{className:r("text-right font-bold",n(s.total_mtm)),children:l(s.total_mtm)}),e.jsx(a,{className:"text-right text-primary",children:l(s.portfolio_value)})]},x))})]})}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(v,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No daily P&L data yet. Snapshots are captured at 23:59 IST daily."}),e.jsx("p",{className:"text-sm mt-2",children:"Start trading to see your date-wise P&L history."})]})})]})}),e.jsx(y,{value:"positions",children:e.jsxs(o,{children:[e.jsx(u,{children:e.jsx(N,{children:"Position-wise P&L"})}),e.jsx(h,{children:i?.positions&&i.positions.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(p,{children:[e.jsx(g,{children:e.jsxs(m,{children:[e.jsx(t,{children:"Symbol"}),e.jsx(t,{children:"Exchange"}),e.jsx(t,{children:"Product"}),e.jsx(t,{className:"text-right",children:"Qty"}),e.jsx(t,{className:"text-right",children:"Avg Price"}),e.jsx(t,{className:"text-right",children:"LTP"}),e.jsx(t,{className:"text-right",children:"Today's P&L"}),e.jsx(t,{className:"text-right",children:"All-Time P&L"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Last Updated"})]})}),e.jsx(f,{children:i.positions.map((s,x)=>e.jsxs(m,{children:[e.jsx(a,{className:"font-semibold",children:s.symbol}),e.jsx(a,{children:e.jsx(c,{variant:"outline",children:s.exchange})}),e.jsx(a,{children:e.jsx(c,{variant:s.product==="MIS"?"secondary":s.product==="CNC"?"default":"outline",children:s.product})}),e.jsx(a,{className:"text-right",children:s.quantity}),e.jsx(a,{className:"text-right",children:l(s.average_price)}),e.jsx(a,{className:"text-right",children:l(s.ltp)}),e.jsx(a,{className:r("text-right",n(s.today_realized_pnl)),children:l(s.today_realized_pnl)}),e.jsx(a,{className:r("text-right",n(s.all_time_realized_pnl)),children:l(s.all_time_realized_pnl)}),e.jsx(a,{children:e.jsx(c,{variant:s.status==="Open"?"default":"secondary",children:s.status})}),e.jsx(a,{className:"text-xs text-muted-foreground",children:s.updated_at})]},x))})]})}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(b,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No positions found. Start trading to see your P&L history."})]})})]})}),e.jsx(y,{value:"holdings",children:e.jsxs(o,{children:[e.jsx(u,{children:e.jsx(N,{children:"Holdings P&L (T+1 Settled)"})}),e.jsx(h,{children:i?.holdings&&i.holdings.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(p,{children:[e.jsx(g,{children:e.jsxs(m,{children:[e.jsx(t,{children:"Symbol"}),e.jsx(t,{children:"Exchange"}),e.jsx(t,{className:"text-right",children:"Qty"}),e.jsx(t,{className:"text-right",children:"Avg Price"}),e.jsx(t,{className:"text-right",children:"LTP"}),e.jsx(t,{className:"text-right",children:"Unrealized P&L"}),e.jsx(t,{className:"text-right",children:"P&L %"}),e.jsx(t,{children:"Settlement Date"})]})}),e.jsx(f,{children:i.holdings.map((s,x)=>e.jsxs(m,{children:[e.jsx(a,{className:"font-semibold",children:s.symbol}),e.jsx(a,{children:e.jsx(c,{variant:"outline",children:s.exchange})}),e.jsx(a,{className:"text-right",children:s.quantity}),e.jsx(a,{className:"text-right",children:l(s.average_price)}),e.jsx(a,{className:"text-right",children:l(s.ltp)}),e.jsx(a,{className:r("text-right",n(s.unrealized_pnl)),children:l(s.unrealized_pnl)}),e.jsxs(a,{className:r("text-right",n(s.pnl_percent)),children:[l(s.pnl_percent),"%"]}),e.jsx(a,{className:"text-xs text-muted-foreground",children:s.settlement_date})]},x))})]})}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(T,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No holdings found. CNC positions settle to holdings after T+1."})]})})]})}),e.jsx(y,{value:"trades",children:e.jsxs(o,{children:[e.jsx(u,{children:e.jsx(N,{children:"Recent Trades (Last 50)"})}),e.jsx(h,{children:i?.trades&&i.trades.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(p,{children:[e.jsx(g,{children:e.jsxs(m,{children:[e.jsx(t,{children:"Trade ID"}),e.jsx(t,{children:"Symbol"}),e.jsx(t,{children:"Exchange"}),e.jsx(t,{children:"Action"}),e.jsx(t,{className:"text-right",children:"Qty"}),e.jsx(t,{className:"text-right",children:"Price"}),e.jsx(t,{children:"Product"}),e.jsx(t,{children:"Timestamp"})]})}),e.jsx(f,{children:i.trades.map((s,x)=>e.jsxs(m,{children:[e.jsxs(a,{className:"font-mono text-xs",children:[s.tradeid.slice(0,12),"..."]}),e.jsx(a,{className:"font-semibold",children:s.symbol}),e.jsx(a,{children:e.jsx(c,{variant:"outline",children:s.exchange})}),e.jsx(a,{children:e.jsx(c,{variant:s.action==="BUY"?"default":"destructive",children:s.action})}),e.jsx(a,{className:"text-right",children:s.quantity}),e.jsx(a,{className:"text-right",children:l(s.price)}),e.jsx(a,{children:e.jsx(c,{variant:s.product==="MIS"?"secondary":s.product==="CNC"?"default":"outline",children:s.product})}),e.jsx(a,{className:"text-xs text-muted-foreground",children:s.timestamp})]},x))})]})}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(z,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No trades found. Start trading to see your trade history."})]})})]})})]})]})}export{O as default};
