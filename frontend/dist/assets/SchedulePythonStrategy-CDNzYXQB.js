import{r as a,j as e}from"./vendor-react--vsXx8_n.js";import{B as r,t as i}from"./index-49nn54hy.js";import{p as v}from"./python-strategy-BrcmtOPI.js";import{C as N,a as C,b as L,c as P,d as I}from"./card-D1RtKz0S.js";import{C as q}from"./checkbox-Dj_dgep_.js";import{I as b}from"./input-DaNo7pbt.js";import{L as h}from"./label-ConMOV-j.js";import{S as x}from"./skeleton-Dv6yswDJ.js";import{b as A}from"./python-strategy-CJF1bPLS.js";import{A as w,am as B,P as k}from"./vendor-icons-N1cWsVu6.js";import{d as z,a as H,L as _}from"./vendor-router-CiBIGs7t.js";import"./vendor-charts-l0_txfiz.js";import"./vendor-radix-DIebA-qg.js";function Z(){const{strategyId:l}=z(),o=H(),[d,T]=a.useState(null),[D,p]=a.useState(!0),[f,g]=a.useState(!1),[m,y]=a.useState("09:15"),[u,j]=a.useState("15:30"),[c,n]=a.useState(["mon","tue","wed","thu","fri"]);a.useEffect(()=>{(async()=>{if(l)try{p(!0);const s=await v.getStrategy(l);T(s),s.schedule_start_time&&y(s.schedule_start_time),s.schedule_stop_time&&j(s.schedule_stop_time),s.schedule_days?.length&&n(s.schedule_days)}catch(s){console.error("Failed to fetch strategy:",s),i.error("Failed to load strategy"),o("/python")}finally{p(!1)}})()},[l]);const S=t=>{n(s=>s.includes(t)?s.filter(F=>F!==t):[...s,t])},E=async t=>{if(t.preventDefault(),!!l){if(c.length===0){i.error("Please select at least one day");return}if(!m){i.error("Start time is required");return}if(!u){i.error("Stop time is required");return}try{g(!0);const s=await v.scheduleStrategy(l,{start_time:m,stop_time:u,days:c});s.status==="success"?(i.success("Schedule saved successfully"),o("/python")):i.error(s.message||"Failed to save schedule")}catch(s){console.error("Failed to schedule:",s),i.error("Failed to save schedule")}finally{g(!1)}}};return D?e.jsxs("div",{className:"container mx-auto py-6 max-w-2xl space-y-6",children:[e.jsx(x,{className:"h-8 w-32"}),e.jsx(x,{className:"h-12"}),e.jsx(x,{className:"h-64"})]}):d?d.status==="running"?e.jsxs("div",{className:"container mx-auto py-6 max-w-2xl space-y-6",children:[e.jsx(r,{variant:"ghost",asChild:!0,children:e.jsxs(_,{to:"/python",children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Back to Python Strategies"]})}),e.jsx(N,{children:e.jsx(C,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground",children:"Cannot modify schedule while strategy is running. Please stop the strategy first."})})})]}):e.jsxs("div",{className:"container mx-auto py-6 max-w-2xl space-y-6",children:[e.jsx(r,{variant:"ghost",asChild:!0,children:e.jsxs(_,{to:"/python",children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Back to Python Strategies"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Edit Schedule"}),e.jsx("p",{className:"text-muted-foreground",children:d.name})]}),e.jsxs(N,{children:[e.jsxs(L,{children:[e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5"}),"Schedule Settings"]}),e.jsx(I,{children:"Set when the strategy should automatically start and stop (IST)"})]}),e.jsx(C,{children:e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(h,{htmlFor:"start_time",className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4"}),"Start Time (IST)"]}),e.jsx(b,{id:"start_time",type:"time",value:m,onChange:t=>y(t.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(h,{htmlFor:"stop_time",className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4"}),"Stop Time (IST)"]}),e.jsx(b,{id:"stop_time",type:"time",value:u,onChange:t=>j(t.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(h,{children:"Days to Run"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:A.map(t=>e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border cursor-pointer transition-colors ${c.includes(t.value)?"bg-primary text-primary-foreground border-primary":"bg-background hover:bg-muted"}`,onClick:()=>S(t.value),children:[e.jsx(q,{checked:c.includes(t.value),onCheckedChange:()=>S(t.value),className:"pointer-events-none"}),e.jsx("span",{className:"text-sm font-medium",children:t.label})]},t.value))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{type:"button",variant:"outline",size:"sm",onClick:()=>n(["mon","tue","wed","thu","fri"]),children:"Weekdays"}),e.jsx(r,{type:"button",variant:"outline",size:"sm",onClick:()=>n(["sat","sun"]),children:"Weekend"}),e.jsx(r,{type:"button",variant:"outline",size:"sm",onClick:()=>n(["mon","tue","wed","thu","fri","sat","sun"]),children:"Every Day"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(r,{type:"button",variant:"outline",className:"flex-1",onClick:()=>o("/python"),children:"Cancel"}),e.jsx(r,{type:"submit",className:"flex-1",disabled:f,children:f?"Saving...":"Save Schedule"})]})]})})]})]}):null}export{Z as default};
