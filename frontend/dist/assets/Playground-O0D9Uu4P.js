import{r,j as e}from"./vendor-react-RhKMXzW9.js";import{t as x,B as d,c as g,e as D}from"./index-5A0f6rqh.js";import{I as te}from"./input-Bw0XHrxn.js";import{S as Oe}from"./scroll-area-BpnoIvAK.js";import{T as ae,a as ne,b as I,c as L}from"./tabs-BN8IasHy.js";import{j as Ee,X as Re,aq as Ae,J as Be,K as H,S as Ie,w as Le,Q as qe,E as Pe,s as Je,a0 as re,R as ie,a4 as le,Y as Ue,D as Ke,ar as De}from"./vendor-icons-DEeYHfOp.js";import{L as $}from"./vendor-router-DdyOoyPF.js";import"./vendor-syntax-D6hV6JR3.js";import"./vendor-radix-hRiDuY7W.js";async function He(){return(await(await fetch("/auth/csrf-token",{credentials:"include"})).json()).csrf_token}function $e(n){return n.length>100*1024?Fe(n):(n=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),n.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?)/g,c=>{let p="text-orange-400";return/^"/.test(c)?/:$/.test(c)?p="text-sky-400":p="text-emerald-400":/true|false/.test(c)?p="text-purple-400":/null/.test(c)&&(p="text-red-400"),`<span class="${p}">${c}</span>`}))}function Fe(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function Ge(n){if(n.startsWith("/api/")||n.startsWith("/playground/"))return{valid:!0};try{const c=new URL(n,window.location.origin);return c.origin!==window.location.origin?{valid:!1,error:"Only same-origin requests are allowed"}:!c.pathname.startsWith("/api/")&&!c.pathname.startsWith("/playground/")?{valid:!1,error:"Only /api/ and /playground/ endpoints are allowed"}:{valid:!0}}catch{return{valid:!1,error:"Invalid URL format"}}}function ss(){const[n,c]=r.useState(""),[p,ce]=r.useState(!1),[O,oe]=r.useState({}),[F,de]=r.useState(new Set),[E,xe]=r.useState(""),[v,q]=r.useState([]),[z,y]=r.useState(null),[f,w]=r.useState("POST"),[h,S]=r.useState(""),[o,j]=r.useState(""),[P,J]=r.useState(!1),[b,k]=r.useState(null),[G,R]=r.useState(null),[_,U]=r.useState(null),[N,C]=r.useState(null),[M,W]=r.useState({}),[Q,pe]=r.useState(!0),he=r.useRef(null);r.useEffect(()=>{me(),fe()},[]);const me=async()=>{try{const s=await fetch("/playground/api-key",{credentials:"include"});if(s.ok){const t=await s.json();c(t.api_key||"")}}catch(s){console.error("Error loading API key:",s)}},fe=async()=>{try{const s=await fetch("/playground/endpoints",{credentials:"include"});if(s.ok){const t=await s.json();oe(t)}}catch(s){console.error("Error loading endpoints:",s),x.error("Failed to load endpoints")}},V=r.useCallback(s=>{let t={};return s.method==="GET"&&s.params?t={...s.params}:s.body&&(t={...s.body}),n&&!t.apikey&&(t.apikey=n),JSON.stringify(t,null,2)},[n]),X=s=>{const t=v.find(a=>a.endpoint.path===s.path);if(t)y(t.id),w(t.endpoint.method),S(t.endpoint.path),j(t.requestBody);else{const a={id:`${s.path}-${Date.now()}`,endpoint:s,requestBody:V(s),modified:!1};q(i=>[...i,a]),y(a.id),w(s.method),S(s.path),j(a.requestBody)}C(null),k(null),R(null),U(null)},ue=(s,t)=>{t.stopPropagation();const a=v.findIndex(l=>l.id===s),i=v.filter(l=>l.id!==s);if(q(i),z===s)if(i.length>0){const l=Math.min(a,i.length-1),m=i[l];y(m.id),w(m.endpoint.method),S(m.endpoint.path),j(m.requestBody)}else y(null),w("POST"),S(""),j("")},ge=s=>{y(s.id),w(s.endpoint.method),S(s.endpoint.path),j(s.requestBody),C(null),k(null)},Y=s=>{j(s),z&&q(t=>t.map(a=>a.id===z?{...a,requestBody:s,modified:s!==V(a.endpoint)}:a))},je=s=>{de(t=>{const a=new Set(t);return a.has(s)?a.delete(s):a.add(s),a})},be=()=>{try{const s=JSON.parse(o),t=JSON.stringify(s,null,2);Y(t),x.success("JSON prettified")}catch{x.error("Invalid JSON - cannot prettify")}},Ne=async()=>{if(!h){x.warning("Please select an endpoint");return}const s=Ge(h);if(!s.valid){x.error(s.error);return}J(!0),C(null),k(null),R(null),U(null),W({});const t=Date.now();try{const a={method:f,credentials:"include",headers:{Accept:"application/json"}};let i=h;if(f==="GET"){if(o.trim())try{const T=JSON.parse(o),A=new URL(h,window.location.origin);Object.entries(T).forEach(([Te,B])=>{B!=null&&B!==""&&A.searchParams.append(Te,String(B))}),i=A.toString()}catch{x.error("Invalid JSON for query parameters"),J(!1);return}}else{const T=await He();a.headers["Content-Type"]="application/json",a.headers["X-CSRFToken"]=T,o.trim()&&(a.body=o)}const l=await fetch(i,a),m=Date.now()-t,u={};l.headers.forEach((T,A)=>{u[A]=T}),W(u);let K;const ee=l.headers.get("content-type");ee?.includes("application/json")?K=await l.json():K={text:await l.text(),contentType:ee};const se=JSON.stringify(K,null,2);k(l.status),R(m),U(new Blob([se]).size),C(se)}catch(a){const i=Date.now()-t;k(0),R(i),C(JSON.stringify({error:a instanceof Error?a.message:"Unknown error"},null,2))}finally{J(!1)}},ve=()=>{N&&(navigator.clipboard.writeText(N),x.success("Response copied!"))},ze=()=>{n&&(navigator.clipboard.writeText(n),x.success("API key copied!"))},ye=()=>{if(!h)return;let s=h;if(f==="GET"&&o.trim())try{const i=JSON.parse(o),l=new URL(h,window.location.origin);Object.entries(i).forEach(([m,u])=>{u!=null&&u!==""&&l.searchParams.append(m,String(u))}),s=l.toString()}catch{x.error("Invalid JSON for query parameters");return}const t=new URL(s,window.location.origin).href;let a=`curl -X ${f} "${t}"`;a+=` \\
  -H "Accept: application/json"`,f!=="GET"&&o.trim()&&(a+=` \\
  -H "Content-Type: application/json"`,a+=` \\
  -d '${o.replace(/'/g,"'\\''")}'`),navigator.clipboard.writeText(a),x.success("Copied as cURL")},we=Object.entries(O).reduce((s,[t,a])=>{if(!E)s[t]=a;else{const i=a.filter(l=>l.name.toLowerCase().includes(E.toLowerCase())||l.path.toLowerCase().includes(E.toLowerCase()));i.length&&(s[t]=i)}return s},{}),Se=s=>s?s>=200&&s<300?"text-emerald-400":s>=400?"text-red-400":"text-yellow-400":"text-zinc-500",ke=s=>s?s>=200&&s<300?"bg-emerald-500/10":s>=400?"bg-red-500/10":"bg-yellow-500/10":"bg-zinc-500/10",Ce=s=>s>=1024?`${(s/1024).toFixed(1)}KB`:`${s}B`,Z=v.find(s=>s.id===z);return e.jsxs("div",{className:"h-full flex flex-col bg-zinc-950 text-zinc-100",children:[e.jsxs("div",{className:"h-12 border-b border-zinc-800 flex items-center px-2 bg-zinc-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{variant:"ghost",size:"icon",className:"h-8 w-8 text-zinc-400 hover:text-zinc-100 hover:bg-zinc-800",onClick:()=>pe(!Q),children:e.jsx(Ee,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-2 px-2",children:[e.jsx("img",{src:"/static/favicon/android-chrome-192x192.png",alt:"OpenAlgo",className:"w-6 h-6"}),e.jsx("span",{className:"font-semibold text-sm",children:"openalgo"})]})]}),e.jsxs("div",{className:"flex-1 flex items-center gap-1 px-4 overflow-x-auto",children:[v.map(s=>e.jsxs("div",{className:g("flex items-center gap-2 px-3 py-1.5 rounded-md text-xs cursor-pointer group","hover:bg-zinc-800",s.id===z?"bg-zinc-800 text-zinc-100":"text-zinc-400"),onClick:()=>ge(s),children:[e.jsx(D,{variant:"outline",className:g("text-[9px] px-1 py-0 h-4 border-0 font-semibold",s.endpoint.method==="GET"?"bg-sky-500/20 text-sky-400":"bg-emerald-500/20 text-emerald-400"),children:s.endpoint.method}),e.jsx("span",{className:"truncate max-w-[100px]",children:s.endpoint.name}),s.modified&&e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-amber-500"}),e.jsx("button",{type:"button",className:"opacity-0 group-hover:opacity-100 hover:text-zinc-100 p-0.5 -mr-1",onClick:t=>ue(s.id,t),children:e.jsx(Re,{className:"h-3 w-3"})})]},s.id)),e.jsx(d,{variant:"ghost",size:"icon",className:"h-6 w-6 text-zinc-500 hover:text-zinc-100 hover:bg-zinc-800",onClick:()=>{const s=Object.keys(O)[0];s&&O[s]?.[0]&&X(O[s][0])},children:e.jsx(Ae,{className:"h-3.5 w-3.5"})})]}),e.jsxs("div",{className:"flex items-center gap-2 px-2",children:[e.jsx(d,{variant:"ghost",size:"sm",className:"h-7 text-xs text-zinc-400 hover:text-zinc-100 hover:bg-zinc-800",asChild:!0,children:e.jsxs($,{to:"/dashboard",children:[e.jsx(Be,{className:"h-3.5 w-3.5 mr-1.5"}),"Dashboard"]})}),e.jsx(d,{variant:"ghost",size:"sm",className:"h-7 text-xs text-zinc-400 hover:text-zinc-100 hover:bg-zinc-800",asChild:!0,children:e.jsxs($,{to:"/apikey",children:[e.jsx(H,{className:"h-3.5 w-3.5 mr-1.5"}),"API Keys"]})})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:g("w-56 border-r border-zinc-800 bg-zinc-900/30 flex flex-col overflow-hidden","transition-all duration-200",Q?"translate-x-0":"-translate-x-full absolute h-full z-50"),children:[e.jsx("div",{className:"p-2 border-b border-zinc-800 shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ie,{className:"h-3.5 w-3.5 absolute left-2.5 top-1/2 -translate-y-1/2 text-zinc-500"}),e.jsx(te,{placeholder:"search",className:"h-7 pl-8 text-xs bg-zinc-800/50 border-zinc-700 text-zinc-100 placeholder:text-zinc-500",value:E,onChange:s=>xe(s.target.value)})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:e.jsx("div",{className:"p-2",children:Object.entries(we).map(([s,t])=>e.jsxs("div",{className:"mb-2",children:[e.jsxs("button",{type:"button",className:"flex items-center gap-1.5 w-full px-2 py-1 rounded text-[11px] font-medium uppercase tracking-wider text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800/50",onClick:()=>je(s),children:[F.has(s)?e.jsx(Le,{className:"h-3 w-3"}):e.jsx(qe,{className:"h-3 w-3"}),s]}),!F.has(s)&&e.jsx("div",{className:"mt-0.5 space-y-0.5",children:t.map((a,i)=>e.jsxs("button",{type:"button",className:g("w-full flex items-center gap-2 px-2 py-1 rounded text-left text-xs hover:bg-zinc-800/50",Z?.endpoint.path===a.path&&"bg-zinc-800 text-zinc-100"),onClick:()=>X(a),children:[e.jsx(D,{variant:"outline",className:g("text-[9px] px-1 py-0 h-4 border-0 font-semibold shrink-0",a.method==="GET"?"bg-sky-500/20 text-sky-400":"bg-emerald-500/20 text-emerald-400"),children:a.method}),e.jsx("span",{className:"truncate text-zinc-300",children:a.name})]},i))})]},s))})}),e.jsx("div",{className:"p-2 border-t border-zinc-800 shrink-0",children:e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded bg-zinc-800/50",children:[e.jsx(H,{className:"h-3 w-3 text-zinc-500"}),e.jsx(te,{type:p?"text":"password",value:n,readOnly:!0,className:"flex-1 h-5 text-[10px] font-mono bg-transparent border-none p-0 text-zinc-400",placeholder:"No API key"}),e.jsx(d,{variant:"ghost",size:"icon",className:"h-5 w-5 text-zinc-500 hover:text-zinc-300",onClick:()=>ce(!p),children:p?e.jsx(Pe,{className:"h-3 w-3"}):e.jsx(Je,{className:"h-3 w-3"})}),e.jsx(d,{variant:"ghost",size:"icon",className:"h-5 w-5 text-zinc-500 hover:text-zinc-300",onClick:ze,children:e.jsx(re,{className:"h-3 w-3"})})]})})]}),e.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:Z?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border-b border-zinc-800 bg-zinc-900/30",children:[e.jsx(D,{variant:"outline",className:g("text-xs px-2 py-0.5 border-0 font-semibold",f==="GET"?"bg-sky-500/20 text-sky-400":"bg-emerald-500/20 text-emerald-400"),children:f}),e.jsxs("div",{className:"flex-1 flex items-center gap-1 px-3 py-1.5 rounded bg-zinc-800/50 font-mono text-sm",children:[e.jsx("span",{className:"text-zinc-500",children:"http://127.0.0.1:5000"}),e.jsx("span",{className:"text-zinc-100",children:h})]}),e.jsx(d,{size:"sm",className:"h-8 px-4 bg-emerald-600 hover:bg-emerald-700 text-white",onClick:Ne,disabled:P,children:P?e.jsx(ie,{className:"h-4 w-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"h-3.5 w-3.5 mr-1.5"}),"Send"]})})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"flex-1 flex flex-col border-r border-zinc-800 min-w-0",children:e.jsxs(ae,{defaultValue:"body",className:"flex-1 flex flex-col min-h-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-1.5 border-b border-zinc-800 bg-zinc-900/30",children:[e.jsxs(ne,{className:"h-7 bg-transparent p-0 gap-2",children:[e.jsx(I,{value:"body",className:"h-6 px-2 text-xs data-[state=active]:bg-zinc-800 data-[state=active]:text-zinc-100 text-zinc-500",children:"Body"}),e.jsx(I,{value:"headers",className:"h-6 px-2 text-xs data-[state=active]:bg-zinc-800 data-[state=active]:text-zinc-100 text-zinc-500",children:"Headers"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-[10px] text-zinc-500 mr-2",children:"JSON"}),e.jsx(d,{variant:"ghost",size:"sm",className:"h-6 text-[10px] text-zinc-400 hover:text-zinc-100 hover:bg-zinc-800",onClick:be,children:"Prettify"})]})]}),e.jsx(L,{value:"body",className:"flex-1 m-0 overflow-hidden",children:e.jsxs("div",{className:"h-full flex bg-zinc-950",children:[e.jsx("div",{className:"w-10 bg-zinc-900/50 text-zinc-600 text-xs font-mono py-3 px-2 text-right select-none overflow-hidden border-r border-zinc-800",children:o.split(`
`).map((s,t)=>e.jsx("div",{className:"leading-5",children:t+1},t))}),e.jsx("textarea",{ref:he,className:"flex-1 p-3 font-mono text-xs bg-transparent border-none outline-none resize-none text-zinc-100 leading-5",placeholder:'{"apikey": ""}',value:o,onChange:s=>Y(s.target.value),spellCheck:!1})]})}),e.jsx(L,{value:"headers",className:"flex-1 m-0 p-4 overflow-auto bg-zinc-950",children:e.jsxs("div",{className:"text-xs font-mono space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-500",children:"Content-Type:"}),e.jsx("span",{className:"text-zinc-300",children:"application/json"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-500",children:"Accept:"}),e.jsx("span",{className:"text-zinc-300",children:"application/json"})]})]})})]})}),e.jsx("div",{className:"flex-1 flex flex-col min-w-0",children:e.jsxs(ae,{defaultValue:"response",className:"flex-1 flex flex-col min-h-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-1.5 border-b border-zinc-800 bg-zinc-900/30",children:[e.jsxs(ne,{className:"h-7 bg-transparent p-0 gap-2",children:[e.jsx(I,{value:"response",className:"h-6 px-2 text-xs data-[state=active]:bg-zinc-800 data-[state=active]:text-zinc-100 text-zinc-500",children:"Response"}),e.jsx(I,{value:"headers",className:"h-6 px-2 text-xs data-[state=active]:bg-zinc-800 data-[state=active]:text-zinc-100 text-zinc-500",children:"Headers"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs font-mono",children:[b!==null&&e.jsxs("span",{className:g("px-2 py-0.5 rounded",ke(b),Se(b)),children:[b," ",b>=200&&b<300?"OK":"Error"]}),G!==null&&e.jsxs("span",{className:"text-zinc-500 flex items-center gap-1",children:[e.jsx(Ue,{className:"h-3 w-3"}),G,"ms"]}),_!==null&&e.jsxs("span",{className:"text-zinc-500 flex items-center gap-1",children:[e.jsx(Ke,{className:"h-3 w-3"}),Ce(_)]}),e.jsxs(d,{variant:"ghost",size:"sm",className:"h-6 text-[10px] text-zinc-500 hover:text-zinc-100 hover:bg-zinc-800",onClick:ye,children:[e.jsx(De,{className:"h-3 w-3 mr-1"}),"cURL"]}),N&&e.jsx(d,{variant:"ghost",size:"icon",className:"h-6 w-6 text-zinc-500 hover:text-zinc-100",onClick:ve,children:e.jsx(re,{className:"h-3 w-3"})})]})]}),e.jsx(L,{value:"response",className:"flex-1 m-0 overflow-hidden",children:e.jsx("div",{className:"h-full flex bg-zinc-950",children:N?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-10 bg-zinc-900/50 text-zinc-600 text-xs font-mono py-3 px-2 text-right select-none overflow-hidden border-r border-zinc-800",children:N.split(`
`).map((s,t)=>e.jsx("div",{className:"leading-5",children:t+1},t))}),e.jsx(Oe,{className:"flex-1 p-3",children:e.jsx("pre",{className:"text-xs font-mono whitespace-pre-wrap break-words leading-5",dangerouslySetInnerHTML:{__html:$e(N)}})})]}):e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center text-center",children:P?e.jsx(ie,{className:"h-8 w-8 text-zinc-700 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"h-10 w-10 text-zinc-800 mb-3"}),e.jsx("p",{className:"text-zinc-600 text-sm",children:"No response yet"}),e.jsx("p",{className:"text-zinc-700 text-xs mt-1",children:"Click Send to make a request"})]})})})}),e.jsx(L,{value:"headers",className:"flex-1 m-0 p-4 overflow-auto bg-zinc-950",children:Object.keys(M).length>0?e.jsx("div",{className:"text-xs font-mono space-y-2",children:Object.entries(M).map(([s,t])=>e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("span",{className:"text-zinc-500",children:[s,":"]}),e.jsx("span",{className:"text-zinc-300 break-all",children:t})]},s))}):e.jsx("div",{className:"text-xs text-zinc-600",children:"No headers to display"})})]})})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center bg-zinc-950",children:[e.jsx("img",{src:"/static/favicon/android-chrome-192x192.png",alt:"OpenAlgo",className:"w-16 h-16 mb-4"}),e.jsx("h2",{className:"text-lg font-semibold text-zinc-300 mb-2",children:"API Playground"}),e.jsx("p",{className:"text-zinc-500 text-sm mb-4",children:"Select an endpoint from the sidebar to get started"}),!n&&e.jsx(d,{variant:"outline",size:"sm",className:"border-zinc-700 text-zinc-300",asChild:!0,children:e.jsxs($,{to:"/apikey",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Generate API Key"]})})]})})]})]})}export{ss as default};
