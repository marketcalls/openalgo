import{r as c,j as e}from"./vendor-react-RhKMXzW9.js";import{e as L,B as v,c as f,t as Q}from"./index-DJwClDQW.js";import{I as Me}from"./input-Bq8Eye_d.js";import{S as Le,a as Oe,b as Fe,c as Ie,d as ae}from"./select-C7Sl7NE-.js";import{S as Pe}from"./switch-ZcCoIFAt.js";import{am as ne,R as re,an as Ue,ao as We,ap as De,aq as Qe,ar as qe,as as Be,aj as ce,at as Je,N as He,au as Xe,al as Ke,av as Ve,Z as ie,S as Ze,aw as Ge,X as Ye,e as es,ax as ss,aa as oe,V as le,w as ts,c as as,W as ns,a7 as rs,a8 as cs,Q as is}from"./vendor-icons-2oyLmcSr.js";import"./vendor-syntax-D6hV6JR3.js";import"./vendor-router-DdyOoyPF.js";import"./vendor-radix-B_grJx4K.js";async function os(){return(await(await fetch("/auth/csrf-token",{credentials:"include"})).json()).csrf_token}const ls=["NSE","NFO","BSE","BFO","CDS","MCX"];function q(n){return new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(n)}function ds(n){return n>=1e7?`${(n/1e7).toFixed(2)}Cr`:n>=1e5?`${(n/1e5).toFixed(2)}L`:n>=1e3?`${(n/1e3).toFixed(1)}K`:n.toString()}function us(n){return n?new Date(n).toLocaleTimeString("en-IN",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}):"--:--:--"}function xs(n){const b=Math.floor(n/3600),j=Math.floor(n%3600/60),g=Math.floor(n%60);return`${b.toString().padStart(2,"0")}:${j.toString().padStart(2,"0")}:${g.toString().padStart(2,"0")}`}function O({status:n,size:b="md"}){const j=b==="sm"?"w-2 h-2":"w-3 h-3";return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:f(j,"rounded-full transition-all duration-500",n==="success"&&"bg-emerald-400 shadow-[0_0_8px_rgba(52,211,153,0.8)]",n==="warning"&&"bg-amber-400 shadow-[0_0_8px_rgba(251,191,36,0.8)]",n==="error"&&"bg-rose-400 shadow-[0_0_8px_rgba(251,113,133,0.8)]",n==="idle"&&"bg-zinc-600")}),n!=="idle"&&e.jsx("div",{className:f("absolute inset-0 rounded-full animate-ping opacity-40",n==="success"&&"bg-emerald-400",n==="warning"&&"bg-amber-400",n==="error"&&"bg-rose-400")})]})}function z({label:n,value:b,icon:j,status:g,subtitle:w}){return e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/5 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative px-4 py-3 rounded-lg bg-[#0d0d14] border border-zinc-800/60 hover:border-zinc-700/60 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsx(j,{className:"w-3.5 h-3.5 text-zinc-500"}),g&&e.jsx(O,{status:g,size:"sm"})]}),e.jsx("div",{className:"text-lg font-bold font-mono text-zinc-100 tracking-tight",children:b}),e.jsx("div",{className:"text-[10px] uppercase tracking-wider text-zinc-500 mt-0.5",children:n}),w&&e.jsx("div",{className:"text-[9px] text-zinc-600 mt-1",children:w})]})]})}function de({price:n,quantity:b,maxQty:j,side:g}){const w=Math.min(b/j*100,100);return e.jsxs("div",{className:"relative flex items-center gap-2 py-1",children:[e.jsx("div",{className:"absolute inset-0 rounded overflow-hidden",children:e.jsx("div",{className:f("absolute top-0 bottom-0 transition-all duration-300",g==="buy"?"left-0 bg-gradient-to-r from-emerald-500/20 to-transparent":"right-0 bg-gradient-to-l from-rose-500/20 to-transparent"),style:{width:`${w}%`}})}),e.jsx("span",{className:"relative z-10 flex-1 font-mono text-xs text-zinc-400",children:q(n)}),e.jsx("span",{className:f("relative z-10 font-mono text-xs font-medium",g==="buy"?"text-emerald-400":"text-rose-400"),children:b.toLocaleString()})]})}function Ns(){const[n,b]=c.useState(!1),[j,g]=c.useState(!1),[w,F]=c.useState(!1),[B,ue]=c.useState(!0),p=c.useRef(null),E=c.useRef(null),[d,xe]=c.useState(null),[he,me]=c.useState(0),[J,pe]=c.useState(null),[N,S]=c.useState(new Map),[k,H]=c.useState(""),[I,be]=c.useState(""),[X,P]=c.useState([]),[ge,C]=c.useState(!1),[fe,K]=c.useState(!1),[je,ve]=c.useState(new Set),[we,Ne]=c.useState(new Set),[_,ye]=c.useState(!1),[$,V]=c.useState([]),[A,Z]=c.useState([]),R=c.useRef(null),U=c.useRef(null),l=c.useCallback((s,t="info")=>{const a=new Date().toLocaleTimeString("en-IN",{hour12:!1});V(o=>[...o.slice(-199),{timestamp:a,message:s,type:t}])},[]),Se=c.useCallback(s=>{const t=new Date().toLocaleTimeString("en-IN",{hour12:!1});Z(a=>[...a.slice(-99),`[${t}] ${s}`])},[]),T=c.useCallback(async()=>os(),[]),M=c.useCallback(async()=>{try{const s=await T(),a=await(await fetch("/api/websocket/health",{headers:{"X-CSRFToken":s},credentials:"include"})).json();xe(a)}catch(s){console.debug("Health status fetch failed:",s)}},[T]);c.useEffect(()=>{M();const s=setInterval(M,5e3);return()=>clearInterval(s)},[M]);const G=async()=>{if(p.current?.readyState===WebSocket.OPEN){l("Already connected","warn");return}g(!0),l("Initiating connection...","info");try{const s=await T(),a=await(await fetch("/api/websocket/config",{headers:{"X-CSRFToken":s},credentials:"include"})).json();if(a.status!=="success")throw new Error("Config fetch failed");const o=a.websocket_url;l(`Connecting to ${o}`,"info");const i=new WebSocket(o);i.onopen=async()=>{l("Connection established","success"),b(!0),g(!1);try{const r=await T(),m=await(await fetch("/api/websocket/apikey",{headers:{"X-CSRFToken":r},credentials:"include"})).json();m.status==="success"&&m.api_key?(i.send(JSON.stringify({action:"authenticate",api_key:m.api_key})),l("Auth request sent","info")):l("No API key found - visit /apikey","error")}catch(r){l(`Auth error: ${r}`,"error")}},i.onclose=r=>{b(!1),g(!1),F(!1),l(`Disconnected (code: ${r.code})`,r.wasClean?"info":"error"),B&&!r.wasClean&&(l("Auto-reconnect in 3s...","warn"),E.current=setTimeout(G,3e3))},i.onerror=()=>{l("Connection error","error"),g(!1)},i.onmessage=r=>{me(x=>x+1),pe(Date.now()),Se(r.data);try{const x=JSON.parse(r.data);ke(x)}catch{l("Parse error","error")}},p.current=i}catch(s){l(`Connection failed: ${s}`,"error"),g(!1)}},ze=()=>{E.current&&(clearTimeout(E.current),E.current=null),p.current&&(p.current.close(1e3,"User disconnect"),p.current=null),b(!1),F(!1),l("Disconnected by user","info")},ke=c.useCallback(s=>{switch(s.type||s.status){case"auth":s.status==="success"?(F(!0),l(`Authenticated: ${s.user_id} @ ${s.broker}`,"success")):l(`Auth failed: ${s.message}`,"error");break;case"market_data":{const a=s.symbol.toUpperCase(),o=s.exchange,i=s.mode,r=s.data||{};S(x=>{const m=`${o}:${a}`,y=x.get(m);if(!y)return x;const u=new Map(x),h={...y.data};return(i===1||i===2)&&Object.assign(h,{ltp:r.ltp??h.ltp,open:r.open??h.open,high:r.high??h.high,low:r.low??h.low,close:r.close??h.close,volume:r.volume??h.volume,change:r.change??h.change,change_percent:r.change_percent??h.change_percent,timestamp:r.timestamp??h.timestamp}),i===3&&r.depth&&(h.depth=r.depth),u.set(m,{...y,data:h,lastUpdate:Date.now()}),u});break}case"subscribe":l(s.status==="success"?"Subscribed":`Sub error: ${s.message}`,s.status==="success"?"success":"error");break;case"unsubscribe":l("Unsubscribed","info");break;case"error":l(`Error: ${s.message}`,"error");break}},[l]),Y=(s,t,a)=>{if(!p.current||p.current.readyState!==WebSocket.OPEN){Q.error("Not connected");return}p.current.send(JSON.stringify({action:"subscribe",symbols:[{symbol:s,exchange:t}],mode:a})),S(o=>{const i=`${t}:${s}`,r=o.get(i);if(!r)return o;const x=new Map(o),m=new Set(r.subscriptions);return m.add(a),x.set(i,{...r,subscriptions:m}),x}),l(`Sub: ${t}:${s} [${a}]`,"info")},ee=(s,t,a)=>{if(!p.current||p.current.readyState!==WebSocket.OPEN)return;const o={LTP:1,Quote:2,Depth:3};p.current.send(JSON.stringify({action:"unsubscribe",symbols:[{symbol:s,exchange:t,mode:o[a]}],mode:a})),S(i=>{const r=`${t}:${s}`,x=i.get(r);if(!x)return i;const m=new Map(i),y=new Set(x.subscriptions);return y.delete(a),m.set(r,{...x,subscriptions:y}),m})},W=s=>{if(N.size===0){Q.error("Add symbols first");return}N.forEach((t,a)=>{const[o,i]=a.split(":");Y(i,o,s)})},se=()=>{!p.current||p.current.readyState!==WebSocket.OPEN||(p.current.send(JSON.stringify({action:"unsubscribe_all"})),S(s=>{const t=new Map(s);return t.forEach((a,o)=>t.set(o,{...a,subscriptions:new Set})),t}),l("Unsubscribed all","info"))},te=c.useCallback(async(s,t)=>{if(s.length<2){P([]),C(!1);return}K(!0);try{const a=new URLSearchParams({q:s});t&&t!=="_all"&&a.append("exchange",t);const i=await(await fetch(`/search/api/search?${a}`,{credentials:"include"})).json();P((i.results||[]).slice(0,8)),C(!0)}catch(a){console.debug("Symbol search failed:",a),P([])}finally{K(!1)}},[]);c.useEffect(()=>{const s=setTimeout(()=>{k.length>=2&&te(k,I)},200);return()=>clearTimeout(s)},[k,I,te]);const Ce=(s,t)=>{const a=`${t}:${s}`;if(N.has(a)){Q.error("Already added");return}S(o=>new Map(o).set(a,{symbol:s,exchange:t,data:{},subscriptions:new Set})),H(""),C(!1),l(`Added: ${a}`,"success")},_e=(s,t)=>{const a=`${t}:${s}`;N.get(a)?.subscriptions.forEach(i=>ee(s,t,i)),S(i=>{const r=new Map(i);return r.delete(a),r}),l(`Removed: ${a}`,"info")},Ee=()=>{se(),S(new Map),l("Cleared all symbols","info")},$e=s=>{ve(t=>{const a=new Set(t);return a.has(s)?a.delete(s):a.add(s),a})},Ae=s=>{Ne(t=>{const a=new Set(t);return a.has(s)?a.delete(s):a.add(s),a})};c.useEffect(()=>{const s=t=>{U.current&&!U.current.contains(t.target)&&C(!1)};return document.addEventListener("click",s),()=>document.removeEventListener("click",s)},[]),c.useEffect(()=>{R.current&&(R.current.scrollTop=R.current.scrollHeight)},[$,A]),c.useEffect(()=>{const s=localStorage.getItem("ws_test_symbols");if(s)try{const t=JSON.parse(s),a=new Map;t.forEach(o=>{const[i,r]=o.split(":");a.set(o,{symbol:r,exchange:i,data:{},subscriptions:new Set})}),S(a)}catch(t){console.debug("Failed to load saved symbols:",t)}},[]),c.useEffect(()=>{localStorage.setItem("ws_test_symbols",JSON.stringify(Array.from(N.keys())))},[N]);const Re=n?w?"success":"warning":j?"warning":"idle",Te=d===null?"idle":d.data_flow_healthy?"success":d.connected?"warning":"error";return e.jsxs("div",{className:"min-h-screen bg-[#08080c] text-zinc-100",children:[e.jsx("div",{className:"fixed inset-0 opacity-[0.015] pointer-events-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E")`}}),e.jsxs("div",{className:"relative",children:[e.jsx("header",{className:"border-b border-zinc-800/60 bg-[#0a0a10]/80 backdrop-blur-xl sticky top-0 z-40",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-cyan-500/20 via-cyan-500/10 to-transparent border border-cyan-500/30 flex items-center justify-center",children:e.jsx(ne,{className:"w-6 h-6 text-cyan-400"})}),e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5",children:e.jsx(O,{status:Re})})]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-bold tracking-tight flex items-center gap-2",children:["WebSocket Console",e.jsx(L,{variant:"outline",className:"text-[9px] border-cyan-500/30 text-cyan-400 font-mono",children:"TEST"})]}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Real-time market data testing interface"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-zinc-500",children:[e.jsx(Pe,{checked:B,onCheckedChange:ue}),e.jsx("span",{children:"Auto-reconnect"})]}),e.jsx("div",{className:"flex items-center gap-2",children:n?e.jsxs(v,{onClick:ze,variant:"outline",className:"gap-2 border-rose-500/30 text-rose-400 hover:bg-rose-500/10",children:[e.jsx(We,{className:"w-4 h-4"}),"Disconnect"]}):e.jsxs(v,{onClick:G,disabled:j,className:"gap-2 bg-gradient-to-r from-cyan-600 to-cyan-500 hover:from-cyan-500 hover:to-cyan-400 text-white font-semibold shadow-lg shadow-cyan-500/20",children:[j?e.jsx(re,{className:"w-4 h-4 animate-spin"}):e.jsx(Ue,{className:"w-4 h-4"}),j?"Connecting":"Connect"]})}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-zinc-900/50 border border-zinc-800/60",children:[w?e.jsx(De,{className:"w-4 h-4 text-emerald-400"}):n?e.jsx(Qe,{className:"w-4 h-4 text-amber-400"}):e.jsx(qe,{className:"w-4 h-4 text-zinc-500"}),e.jsx("span",{className:f("text-sm font-medium",w?"text-emerald-400":n?"text-amber-400":"text-zinc-500"),children:w?"Authenticated":n?"Connected":"Offline"})]})]})]})})}),e.jsxs("main",{className:"container mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-3",children:[e.jsx(z,{label:"System",value:d?.healthy?"OK":"WARN",icon:Be,status:d?.healthy?"success":d?"warning":"idle"}),e.jsx(z,{label:"Data Flow",value:d?.data_flow_healthy?"Active":"Stalled",icon:ce,status:Te}),e.jsx(z,{label:"Trade Safe",value:d?d.trade_management_safe?"Yes":"No":"--",icon:Je,status:d===null?"idle":d.trade_management_safe?"success":"error"}),e.jsx(z,{label:"Data Age",value:d?.last_data_age_seconds!==void 0?`${d.last_data_age_seconds.toFixed(1)}s`:"--",icon:He,status:d===null?"idle":d.last_data_age_seconds<5?"success":"warning"}),e.jsx(z,{label:"Cache",value:d?.cache_size??0,icon:Xe,subtitle:`${d?.total_updates_processed??0} updates`}),e.jsx(z,{label:"Subscribers",value:d?.total_subscribers??0,icon:Ke,subtitle:`${d?.critical_subscribers??0} critical`}),e.jsx(z,{label:"Messages",value:he,icon:Ve,subtitle:J?`${((Date.now()-J)/1e3).toFixed(1)}s ago`:"--"}),e.jsx(z,{label:"Uptime",value:d?.uptime_seconds?xs(d.uptime_seconds):"--:--:--",icon:ie,subtitle:`${d?.reconnect_count??0} reconnects`})]}),e.jsxs("div",{className:"rounded-xl bg-[#0d0d14] border border-zinc-800/60 p-5",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",ref:U,children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ze,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500"}),e.jsx(Me,{type:"text",placeholder:"Search symbols...",value:k,onChange:s=>H(s.target.value),onFocus:()=>k.length>=2&&C(!0),className:"pl-10 bg-zinc-900/50 border-zinc-700/50 text-zinc-100 placeholder:text-zinc-600 focus:border-cyan-500/50 focus:ring-cyan-500/20"}),fe&&e.jsx(re,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500 animate-spin"})]}),ge&&X.length>0&&e.jsx("div",{className:"absolute z-50 w-full mt-2 rounded-lg border border-zinc-700/50 bg-zinc-900/98 backdrop-blur-xl shadow-2xl overflow-hidden",children:X.map((s,t)=>e.jsx("div",{className:"px-4 py-3 border-b border-zinc-800/50 last:border-0 hover:bg-cyan-500/5 cursor-pointer transition-colors",onClick:()=>Ce(s.symbol,s.exchange),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-zinc-100",children:s.symbol}),e.jsx("p",{className:"text-xs text-zinc-500 mt-0.5 line-clamp-1",children:s.name})]}),e.jsx(L,{variant:"outline",className:"text-[10px] border-zinc-700 text-zinc-400",children:s.exchange})]})},t))})]}),e.jsxs(Le,{value:I,onValueChange:be,children:[e.jsx(Oe,{className:"w-full lg:w-40 bg-zinc-900/50 border-zinc-700/50 text-zinc-300",children:e.jsx(Fe,{placeholder:"All Exchanges"})}),e.jsxs(Ie,{className:"bg-zinc-900 border-zinc-700",children:[e.jsx(ae,{value:"_all",children:"All Exchanges"}),ls.map(s=>e.jsx(ae,{value:s,children:s},s))]})]}),e.jsx(v,{variant:"outline",onClick:M,className:"border-zinc-700/50 hover:bg-zinc-800/50",children:e.jsx(Ge,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[Array.from(N.entries()).map(([s,t])=>e.jsxs(L,{variant:"secondary",className:f("gap-1.5 py-1.5 px-3 border transition-colors",t.subscriptions.size>0?"bg-cyan-500/10 border-cyan-500/30 text-cyan-300":"bg-zinc-800/50 border-zinc-700/50 text-zinc-400"),children:[e.jsx("span",{className:"font-mono text-xs",children:s}),t.subscriptions.size>0&&e.jsx(O,{status:"success",size:"sm"}),e.jsx("button",{type:"button",onClick:()=>_e(t.symbol,t.exchange),className:"ml-1 hover:text-rose-400 transition-colors",children:e.jsx(Ye,{className:"h-3 w-3"})})]},s)),N.size===0&&e.jsx("span",{className:"text-sm text-zinc-600",children:"No symbols. Search to add."})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(v,{onClick:()=>W("LTP"),variant:"outline",disabled:!n,size:"sm",className:"border-amber-500/30 text-amber-400 hover:bg-amber-500/10 disabled:opacity-30",children:[e.jsx(ie,{className:"w-3.5 h-3.5 mr-1.5"})," LTP All"]}),e.jsxs(v,{onClick:()=>W("Quote"),variant:"outline",disabled:!n,size:"sm",className:"border-cyan-500/30 text-cyan-400 hover:bg-cyan-500/10 disabled:opacity-30",children:[e.jsx(ce,{className:"w-3.5 h-3.5 mr-1.5"})," Quote All"]}),e.jsxs(v,{onClick:()=>W("Depth"),variant:"outline",disabled:!n,size:"sm",className:"border-violet-500/30 text-violet-400 hover:bg-violet-500/10 disabled:opacity-30",children:[e.jsx(es,{className:"w-3.5 h-3.5 mr-1.5"})," Depth All"]}),e.jsxs(v,{onClick:se,variant:"outline",disabled:!n,size:"sm",className:"border-rose-500/30 text-rose-400 hover:bg-rose-500/10 disabled:opacity-30",children:[e.jsx(ss,{className:"w-3.5 h-3.5 mr-1.5"})," Unsub All"]}),e.jsxs(v,{onClick:Ee,variant:"outline",size:"sm",className:"border-zinc-700/50 text-zinc-400 hover:bg-zinc-800/50",children:[e.jsx(oe,{className:"w-3.5 h-3.5 mr-1.5"})," Clear All"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:Array.from(N.entries()).map(([s,t])=>{const a=t.data.change??0,o=t.data.change_percent??0,i=a>=0,r=t.data.ltp!==void 0,x=!!(t.lastUpdate&&Date.now()-t.lastUpdate<5e3),m=we.has(s),y=je.has(s);return e.jsxs("div",{className:f("rounded-xl border bg-[#0d0d14] overflow-hidden transition-all",x?"border-cyan-500/40":"border-zinc-800/60"),children:[x&&e.jsx("div",{className:"h-0.5 bg-gradient-to-r from-cyan-500 via-emerald-500 to-cyan-500"}),e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-zinc-800/40",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>Ae(s),className:"hover:text-cyan-400 transition-colors",children:m?e.jsx(le,{className:"w-4 h-4"}):e.jsx(ts,{className:"w-4 h-4"})}),e.jsx("span",{className:"font-bold font-mono text-lg",children:s}),x&&e.jsx(O,{status:"success",size:"sm"})]}),e.jsx("div",{className:"flex gap-1",children:["LTP","Quote","Depth"].map(u=>{const h=t.subscriptions.has(u);return e.jsx("button",{type:"button",onClick:()=>h?ee(t.symbol,t.exchange,u):Y(t.symbol,t.exchange,u),className:f("px-2.5 py-1 text-[10px] font-bold rounded-md transition-all",h?"bg-cyan-500/20 text-cyan-400 border border-cyan-500/40":"bg-zinc-800/50 text-zinc-500 border border-zinc-700/50 hover:text-zinc-300"),children:u},u)})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-end justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] uppercase tracking-wider text-zinc-500 mb-1",children:"LTP"}),e.jsx("div",{className:"text-3xl font-bold font-mono tracking-tight",children:r?`â‚¹${q(t.data.ltp)}`:"---"})]}),r&&e.jsxs("div",{className:f("flex items-center gap-1.5 px-2.5 py-1 rounded-lg text-sm font-semibold",i?"bg-emerald-500/10 text-emerald-400":"bg-rose-500/10 text-rose-400"),children:[i?e.jsx(as,{className:"w-4 h-4"}):e.jsx(ns,{className:"w-4 h-4"}),i?"+":"",o.toFixed(2),"%"]})]}),(m||r)&&e.jsx("div",{className:"grid grid-cols-5 gap-2 mb-4",children:[{label:"Open",value:t.data.open},{label:"High",value:t.data.high,color:"text-emerald-400"},{label:"Low",value:t.data.low,color:"text-rose-400"},{label:"Close",value:t.data.close},{label:"Vol",value:t.data.volume,format:"volume"}].map(u=>e.jsxs("div",{className:"bg-zinc-900/50 rounded-lg px-2 py-1.5",children:[e.jsx("div",{className:"text-[8px] uppercase tracking-wider text-zinc-500",children:u.label}),e.jsx("div",{className:f("text-xs font-mono font-semibold mt-0.5",u.color||"text-zinc-300"),children:u.value!==void 0?u.format==="volume"?ds(u.value):q(u.value):"--"})]},u.label))}),t.data.depth&&e.jsxs("div",{children:[e.jsxs("button",{type:"button",onClick:()=>$e(s),className:"flex items-center gap-2 text-xs text-zinc-500 hover:text-zinc-300 transition-colors mb-2",children:[e.jsx(le,{className:f("w-3 h-3 transition-transform",y&&"rotate-180")}),"Market Depth (",t.data.depth.buy.length,"/",t.data.depth.sell.length,")"]}),y&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-3 bg-zinc-900/30 rounded-lg border border-zinc-800/40",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-[9px] uppercase tracking-wider text-emerald-400 mb-2 flex items-center gap-1",children:[e.jsx(rs,{className:"w-3 h-3"})," Bids"]}),t.data.depth.buy.slice(0,5).map((u,h)=>e.jsx(de,{price:u.price,quantity:u.quantity,maxQty:Math.max(1,...t.data.depth.buy.map(D=>D.quantity)),side:"buy"},h))]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-[9px] uppercase tracking-wider text-rose-400 mb-2 flex items-center gap-1",children:[e.jsx(cs,{className:"w-3 h-3"})," Asks"]}),t.data.depth.sell.slice(0,5).map((u,h)=>e.jsx(de,{price:u.price,quantity:u.quantity,maxQty:Math.max(1,...t.data.depth.sell.map(D=>D.quantity)),side:"sell"},h))]})]})]}),e.jsx("div",{className:"text-[10px] text-zinc-600 mt-3 font-mono",children:us(t.data.timestamp)})]})]},s)})}),e.jsxs("div",{className:"rounded-xl bg-[#0d0d14] border border-zinc-800/60 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-zinc-800/40",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ne,{className:"w-4 h-4 text-zinc-500"}),e.jsx("span",{className:"text-sm font-medium text-zinc-400",children:"Console"}),e.jsx(L,{variant:"outline",className:"text-[9px] border-zinc-700 text-zinc-500",children:_?A.length:$.length})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(v,{variant:"ghost",size:"sm",onClick:()=>ye(!_),className:f("h-7 px-2 text-xs",_?"text-cyan-400":"text-zinc-500"),children:[e.jsx(is,{className:"w-3.5 h-3.5 mr-1"}),_?"Parsed":"Raw"]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>{V([]),Z([])},className:"h-7 px-2 text-zinc-500 hover:text-zinc-300",children:e.jsx(oe,{className:"w-3.5 h-3.5"})})]})]}),e.jsx("div",{ref:R,className:"h-56 overflow-y-auto p-4 font-mono text-xs space-y-0.5",children:_?A.length===0?e.jsx("div",{className:"text-zinc-600",children:"No raw messages..."}):A.map((s,t)=>e.jsx("div",{className:"text-zinc-500 break-all",children:s},t)):$.length===0?e.jsx("div",{className:"text-zinc-600",children:"Waiting for events..."}):$.map((s,t)=>e.jsxs("div",{className:f("py-0.5",s.type==="success"&&"text-emerald-400",s.type==="error"&&"text-rose-400",s.type==="warn"&&"text-amber-400",s.type==="data"&&"text-cyan-400",s.type==="info"&&"text-zinc-500"),children:[e.jsxs("span",{className:"text-zinc-600",children:["[",s.timestamp,"]"]})," ",s.message]},t))})]})]})]})]})}export{Ns as default};
