import{k as He,m as ze,n as Ke,r as N,j as e,H as Se,P as Te,p as Fe,q as $e,E as Je,t as Ze,v as es,B as ss,C as as,M as ls,w as ts}from"./vendor-react-CGzGqrTW.js";import{u as Ae,f as te,k as rs,a as ce,m as ns,b as is,d as cs,n as os,o as ds,p as xs}from"./flow-DsAWQHrf.js";import{R as us,c as S,D as Le,h as Be,i as Re,T as hs,U as ps,V as ms,j as xe,B as D,t as V,v as gs}from"./index-DSmoyH68.js";import{I as n}from"./input-cGzzj6OP.js";import{ay as js,P as re,B as bs,aK as vs,aT as Ns,Z as ys,c as be,e as ve,an as fs,aU as Cs,a1 as Ss,a0 as ue,aG as Ts,g as Ee,aV as Es,am as oe,al as Os,aW as ws,aA as ks,b as Is,aX as Ms,aY as Vs,aZ as Ps,a_ as Oe,x as Ds,V as Fs,a$ as As,aw as Ls,b0 as Bs,b1 as Rs,F as _s,a9 as Us,b2 as Gs,b3 as Ws,b4 as qs,b5 as Ys,b6 as Qs,W as we,af as Xs,X as _e,L as ne,a2 as ke,E as Hs,u as zs,I as Ks,ar as ye,C as Ie,v as $s,A as Js,ak as Zs,aF as ea,aH as sa,aP as aa,q as la}from"./vendor-icons-CBMEOhEM.js";import{S as fe}from"./scroll-area-Uv_NYwn2.js";import{T as ta,a as ra,b as H,c as z}from"./tabs-C9cOAYYm.js";import{L as t}from"./label-D8PnukU6.js";import{S as Ne}from"./separator-BYeHMrob.js";import{S as Me}from"./switch-szjheHXh.js";import{T as U}from"./textarea-DH_NONgC.js";import{S as d,a as x,b as u,c as h,d as r}from"./select-BbHmG42G.js";import{d as Ue,a as na}from"./vendor-router--5gYmsyY.js";import"./vendor-charts-l0_txfiz.js";import"./vendor-radix-DhJbiBt_.js";const Ve={id:null,name:"Untitled Workflow",description:"",nodes:[],edges:[],selectedNodeId:null,selectedEdgeId:null,isModified:!1},Ce=us((c,b)=>({...Ve,setWorkflow:i=>c({id:i.id,name:i.name,description:i.description,nodes:i.nodes,edges:i.edges,isModified:!1,selectedNodeId:null,selectedEdgeId:null}),setName:i=>c({name:i,isModified:!0}),setDescription:i=>c({description:i,isModified:!0}),resetWorkflow:()=>c(Ve),markSaved:()=>c({isModified:!1}),setNodes:i=>c({nodes:i,isModified:!0}),onNodesChange:i=>{c({nodes:Ke(i,b().nodes),isModified:!0})},addNode:i=>c(j=>({nodes:[...j.nodes,i],isModified:!0})),updateNodeData:(i,j)=>c(v=>({nodes:v.nodes.map(y=>y.id===i?{...y,data:{...y.data,...j}}:y),isModified:!0})),deleteNode:i=>c(j=>({nodes:j.nodes.filter(v=>v.id!==i),edges:j.edges.filter(v=>v.source!==i&&v.target!==i),selectedNodeId:j.selectedNodeId===i?null:j.selectedNodeId,isModified:!0})),setEdges:i=>c({edges:i,isModified:!0}),onEdgesChange:i=>{c({edges:ze(i,b().edges),isModified:!0})},onConnect:i=>{c({edges:He({...i,id:`edge-${Date.now()}`,type:"insertable",animated:!0},b().edges),isModified:!0})},deleteEdge:i=>c(j=>({edges:j.edges.filter(v=>v.id!==i),selectedEdgeId:j.selectedEdgeId===i?null:j.selectedEdgeId,isModified:!0})),selectNode:i=>c({selectedNodeId:i,selectedEdgeId:null}),selectEdge:i=>c({selectedEdgeId:i,selectedNodeId:null}),deleteSelected:()=>c(i=>{const{selectedNodeId:j,selectedEdgeId:v,nodes:y,edges:T}=i;return j?{nodes:y.filter(m=>m.id!==j),edges:T.filter(m=>m.source!==j&&m.target!==j),selectedNodeId:null,isModified:!0}:v?{edges:T.filter(m=>m.id!==v),selectedEdgeId:null,isModified:!0}:i})})),w=[{value:"NSE",label:"NSE"},{value:"BSE",label:"BSE"},{value:"NFO",label:"NFO"},{value:"BFO",label:"BFO"},{value:"CDS",label:"CDS"},{value:"BCD",label:"BCD"},{value:"MCX",label:"MCX"},{value:"NSE_INDEX",label:"NSE_INDEX"},{value:"BSE_INDEX",label:"BSE_INDEX"}],K=[{value:"MIS",label:"MIS",description:"Intraday (auto square-off)"},{value:"CNC",label:"CNC",description:"Cash & Carry for equity delivery"},{value:"NRML",label:"NRML",description:"Normal for futures and options"}],ia=[{value:"MARKET",label:"Market",description:"Execute at current market price"},{value:"LIMIT",label:"Limit",description:"Execute at specified price or better"},{value:"SL",label:"Stop Loss Limit",description:"Stop loss with limit price"},{value:"SL-M",label:"Stop Loss Market",description:"Stop loss at market price"}],le=[{value:"BUY",label:"BUY",color:"badge-buy"},{value:"SELL",label:"SELL",color:"badge-sell"}],ca=[{value:"CE",label:"Call (CE)",description:"Call Option"},{value:"PE",label:"Put (PE)",description:"Put Option"}],oa=[{value:"ATM",label:"ATM",description:"At The Money"},{value:"ITM1",label:"ITM1",description:"1 strike In The Money"},{value:"ITM2",label:"ITM2",description:"2 strikes In The Money"},{value:"ITM3",label:"ITM3",description:"3 strikes In The Money"},{value:"ITM4",label:"ITM4",description:"4 strikes In The Money"},{value:"ITM5",label:"ITM5",description:"5 strikes In The Money"},{value:"OTM1",label:"OTM1",description:"1 strike Out of The Money"},{value:"OTM2",label:"OTM2",description:"2 strikes Out of The Money"},{value:"OTM3",label:"OTM3",description:"3 strikes Out of The Money"},{value:"OTM4",label:"OTM4",description:"4 strikes Out of The Money"},{value:"OTM5",label:"OTM5",description:"5 strikes Out of The Money"},{value:"OTM6",label:"OTM6",description:"6 strikes Out of The Money"},{value:"OTM7",label:"OTM7",description:"7 strikes Out of The Money"},{value:"OTM8",label:"OTM8",description:"8 strikes Out of The Money"},{value:"OTM9",label:"OTM9",description:"9 strikes Out of The Money"},{value:"OTM10",label:"OTM10",description:"10 strikes Out of The Money"}],da=[{value:"iron_condor",label:"Iron Condor",description:"Sell OTM Call & Put, Buy further OTM Call & Put"},{value:"straddle",label:"Straddle",description:"Buy/Sell ATM Call and Put"},{value:"strangle",label:"Strangle",description:"Buy/Sell OTM Call and Put"},{value:"bull_call_spread",label:"Bull Call Spread",description:"Buy lower strike Call, Sell higher strike Call"},{value:"bear_put_spread",label:"Bear Put Spread",description:"Buy higher strike Put, Sell lower strike Put"},{value:"custom",label:"Custom",description:"Build custom multi-leg strategy"}],de=[{value:"NIFTY",label:"NIFTY",exchange:"NFO",lotSize:75},{value:"BANKNIFTY",label:"BANKNIFTY",exchange:"NFO",lotSize:30},{value:"FINNIFTY",label:"FINNIFTY",exchange:"NFO",lotSize:40},{value:"MIDCPNIFTY",label:"MIDCPNIFTY",exchange:"NFO",lotSize:75},{value:"NIFTYNXT50",label:"NIFTYNXT50",exchange:"NFO",lotSize:25},{value:"SENSEX",label:"SENSEX",exchange:"BFO",lotSize:20},{value:"BANKEX",label:"BANKEX",exchange:"BFO",lotSize:30},{value:"SENSEX50",label:"SENSEX50",exchange:"BFO",lotSize:25}],Pe=[{value:"current_week",label:"Current Week",description:"Nearest weekly expiry"},{value:"next_week",label:"Next Week",description:"Second weekly expiry"},{value:"current_month",label:"Current Month",description:"Last expiry of current month"},{value:"next_month",label:"Next Month",description:"Last expiry of next month"}],xa=[{value:"once",label:"Once",description:"Execute one time at specified date/time"},{value:"daily",label:"Daily",description:"Execute every day at specified time"},{value:"weekly",label:"Weekly",description:"Execute on selected days of the week"},{value:"interval",label:"Interval",description:"Execute every X minutes"}],ua=[{value:0,label:"Mon",fullLabel:"Monday"},{value:1,label:"Tue",fullLabel:"Tuesday"},{value:2,label:"Wed",fullLabel:"Wednesday"},{value:3,label:"Thu",fullLabel:"Thursday"},{value:4,label:"Fri",fullLabel:"Friday"},{value:5,label:"Sat",fullLabel:"Saturday"},{value:6,label:"Sun",fullLabel:"Sunday"}],Ge={TRIGGERS:[{type:"start",label:"Schedule",description:"Start workflow on schedule",category:"trigger"},{type:"priceAlert",label:"Price Alert",description:"Trigger on price condition",category:"trigger"},{type:"webhookTrigger",label:"Webhook",description:"Trigger from external webhook",category:"trigger"}],ACTIONS:[{type:"placeOrder",label:"Place Order",description:"Place a trading order",category:"action"},{type:"smartOrder",label:"Smart Order",description:"Position-aware order",category:"action"},{type:"optionsOrder",label:"Options Order",description:"Trade ATM/ITM/OTM options",category:"action"},{type:"optionsMultiOrder",label:"Options Strategy",description:"Multi-leg options strategy",category:"action"},{type:"basketOrder",label:"Basket Order",description:"Place multiple orders at once",category:"action"},{type:"splitOrder",label:"Split Order",description:"Split large order into chunks",category:"action"},{type:"modifyOrder",label:"Modify Order",description:"Modify an existing order",category:"action"},{type:"cancelOrder",label:"Cancel Order",description:"Cancel a specific order",category:"action"},{type:"cancelAllOrders",label:"Cancel All",description:"Cancel all open orders",category:"action"},{type:"closePositions",label:"Close Positions",description:"Square off all positions",category:"action"}],CONDITIONS:[{type:"positionCheck",label:"Position Check",description:"Check position status",category:"condition"},{type:"fundCheck",label:"Fund Check",description:"Check available funds",category:"condition"},{type:"priceCondition",label:"Price Check",description:"Check price condition",category:"condition"},{type:"timeWindow",label:"Time Window",description:"Check market hours",category:"condition"},{type:"timeCondition",label:"Time Condition",description:"Check time condition",category:"condition"},{type:"andGate",label:"AND Gate",description:"All conditions must be true",category:"condition"},{type:"orGate",label:"OR Gate",description:"Any condition must be true",category:"condition"},{type:"notGate",label:"NOT Gate",description:"Invert condition result",category:"condition"}],DATA:[{type:"getQuote",label:"Get Quote",description:"Fetch real-time quote",category:"data"},{type:"getDepth",label:"Market Depth",description:"Fetch bid/ask depth",category:"data"},{type:"history",label:"History",description:"Fetch OHLCV data",category:"data"},{type:"openPosition",label:"Open Position",description:"Get position for symbol",category:"data"},{type:"orderBook",label:"Order Book",description:"Get all orders",category:"data"},{type:"tradeBook",label:"Trade Book",description:"Get all trades",category:"data"},{type:"positionBook",label:"Position Book",description:"Get all positions",category:"data"},{type:"holdings",label:"Holdings",description:"Get portfolio holdings",category:"data"},{type:"funds",label:"Funds",description:"Get available funds",category:"data"}],UTILITIES:[{type:"telegramAlert",label:"Telegram Alert",description:"Send Telegram notification",category:"utility"},{type:"delay",label:"Delay",description:"Wait for duration",category:"utility"},{type:"waitUntil",label:"Wait Until",description:"Wait until specific time",category:"utility"},{type:"log",label:"Log",description:"Log a message",category:"utility"},{type:"variable",label:"Variable",description:"Set/calculate variable",category:"utility"},{type:"httpRequest",label:"HTTP Request",description:"Make HTTP request",category:"utility"}]},We={start:{scheduleType:"daily",time:"09:15",marketHoursOnly:!0},priceAlert:{symbol:"",exchange:"NSE",condition:"above",price:0},webhookTrigger:{label:"",symbol:"",exchange:"NSE"},placeOrder:{symbol:"",exchange:"NSE",action:"BUY",quantity:1,priceType:"MARKET",product:"MIS"},smartOrder:{symbol:"",exchange:"NSE",action:"BUY",quantity:1,positionSize:0,priceType:"MARKET",product:"MIS"},optionsOrder:{underlying:"NIFTY",exchange:"NSE_INDEX",expiryDate:"",offset:"ATM",optionType:"CE",action:"BUY",quantity:75,priceType:"MARKET",product:"MIS"},optionsMultiOrder:{strategy:"straddle",underlying:"NIFTY",exchange:"NSE_INDEX",expiryDate:"",legs:[],priceType:"MARKET",product:"MIS"},cancelOrder:{orderId:""},cancelAllOrders:{},closePositions:{symbol:"",exchange:"NSE",product:"MIS"},modifyOrder:{orderId:"",symbol:"",exchange:"NSE",action:"BUY"},basketOrder:{orders:"",product:"MIS",priceType:"MARKET"},splitOrder:{symbol:"",exchange:"NSE",action:"BUY",quantity:100,splitSize:50,priceType:"MARKET",product:"MIS"},positionCheck:{symbol:"",exchange:"NSE",product:"MIS",operator:"gt",threshold:0},fundCheck:{operator:"gt",threshold:1e4},priceCondition:{symbol:"",exchange:"NSE",operator:"gt",threshold:0},timeWindow:{startTime:"09:15",endTime:"15:30"},timeCondition:{targetTime:"09:30",operator:">="},andGate:{},orGate:{},notGate:{},getQuote:{symbol:"",exchange:"NSE",outputVariable:""},getDepth:{symbol:"",exchange:"NSE",outputVariable:""},history:{symbol:"",exchange:"NSE",interval:"5m",startDate:"",endDate:"",outputVariable:""},openPosition:{symbol:"",exchange:"NSE",product:"MIS",outputVariable:""},orderBook:{outputVariable:""},tradeBook:{outputVariable:""},positionBook:{outputVariable:""},holdings:{outputVariable:""},funds:{outputVariable:""},telegramAlert:{message:"Workflow executed successfully"},delay:{delayValue:1,delayUnit:"seconds"},waitUntil:{targetTime:"09:30"},log:{message:"Log message here",level:"info"},variable:{variableName:"myVar",operation:"set",value:""},httpRequest:{method:"GET",url:"",headers:{},body:"",timeout:30,outputVariable:""}};function ha(c){for(const b of Object.values(Ge)){const i=b.find(j=>j.type===c);if(i)return i}return null}function pa(c){return["start","priceAlert","webhookTrigger"].includes(c)?"border-orange-500/50 bg-orange-500/5":["placeOrder","smartOrder","optionsOrder","optionsMultiOrder","basketOrder","splitOrder","modifyOrder"].includes(c)?"border-blue-500/50 bg-blue-500/5":["cancelOrder","cancelAllOrders","closePositions"].includes(c)?"border-red-500/50 bg-red-500/5":["timeCondition","positionCheck","fundCheck","priceCondition","timeWindow","andGate","orGate","notGate"].includes(c)?"border-purple-500/50 bg-purple-500/5":["getQuote","getDepth","history","multiQuotes"].includes(c)?"border-cyan-500/50 bg-cyan-500/5":["optionSymbol","optionChain","syntheticFuture","expiry"].includes(c)?"border-pink-500/50 bg-pink-500/5":["subscribeLtp","subscribeQuote","subscribeDepth","unsubscribe"].includes(c)?"border-green-500/50 bg-green-500/5":"border-border bg-card"}function ma({id:c,type:b,data:i,selected:j}){const v=ha(b||""),y=i,{selectedNodeId:T}=Ce(),m=j||T===c,E=pa(b||""),P=y.label||v?.label||b;return e.jsxs("div",{className:S("min-w-[140px] rounded-lg border-2 px-3 py-2 shadow-sm transition-all",E,m&&"ring-2 ring-primary ring-offset-2 ring-offset-background"),children:[e.jsx(Se,{type:"target",position:Te.Top,className:"!bg-primary !border-background !w-3 !h-3"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs font-medium truncate",children:P}),v&&e.jsx("div",{className:"text-[10px] text-muted-foreground truncate mt-0.5",children:v.description})]}),e.jsx(Se,{type:"source",position:Te.Bottom,className:"!bg-primary !border-background !w-3 !h-3"})]})}const p=N.memo(ma),ga={start:p,priceAlert:p,webhookTrigger:p,httpRequest:p,placeOrder:p,smartOrder:p,optionsOrder:p,optionsMultiOrder:p,basketOrder:p,splitOrder:p,modifyOrder:p,cancelOrder:p,cancelAllOrders:p,closePositions:p,timeCondition:p,positionCheck:p,fundCheck:p,priceCondition:p,timeWindow:p,andGate:p,orGate:p,notGate:p,getQuote:p,getDepth:p,history:p,multiQuotes:p,symbol:p,expiry:p,optionSymbol:p,optionChain:p,syntheticFuture:p,optionGreeks:p,getOrderStatus:p,openPosition:p,orderBook:p,tradeBook:p,positionBook:p,subscribeLtp:p,subscribeQuote:p,subscribeDepth:p,unsubscribe:p,holdings:p,funds:p,margin:p,holidays:p,timings:p,variable:p,mathExpression:p,log:p,telegramAlert:p,delay:p,waitUntil:p,group:p},ja={Actions:[{type:"placeOrder",label:"Place Order"},{type:"smartOrder",label:"Smart Order"},{type:"optionsOrder",label:"Options Order"},{type:"optionsMultiOrder",label:"Multi-Leg Options"},{type:"closePositions",label:"Close Positions"},{type:"cancelAllOrders",label:"Cancel All"}],Logic:[{type:"timeCondition",label:"Time Condition"},{type:"positionCheck",label:"Position Check"},{type:"fundCheck",label:"Fund Check"},{type:"priceCondition",label:"Price Check"},{type:"timeWindow",label:"Time Window"}],Data:[{type:"getQuote",label:"Get Quote"},{type:"getDepth",label:"Get Depth"},{type:"openPosition",label:"Open Position"}],Utility:[{type:"waitUntil",label:"Wait Until"},{type:"delay",label:"Delay"},{type:"telegramAlert",label:"Telegram Alert"},{type:"log",label:"Log"},{type:"variable",label:"Variable"}]};let ba=1e3;function va({id:c,source:b,target:i,sourceX:j,sourceY:v,targetX:y,targetY:T,sourcePosition:m,targetPosition:E,sourceHandleId:P,targetHandleId:O,markerEnd:l,selected:G,animated:X}){const[_,F]=N.useState(!1),[a,o]=N.useState(!1),{setNodes:W,setEdges:s,getNodes:C,getEdges:k}=Fe(),[q,J,Z]=$e({sourceX:j,sourceY:v,sourcePosition:m,targetX:y,targetY:T,targetPosition:E}),he=N.useCallback(B=>{const Y=C(),R=k(),ee=`node_${Date.now()}_${ba++}`,I=Y.find(Q=>Q.id===b),A=Y.find(Q=>Q.id===i);if(!I||!A)return;const se=(I.position.x+A.position.x)/2,ae=(I.position.y+A.position.y)/2+50,ie=We[B]||{},pe={id:ee,type:B,position:{x:se,y:ae},data:{...ie}},me=R.filter(Q=>Q.id!==c),ge={id:`edge-${Date.now()}-1`,source:b,target:ee,sourceHandle:P||void 0,type:"insertable",animated:!0},je={id:`edge-${Date.now()}-2`,source:ee,target:i,targetHandle:O||void 0,type:"insertable",animated:!0};W([...Y,pe]),s([...me,ge,je]),o(!1)},[b,i,P,O,c,C,k,W,s]);return e.jsxs(e.Fragment,{children:[e.jsx("path",{d:q,fill:"none",strokeWidth:_||G?3:2,stroke:_||G?"#3b82f6":"#888888",strokeDasharray:X?"5 5":void 0,style:{animation:X?"dashdraw 0.5s linear infinite":void 0},className:"react-flow__edge-path",markerEnd:l}),e.jsx(Je,{children:e.jsx("div",{className:"nodrag nopan pointer-events-auto absolute",style:{transform:`translate(-50%, -50%) translate(${J}px, ${Z}px)`},onMouseEnter:()=>F(!0),onMouseLeave:()=>!a&&F(!1),children:e.jsxs(Le,{open:a,onOpenChange:o,children:[e.jsx(Be,{asChild:!0,children:e.jsx("button",{className:S("flex h-5 w-5 items-center justify-center rounded-full border bg-background shadow-sm transition-all","hover:scale-110 hover:border-primary hover:bg-primary hover:text-primary-foreground",_||a?"opacity-100 scale-100":"opacity-0 scale-75",G&&"opacity-100 scale-100"),children:e.jsx(js,{className:"h-3 w-3"})})}),e.jsx(Re,{align:"center",className:"w-48",children:Object.entries(ja).map(([B,Y])=>e.jsxs(hs,{children:[e.jsx(ps,{children:e.jsx("span",{children:B})}),e.jsx(ms,{children:Y.map(R=>e.jsx(xe,{onClick:()=>he(R.type),children:R.label},R.type))})]},B))})]})})})]})}const Na={insertable:va};function $({type:c,label:b,description:i,icon:j,color:v,onDragStart:y}){return e.jsx("div",{draggable:!0,onDragStart:T=>y(T,c),className:S("group cursor-grab rounded-lg border border-border bg-card p-2.5 transition-all duration-200","hover:border-primary/50 hover:shadow-md active:cursor-grabbing"),children:e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:S("flex h-7 w-7 items-center justify-center rounded-md",v),children:j}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"truncate text-xs font-medium",children:b}),e.jsx("div",{className:"truncate text-[10px] text-muted-foreground",children:i})]})]})})}function ya({onDragStart:c}){const b=[{type:"start",label:"Schedule",description:"Start on schedule",icon:e.jsx(re,{className:"h-3.5 w-3.5 text-orange-500"}),color:"bg-orange-500/10"},{type:"priceAlert",label:"Price Alert",description:"Trigger on price",icon:e.jsx(bs,{className:"h-3.5 w-3.5 text-orange-500"}),color:"bg-orange-500/10"},{type:"webhookTrigger",label:"Webhook",description:"External trigger",icon:e.jsx(vs,{className:"h-3.5 w-3.5 text-orange-500"}),color:"bg-orange-500/10"}],i=[{type:"placeOrder",label:"Place Order",description:"Basic order",icon:e.jsx(Ns,{className:"h-3.5 w-3.5 text-blue-500"}),color:"bg-blue-500/10"},{type:"smartOrder",label:"Smart Order",description:"Position-aware",icon:e.jsx(ys,{className:"h-3.5 w-3.5 text-blue-500"}),color:"bg-blue-500/10"},{type:"optionsOrder",label:"Options Order",description:"ATM/ITM/OTM",icon:e.jsx(be,{className:"h-3.5 w-3.5 text-blue-500"}),color:"bg-blue-500/10"},{type:"optionsMultiOrder",label:"Multi-Leg",description:"Options strategies",icon:e.jsx(ve,{className:"h-3.5 w-3.5 text-blue-500"}),color:"bg-blue-500/10"},{type:"basketOrder",label:"Basket Order",description:"Multiple orders",icon:e.jsx(fs,{className:"h-3.5 w-3.5 text-blue-500"}),color:"bg-blue-500/10"},{type:"splitOrder",label:"Split Order",description:"Large order split",icon:e.jsx(Cs,{className:"h-3.5 w-3.5 text-blue-500"}),color:"bg-blue-500/10"},{type:"modifyOrder",label:"Modify Order",description:"Edit order",icon:e.jsx(Ss,{className:"h-3.5 w-3.5 text-blue-500"}),color:"bg-blue-500/10"},{type:"cancelOrder",label:"Cancel Order",description:"Cancel by ID",icon:e.jsx(ue,{className:"h-3.5 w-3.5 text-red-500"}),color:"bg-red-500/10"},{type:"cancelAllOrders",label:"Cancel All",description:"Cancel orders",icon:e.jsx(ue,{className:"h-3.5 w-3.5 text-red-500"}),color:"bg-red-500/10"},{type:"closePositions",label:"Close Positions",description:"Square off all",icon:e.jsx(Ts,{className:"h-3.5 w-3.5 text-red-500"}),color:"bg-red-500/10"}],j=[{type:"timeCondition",label:"Time Condition",description:"Entry/Exit time",icon:e.jsx(re,{className:"h-3.5 w-3.5 text-purple-500"}),color:"bg-purple-500/10"},{type:"positionCheck",label:"Position Check",description:"Check position",icon:e.jsx(oe,{className:"h-3.5 w-3.5 text-purple-500"}),color:"bg-purple-500/10"},{type:"fundCheck",label:"Fund Check",description:"Check funds",icon:e.jsx(Oe,{className:"h-3.5 w-3.5 text-purple-500"}),color:"bg-purple-500/10"},{type:"priceCondition",label:"Price Check",description:"Check price",icon:e.jsx(be,{className:"h-3.5 w-3.5 text-purple-500"}),color:"bg-purple-500/10"},{type:"timeWindow",label:"Time Window",description:"Market hours",icon:e.jsx(re,{className:"h-3.5 w-3.5 text-purple-500"}),color:"bg-purple-500/10"},{type:"andGate",label:"AND Gate",description:"All must be true",icon:e.jsx("span",{className:"text-[9px] font-bold text-purple-500",children:"AND"}),color:"bg-purple-500/10"},{type:"orGate",label:"OR Gate",description:"Any can be true",icon:e.jsx("span",{className:"text-[9px] font-bold text-purple-500",children:"OR"}),color:"bg-purple-500/10"},{type:"notGate",label:"NOT Gate",description:"Invert condition",icon:e.jsx("span",{className:"text-[9px] font-bold text-purple-500",children:"NOT"}),color:"bg-purple-500/10"}],v=[{type:"getQuote",label:"Get Quote",description:"Real-time quote",icon:e.jsx(Ee,{className:"h-3.5 w-3.5 text-cyan-500"}),color:"bg-cyan-500/10"},{type:"getDepth",label:"Get Depth",description:"Bid/ask depth",icon:e.jsx(ve,{className:"h-3.5 w-3.5 text-cyan-500"}),color:"bg-cyan-500/10"},{type:"getOrderStatus",label:"Order Status",description:"Check order",icon:e.jsx(Es,{className:"h-3.5 w-3.5 text-orange-500"}),color:"bg-orange-500/10"},{type:"history",label:"History",description:"OHLCV data",icon:e.jsx(be,{className:"h-3.5 w-3.5 text-cyan-500"}),color:"bg-cyan-500/10"},{type:"openPosition",label:"Open Position",description:"Get position",icon:e.jsx(oe,{className:"h-3.5 w-3.5 text-violet-500"}),color:"bg-violet-500/10"},{type:"expiry",label:"Expiry Dates",description:"F&O expiry",icon:e.jsx(Os,{className:"h-3.5 w-3.5 text-pink-500"}),color:"bg-pink-500/10"},{type:"multiQuotes",label:"Multi Quotes",description:"Multiple symbols",icon:e.jsx(Ee,{className:"h-3.5 w-3.5 text-cyan-500"}),color:"bg-cyan-500/10"},{type:"symbol",label:"Symbol Info",description:"Get symbol details",icon:e.jsx(ws,{className:"h-3.5 w-3.5 text-teal-500"}),color:"bg-teal-500/10"},{type:"optionSymbol",label:"Option Symbol",description:"Resolve options",icon:e.jsx(ks,{className:"h-3.5 w-3.5 text-pink-500"}),color:"bg-pink-500/10"},{type:"orderBook",label:"Order Book",description:"All orders",icon:e.jsx(Is,{className:"h-3.5 w-3.5 text-orange-500"}),color:"bg-orange-500/10"},{type:"tradeBook",label:"Trade Book",description:"Executed trades",icon:e.jsx(Ms,{className:"h-3.5 w-3.5 text-orange-500"}),color:"bg-orange-500/10"},{type:"positionBook",label:"Position Book",description:"All positions",icon:e.jsx(oe,{className:"h-3.5 w-3.5 text-violet-500"}),color:"bg-violet-500/10"},{type:"syntheticFuture",label:"Synthetic Future",description:"Calc future price",icon:e.jsx(Vs,{className:"h-3.5 w-3.5 text-pink-500"}),color:"bg-pink-500/10"},{type:"optionChain",label:"Option Chain",description:"Full chain data",icon:e.jsx(Ps,{className:"h-3.5 w-3.5 text-pink-500"}),color:"bg-pink-500/10"},{type:"holdings",label:"Holdings",description:"Portfolio holdings",icon:e.jsx(oe,{className:"h-3.5 w-3.5 text-amber-500"}),color:"bg-amber-500/10"},{type:"funds",label:"Funds",description:"Account balance",icon:e.jsx(Oe,{className:"h-3.5 w-3.5 text-amber-500"}),color:"bg-amber-500/10"},{type:"margin",label:"Margin Calc",description:"Margin required",icon:e.jsx(Ds,{className:"h-3.5 w-3.5 text-amber-500"}),color:"bg-amber-500/10"}],y=[{type:"subscribeLtp",label:"Subscribe LTP",description:"Live price stream",icon:e.jsx(Fs,{className:"h-3.5 w-3.5 text-green-500"}),color:"bg-green-500/10"},{type:"subscribeQuote",label:"Subscribe Quote",description:"Live OHLC stream",icon:e.jsx(As,{className:"h-3.5 w-3.5 text-green-500"}),color:"bg-green-500/10"},{type:"subscribeDepth",label:"Subscribe Depth",description:"Live order book",icon:e.jsx(ve,{className:"h-3.5 w-3.5 text-green-500"}),color:"bg-green-500/10"},{type:"unsubscribe",label:"Unsubscribe",description:"Stop streaming",icon:e.jsx(Ls,{className:"h-3.5 w-3.5 text-red-500"}),color:"bg-red-500/10"}],T=[{type:"variable",label:"Variable",description:"Store values",icon:e.jsx(Bs,{className:"h-3.5 w-3.5 text-purple-400"}),color:"bg-purple-400/10"},{type:"mathExpression",label:"Math",description:"Calculate expression",icon:e.jsx(Rs,{className:"h-3.5 w-3.5 text-purple-500"}),color:"bg-purple-500/10"},{type:"log",label:"Log",description:"Debug message",icon:e.jsx(_s,{className:"h-3.5 w-3.5 text-blue-400"}),color:"bg-blue-400/10"},{type:"telegramAlert",label:"Telegram",description:"Send alert",icon:e.jsx(Us,{className:"h-3.5 w-3.5 text-[#0088cc]"}),color:"bg-[#0088cc]/10"},{type:"delay",label:"Delay",description:"Wait duration",icon:e.jsx(Gs,{className:"h-3.5 w-3.5 text-muted-foreground"}),color:"bg-muted"},{type:"waitUntil",label:"Wait Until",description:"Wait until time",icon:e.jsx(Ws,{className:"h-3.5 w-3.5 text-amber-500"}),color:"bg-amber-500/10"},{type:"group",label:"Group",description:"Group nodes",icon:e.jsx(qs,{className:"h-3.5 w-3.5 text-muted-foreground"}),color:"bg-muted"},{type:"httpRequest",label:"HTTP Request",description:"API call",icon:e.jsx(Ys,{className:"h-3.5 w-3.5 text-primary"}),color:"bg-primary/10"},{type:"holidays",label:"Holidays",description:"Market holidays",icon:e.jsx(Qs,{className:"h-3.5 w-3.5 text-purple-400"}),color:"bg-purple-400/10"},{type:"timings",label:"Timings",description:"Market hours",icon:e.jsx(re,{className:"h-3.5 w-3.5 text-purple-400"}),color:"bg-purple-400/10"}];return e.jsxs("div",{className:"flex h-full flex-col border-r border-border bg-card",children:[e.jsxs("div",{className:"border-b border-border p-3",children:[e.jsx("h2",{className:"text-sm font-semibold",children:"Nodes"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Drag nodes to the canvas"})]}),e.jsxs(ta,{defaultValue:"triggers",className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"border-b border-border px-1 py-1.5",children:e.jsxs(ra,{className:"h-7 w-full",children:[e.jsx(H,{value:"triggers",className:"flex-1 text-[8px] px-0.5",children:"Trigger"}),e.jsx(H,{value:"actions",className:"flex-1 text-[8px] px-0.5",children:"Action"}),e.jsx(H,{value:"data",className:"flex-1 text-[8px] px-0.5",children:"Data"}),e.jsx(H,{value:"stream",className:"flex-1 text-[8px] px-0.5",children:"Stream"}),e.jsx(H,{value:"conditions",className:"flex-1 text-[8px] px-0.5",children:"Logic"}),e.jsx(H,{value:"utilities",className:"flex-1 text-[8px] px-0.5",children:"Util"})]})}),e.jsxs(fe,{className:"flex-1",children:[e.jsx(z,{value:"triggers",className:"m-0 p-2",children:e.jsx("div",{className:"space-y-1.5",children:b.map(m=>e.jsx($,{...m,onDragStart:c},m.type))})}),e.jsx(z,{value:"actions",className:"m-0 p-2",children:e.jsx("div",{className:"space-y-1.5",children:i.map(m=>e.jsx($,{...m,onDragStart:c},m.type))})}),e.jsx(z,{value:"data",className:"m-0 p-2",children:e.jsx("div",{className:"space-y-1.5",children:v.map(m=>e.jsx($,{...m,onDragStart:c},m.type))})}),e.jsx(z,{value:"stream",className:"m-0 p-2",children:e.jsx("div",{className:"space-y-1.5",children:y.map(m=>e.jsx($,{...m,onDragStart:c},m.type))})}),e.jsx(z,{value:"conditions",className:"m-0 p-2",children:e.jsx("div",{className:"space-y-1.5",children:j.map(m=>e.jsx($,{...m,onDragStart:c},m.type))})}),e.jsx(z,{value:"utilities",className:"m-0 p-2",children:e.jsx("div",{className:"space-y-1.5",children:T.map(m=>e.jsx($,{...m,onDragStart:c},m.type))})})]})]})]})}const fa=[{value:"above",label:"Greater Than"},{value:"below",label:"Less Than"},{value:"crosses_above",label:"Crosses Above"},{value:"crosses_below",label:"Crosses Below"}],Ca=[{value:"once",label:"Only Once"},{value:"every_time",label:"Every Time"}],Sa=[{value:"none",label:"No Expiration"},{value:"1h",label:"1 Hour"},{value:"4h",label:"4 Hours"},{value:"1d",label:"1 Day"},{value:"1w",label:"1 Week"}],Ta=[{value:"set",label:"Set Value",description:"Set variable to a value"},{value:"get",label:"Get Value",description:"Copy from another variable"},{value:"add",label:"Add",description:"Add to variable"},{value:"subtract",label:"Subtract",description:"Subtract from variable"},{value:"multiply",label:"Multiply",description:"Multiply variable"},{value:"divide",label:"Divide",description:"Divide variable"},{value:"increment",label:"Increment",description:"Add 1 to variable"},{value:"decrement",label:"Decrement",description:"Subtract 1 from variable"},{value:"parse_json",label:"Parse JSON",description:"Parse JSON string to object"},{value:"stringify",label:"Stringify",description:"Convert to JSON string"},{value:"append",label:"Append",description:"Append to string"}],Ea=[{value:"info",label:"Info",color:"text-blue-400"},{value:"warn",label:"Warning",color:"text-yellow-400"},{value:"error",label:"Error",color:"text-red-400"}],Oa=[{value:"==",label:"Equals (=)",description:"Exactly at this time"},{value:">=",label:"At or After (>=)",description:"Time has passed"},{value:"<=",label:"At or Before (<=)",description:"Before this time"},{value:">",label:"After (>)",description:"Strictly after"},{value:"<",label:"Before (<)",description:"Strictly before"}],wa=[{value:"entry",label:"Entry"},{value:"exit",label:"Exit"},{value:"custom",label:"Custom"}],ka=[{value:"GET",label:"GET"},{value:"POST",label:"POST"},{value:"PUT",label:"PUT"},{value:"DELETE",label:"DEL"},{value:"PATCH",label:"PATCH"}],De={start:"Schedule Trigger",priceAlert:"Price Alert",webhookTrigger:"Webhook Trigger",placeOrder:"Place Order",smartOrder:"Smart Order",optionsOrder:"Options Order",optionsMultiOrder:"Multi-Leg Options",basketOrder:"Basket Order",splitOrder:"Split Order",cancelOrder:"Cancel Order",cancelAllOrders:"Cancel All Orders",closePositions:"Close Positions",modifyOrder:"Modify Order",getQuote:"Get Quote",getDepth:"Get Depth",openPosition:"Open Position",history:"History Data",expiry:"Get Expiry",multiQuotes:"Multi Quotes",symbol:"Symbol Info",optionSymbol:"Option Symbol",orderBook:"Order Book",tradeBook:"Trade Book",positionBook:"Position Book",syntheticFuture:"Synthetic Future",optionChain:"Option Chain",holidays:"Holidays",timings:"Market Timings",holdings:"Holdings",funds:"Funds",margin:"Margin Calculator",delay:"Delay",waitUntil:"Wait Until",log:"Log",telegramAlert:"Telegram Alert",variable:"Variable",mathExpression:"Math Expression",httpRequest:"HTTP Request",timeWindow:"Time Window",timeCondition:"Time Condition",priceCondition:"Price Condition",positionCheck:"Position Check",fundCheck:"Fund Check",andGate:"AND Gate",orGate:"OR Gate",notGate:"NOT Gate",group:"Group",subscribeLtp:"Subscribe LTP",subscribeQuote:"Subscribe Quote",subscribeDepth:"Subscribe Depth",unsubscribe:"Unsubscribe"};function Ia(c){for(const b of Object.values(Ge)){const i=b.find(j=>j.type===c);if(i)return i}return null}function Ma(){const{id:c}=Ue(),{nodes:b,selectedNodeId:i,updateNodeData:j,deleteNode:v,selectNode:y}=Ce(),[T,m]=N.useState(!1),E=b.find(s=>s.id===i),P=E?.type==="webhookTrigger",O=Ae({queryKey:te.webhook(Number(c)),queryFn:()=>rs(Number(c)),enabled:P&&!!c}),l=N.useCallback((s,C)=>{i&&j(i,{[s]:C})},[i,j]),G=N.useCallback(()=>{i&&v(i)},[i,v]),X=N.useCallback(()=>{y(null)},[y]),_=(s,C)=>{navigator.clipboard.writeText(s),V.success(`${C} copied`)};if(!E)return e.jsxs("div",{className:"w-80 border-l border-border bg-card flex flex-col h-full",children:[e.jsx("div",{className:"flex items-center justify-between border-b border-border px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:"Properties"})]})}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center text-muted-foreground",children:[e.jsx(we,{className:"h-12 w-12 mx-auto mb-3 opacity-30"}),e.jsx("p",{className:"text-sm",children:"Select a node to configure"})]})})]});const F=Ia(E.type||""),a=E.data,o=E.type||"unknown",W=De[o]||F?.label||o;return e.jsxs("div",{className:"w-80 border-l border-border bg-card flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-border px-4 py-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-sm",children:W}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Configure node"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(D,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive hover:text-destructive",onClick:G,children:e.jsx(Xs,{className:"h-4 w-4"})}),e.jsx(D,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:X,children:e.jsx(_e,{className:"h-4 w-4"})})]})]}),e.jsx(fe,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 p-4",children:[o==="start"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Schedule Type"}),e.jsxs(d,{value:a.scheduleType||"daily",onValueChange:s=>l("scheduleType",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:xa.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),a.scheduleType!=="interval"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Time"}),e.jsx(n,{type:"time",className:"h-8",value:a.time||"09:15",onChange:s=>l("time",s.target.value)})]}),a.scheduleType==="interval"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Repeat Every"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{type:"number",min:"1",className:"h-8 w-20",value:a.intervalValue||1,onChange:s=>l("intervalValue",parseInt(s.target.value)||1)}),e.jsxs(d,{value:a.intervalUnit||"minutes",onValueChange:s=>l("intervalUnit",s),children:[e.jsx(x,{className:"h-8 flex-1",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"seconds",children:"Seconds"}),e.jsx(r,{value:"minutes",children:"Minutes"}),e.jsx(r,{value:"hours",children:"Hours"})]})]})]})]}),(a.scheduleType==="daily"||a.scheduleType==="weekly")&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Run On Days"}),e.jsxs("div",{className:"flex flex-wrap gap-1 mb-2",children:[e.jsx("button",{type:"button",onClick:()=>l("days",[1,2,3,4,5]),className:"rounded-md bg-muted px-2 py-1 text-[10px] hover:bg-accent",children:"Weekdays"}),e.jsx("button",{type:"button",onClick:()=>l("days",[0,6]),className:"rounded-md bg-muted px-2 py-1 text-[10px] hover:bg-accent",children:"Weekends"}),e.jsx("button",{type:"button",onClick:()=>l("days",[0,1,2,3,4,5,6]),className:"rounded-md bg-muted px-2 py-1 text-[10px] hover:bg-accent",children:"All"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:ua.map(s=>{const C=a.days||[1,2,3,4,5],k=C.includes(s.value);return e.jsx("button",{type:"button",onClick:()=>l("days",k?C.filter(q=>q!==s.value):[...C,s.value].sort()),className:S("flex h-8 w-8 items-center justify-center rounded-md text-xs font-medium",k?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-accent"),children:s.label},s.value)})})]}),a.scheduleType==="once"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Date"}),e.jsx(n,{type:"date",className:"h-8",value:a.executeAt||"",onChange:s=>l("executeAt",s.target.value)})]})]}),o==="priceAlert"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"RELIANCE",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Condition"}),e.jsxs(d,{value:a.condition||"above",onValueChange:s=>l("condition",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:fa.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Target Price"}),e.jsx(n,{type:"number",step:"0.05",className:"h-8",value:a.price||"",onChange:s=>l("price",parseFloat(s.target.value)||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Trigger"}),e.jsxs(d,{value:a.trigger||"once",onValueChange:s=>l("trigger",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:Ca.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Expiration"}),e.jsxs(d,{value:a.expiration||"none",onValueChange:s=>l("expiration",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:Sa.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsx("div",{children:e.jsx(t,{className:"text-xs",children:"Play Sound"})}),e.jsx(Me,{checked:a.playSound??!0,onCheckedChange:s=>l("playSound",s)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Alert Message"}),e.jsx(n,{className:"h-8",placeholder:"Custom message",value:a.message||"",onChange:s=>l("message",s.target.value)})]})]}),o==="webhookTrigger"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Label"}),e.jsx(n,{className:"h-8",placeholder:"TradingView Alert",value:a.label||"",onChange:s=>l("label",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"RELIANCE",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"NSE",children:"NSE"}),e.jsx(r,{value:"BSE",children:"BSE"}),e.jsx(r,{value:"NFO",children:"NFO"}),e.jsx(r,{value:"CDS",children:"CDS"}),e.jsx(r,{value:"MCX",children:"MCX"})]})]})]}),e.jsx(Ne,{}),O.isLoading?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(ne,{className:"h-5 w-5 animate-spin"})}):O.data?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Webhook URL"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(n,{readOnly:!0,value:a.symbol?`${O.data.webhook_url}/${a.symbol}`:O.data.webhook_url,className:"font-mono text-[10px] h-8"}),e.jsx(D,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>_(a.symbol?`${O.data.webhook_url}/${a.symbol}`:O.data.webhook_url,"URL"),children:e.jsx(ke,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Webhook Secret"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(n,{readOnly:!0,type:T?"text":"password",value:O.data.webhook_secret,className:"font-mono text-[10px] h-8 pr-8"}),e.jsx(D,{variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-8 w-8",onClick:()=>m(!T),children:T?e.jsx(Hs,{className:"h-3 w-3"}):e.jsx(zs,{className:"h-3 w-3"})})]}),e.jsx(D,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>_(O.data.webhook_secret,"Secret"),children:e.jsx(ke,{className:"h-3 w-3"})})]})]}),e.jsx("div",{className:S("rounded-lg border p-2 text-center text-xs",O.data.webhook_enabled?"border-green-500/30 bg-green-500/10 text-green-600":"border-yellow-500/30 bg-yellow-500/10 text-yellow-600"),children:O.data.webhook_enabled?"Webhook enabled":"Webhook disabled"})]}):e.jsx("div",{className:"rounded-lg border-yellow-500/30 bg-yellow-500/10 p-3 text-center text-xs text-yellow-600",children:"Save workflow first"})]}),o==="placeOrder"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"RELIANCE",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Action"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:le.map(s=>e.jsx("button",{type:"button",onClick:()=>l("action",s.value),className:S("rounded-lg border py-2 text-sm font-semibold",a.action===s.value?s.value==="BUY"?"bg-green-500/20 border-green-500 text-green-600":"bg-red-500/20 border-red-500 text-red-600":"border-border bg-muted"),children:s.label},s.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Quantity"}),e.jsx(n,{type:"number",min:1,className:"h-8",value:a.quantity||1,onChange:s=>l("quantity",parseInt(s.target.value)||1)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Product"}),e.jsxs(d,{value:a.product||"MIS",onValueChange:s=>l("product",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:K.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Price Type"}),e.jsxs(d,{value:a.priceType||"MARKET",onValueChange:s=>l("priceType",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:ia.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),(a.priceType==="LIMIT"||a.priceType==="SL")&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Price"}),e.jsx(n,{type:"number",step:"0.05",className:"h-8",value:a.price||0,onChange:s=>l("price",parseFloat(s.target.value)||0)})]}),(a.priceType==="SL"||a.priceType==="SL-M")&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Trigger Price"}),e.jsx(n,{type:"number",step:"0.05",className:"h-8",value:a.triggerPrice||0,onChange:s=>l("triggerPrice",parseFloat(s.target.value)||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"orderResult",value:a.outputVariable||"",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{orderResult.orderid}}"]})]})]}),o==="smartOrder"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"RELIANCE",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Action"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:le.map(s=>e.jsx("button",{type:"button",onClick:()=>l("action",s.value),className:S("rounded-lg border py-2 text-sm font-semibold",a.action===s.value?s.value==="BUY"?"bg-green-500/20 border-green-500 text-green-600":"bg-red-500/20 border-red-500 text-red-600":"border-border bg-muted"),children:s.label},s.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Quantity"}),e.jsx(n,{type:"number",min:1,className:"h-8",value:a.quantity||1,onChange:s=>l("quantity",parseInt(s.target.value)||1)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Position Size"}),e.jsx(n,{type:"number",min:0,className:"h-8",value:a.positionSize||0,onChange:s=>l("positionSize",parseInt(s.target.value)||0)}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Target position size (0 = use quantity)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Product"}),e.jsxs(d,{value:a.product||"MIS",onValueChange:s=>l("product",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:K.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"smartResult",value:a.outputVariable||"",onChange:s=>l("outputVariable",s.target.value)})]})]}),o==="optionsOrder"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Underlying"}),e.jsxs(d,{value:a.underlying||"NIFTY",onValueChange:s=>{l("underlying",s);const C=de.find(k=>k.value===s);C&&(l("quantity",C.lotSize),l("exchange",C.exchange))},children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:de.map(s=>e.jsxs(r,{value:s.value,children:[s.label," (",s.exchange,", Lot: ",s.lotSize,")"]},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Expiry"}),e.jsxs(d,{value:a.expiryType||"current_week",onValueChange:s=>l("expiryType",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:Pe.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Strike Offset"}),e.jsxs(d,{value:a.offset||"ATM",onValueChange:s=>l("offset",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:oa.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Option Type"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:ca.map(s=>e.jsx("button",{type:"button",onClick:()=>l("optionType",s.value),className:S("rounded-lg border py-2 text-sm font-semibold",a.optionType===s.value?s.value==="CE"?"bg-green-500/20 border-green-500 text-green-600":"bg-red-500/20 border-red-500 text-red-600":"border-border bg-muted"),children:s.label},s.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Action"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:le.map(s=>e.jsx("button",{type:"button",onClick:()=>l("action",s.value),className:S("rounded-lg border py-2 text-sm font-semibold",a.action===s.value?s.value==="BUY"?"bg-green-500/20 border-green-500 text-green-600":"bg-red-500/20 border-red-500 text-red-600":"border-border bg-muted"),children:s.label},s.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Quantity (Lots)"}),e.jsx(n,{type:"number",min:1,className:"h-8",value:a.quantity||75,onChange:s=>l("quantity",parseInt(s.target.value)||1)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Product"}),e.jsxs(d,{value:a.product||"MIS",onValueChange:s=>l("product",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"MIS",children:"MIS"}),e.jsx(r,{value:"NRML",children:"NRML"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"optionOrder",value:a.outputVariable||"",onChange:s=>l("outputVariable",s.target.value)})]})]}),o==="optionsMultiOrder"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Strategy"}),e.jsxs(d,{value:a.strategy||"straddle",onValueChange:s=>l("strategy",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:da.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Underlying"}),e.jsxs(d,{value:a.underlying||"NIFTY",onValueChange:s=>{l("underlying",s);const C=de.find(k=>k.value===s);C&&l("exchange",C.exchange)},children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:de.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Expiry"}),e.jsxs(d,{value:a.expiryType||"current_week",onValueChange:s=>l("expiryType",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:Pe.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Action"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:le.map(s=>e.jsx("button",{type:"button",onClick:()=>l("action",s.value),className:S("rounded-lg border py-2 text-sm font-semibold",a.action===s.value?s.value==="BUY"?"bg-green-500/20 border-green-500 text-green-600":"bg-red-500/20 border-red-500 text-red-600":"border-border bg-muted"),children:s.label},s.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Quantity (Lots)"}),e.jsx(n,{type:"number",min:1,className:"h-8",value:a.quantity||1,onChange:s=>l("quantity",parseInt(s.target.value)||1)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Product"}),e.jsxs(d,{value:a.product||"MIS",onValueChange:s=>l("product",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"MIS",children:"MIS"}),e.jsx(r,{value:"NRML",children:"NRML"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"multiLegOrder",value:a.outputVariable||"",onChange:s=>l("outputVariable",s.target.value)})]})]}),o==="basketOrder"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Basket Name"}),e.jsx(n,{className:"h-8",placeholder:"Morning Portfolio",value:a.basketName||"",onChange:s=>l("basketName",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Orders (SYMBOL,EXCHANGE,ACTION,QTY)"}),e.jsx(U,{className:"min-h-[100px] text-xs font-mono",placeholder:`RELIANCE,NSE,BUY,10
INFY,NSE,BUY,5`,value:a.orders||"",onChange:s=>l("orders",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Product"}),e.jsxs(d,{value:a.product||"MIS",onValueChange:s=>l("product",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:K.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"basketResult",value:a.outputVariable||"",onChange:s=>l("outputVariable",s.target.value)})]})]}),o==="splitOrder"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"RELIANCE",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Action"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:le.map(s=>e.jsx("button",{type:"button",onClick:()=>l("action",s.value),className:S("rounded-lg border py-2 text-sm font-semibold",a.action===s.value?s.value==="BUY"?"bg-green-500/20 border-green-500 text-green-600":"bg-red-500/20 border-red-500 text-red-600":"border-border bg-muted"),children:s.label},s.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Total Quantity"}),e.jsx(n,{type:"number",min:1,className:"h-8",value:a.quantity||100,onChange:s=>l("quantity",parseInt(s.target.value)||100)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Split Size"}),e.jsx(n,{type:"number",min:1,className:"h-8",value:a.splitSize||10,onChange:s=>l("splitSize",parseInt(s.target.value)||10)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Product"}),e.jsxs(d,{value:a.product||"MIS",onValueChange:s=>l("product",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:K.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Splits into ",Math.ceil((a.quantity||100)/(a.splitSize||10))," orders"]})]}),o==="cancelOrder"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Order ID"}),e.jsx(n,{className:"h-8",placeholder:"{{orderResult.orderid}}",value:a.orderId||"",onChange:s=>l("orderId",s.target.value)}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Use variable from Place Order"})]}),o==="cancelAllOrders"&&e.jsx("div",{className:"rounded-lg border bg-muted/30 p-3",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cancels all open orders. No configuration needed."})}),o==="closePositions"&&e.jsx("div",{className:"rounded-lg border bg-muted/30 p-3",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:"Closes all open positions. No configuration needed."})}),o==="modifyOrder"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Order ID"}),e.jsx(n,{className:"h-8",placeholder:"{{orderResult.orderid}}",value:a.orderId||"",onChange:s=>l("orderId",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"New Price"}),e.jsx(n,{type:"number",step:"0.05",className:"h-8",placeholder:"Leave empty to keep",value:a.newPrice||"",onChange:s=>l("newPrice",parseFloat(s.target.value)||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"New Quantity"}),e.jsx(n,{type:"number",min:1,className:"h-8",placeholder:"Leave empty to keep",value:a.newQuantity||"",onChange:s=>l("newQuantity",parseInt(s.target.value)||0)})]})]}),o==="getQuote"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"RELIANCE",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"quote",value:a.outputVariable||"",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{quote.data.ltp}}"]})]})]}),o==="getDepth"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"SBIN",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"depth",value:a.outputVariable||"",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{depth.data.bids[0].price}}"]})]})]}),o==="openPosition"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"RELIANCE",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Product"}),e.jsxs(d,{value:a.product||"MIS",onValueChange:s=>l("product",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:K.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"position",value:a.outputVariable||"",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{position.quantity}}"]})]})]}),o==="history"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"SBIN",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Interval"}),e.jsxs(d,{value:a.interval||"1d",onValueChange:s=>l("interval",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"1m",children:"1 Min"}),e.jsx(r,{value:"5m",children:"5 Min"}),e.jsx(r,{value:"15m",children:"15 Min"}),e.jsx(r,{value:"1h",children:"1 Hour"}),e.jsx(r,{value:"1d",children:"Daily"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Days"}),e.jsx(n,{type:"number",min:1,max:365,className:"h-8",value:a.days||30,onChange:s=>l("days",parseInt(s.target.value)||30)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"ohlcv",value:a.outputVariable||"",onChange:s=>l("outputVariable",s.target.value)})]})]}),o==="expiry"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"NIFTY",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NFO",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"NFO",children:"NFO"}),e.jsx(r,{value:"BFO",children:"BFO"}),e.jsx(r,{value:"MCX",children:"MCX"}),e.jsx(r,{value:"CDS",children:"CDS"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"expiries",value:a.outputVariable||"",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{expiries.data[0]}}"]})]})]}),o==="multiQuotes"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbols (comma separated)"}),e.jsx(n,{className:"h-8",placeholder:"RELIANCE,INFY,TCS",value:a.symbols||"",onChange:s=>l("symbols",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"quotes",value:a.outputVariable||"quotes",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{quotes.results[0].data.ltp}}"]})]})]}),o==="symbol"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"NIFTY30DEC25FUT",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NFO",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"symbolInfo",value:a.outputVariable||"",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{symbolInfo.data.lotsize}}"]})]})]}),o==="optionSymbol"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Underlying"}),e.jsx(n,{className:"h-8",placeholder:"NIFTY",value:a.underlying||"",onChange:s=>l("underlying",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE_INDEX",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"NSE_INDEX",children:"NSE Index"}),e.jsx(r,{value:"BSE_INDEX",children:"BSE Index"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Expiry Date"}),e.jsx(n,{className:"h-8",placeholder:"30DEC25",value:a.expiryDate||"",onChange:s=>l("expiryDate",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Strike Offset"}),e.jsxs(d,{value:a.offset||"ATM",onValueChange:s=>l("offset",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"ATM",children:"ATM"}),e.jsx(r,{value:"ITM1",children:"ITM 1"}),e.jsx(r,{value:"ITM2",children:"ITM 2"}),e.jsx(r,{value:"OTM1",children:"OTM 1"}),e.jsx(r,{value:"OTM2",children:"OTM 2"}),e.jsx(r,{value:"OTM3",children:"OTM 3"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Option Type"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["CE","PE"].map(s=>e.jsx("button",{type:"button",onClick:()=>l("optionType",s),className:S("rounded-lg border py-2 text-sm font-semibold",a.optionType===s?s==="CE"?"bg-green-500/20 border-green-500 text-green-600":"bg-red-500/20 border-red-500 text-red-600":"border-border bg-muted"),children:s==="CE"?"Call":"Put"},s))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"optionSym",value:a.outputVariable||"",onChange:s=>l("outputVariable",s.target.value)})]})]}),o==="orderBook"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"orders",value:a.outputVariable||"orders",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{orders.data.orders}}"]})]}),o==="tradeBook"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"trades",value:a.outputVariable||"trades",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{trades.data}}"]})]}),o==="positionBook"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"positions",value:a.outputVariable||"positions",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{positions.data}}"]})]}),o==="syntheticFuture"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Underlying"}),e.jsx(n,{className:"h-8",placeholder:"NIFTY",value:a.underlying||"",onChange:s=>l("underlying",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE_INDEX",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"NSE_INDEX",children:"NSE Index"}),e.jsx(r,{value:"BSE_INDEX",children:"BSE Index"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Expiry Date"}),e.jsx(n,{className:"h-8",placeholder:"25NOV25",value:a.expiryDate||"",onChange:s=>l("expiryDate",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"synthFuture",value:a.outputVariable||"",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{synthFuture.synthetic_future_price}}"]})]})]}),o==="optionChain"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Underlying"}),e.jsx(n,{className:"h-8",placeholder:"NIFTY",value:a.underlying||"",onChange:s=>l("underlying",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE_INDEX",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"NSE_INDEX",children:"NSE Index"}),e.jsx(r,{value:"BSE_INDEX",children:"BSE Index"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Expiry Date"}),e.jsx(n,{className:"h-8",placeholder:"30DEC25",value:a.expiryDate||"",onChange:s=>l("expiryDate",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Strike Count"}),e.jsx(n,{type:"number",className:"h-8",placeholder:"10 (empty=full)",value:a.strikeCount||"",onChange:s=>l("strikeCount",parseInt(s.target.value)||void 0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"chain",value:a.outputVariable||"",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{chain.atm_strike}}"]})]})]}),o==="holidays"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Year"}),e.jsx(n,{type:"number",className:"h-8",placeholder:String(new Date().getFullYear()),value:a.year||"",onChange:s=>l("year",parseInt(s.target.value)||void 0)}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Empty = current year"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"holidays",value:a.outputVariable||"holidays",onChange:s=>l("outputVariable",s.target.value)})]})]}),o==="timings"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Date"}),e.jsx(n,{type:"date",className:"h-8",value:a.date||"",onChange:s=>l("date",s.target.value)}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Empty = today"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"timings",value:a.outputVariable||"timings",onChange:s=>l("outputVariable",s.target.value)})]})]}),o==="holdings"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"holdings",value:a.outputVariable||"holdings",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{holdings.data[0].symbol}}"]})]}),o==="funds"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"funds",value:a.outputVariable||"funds",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{funds.data.availablecash}}"]})]}),o==="margin"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Positions (JSON)"}),e.jsx(U,{className:"min-h-[100px] text-xs font-mono",placeholder:'[{"symbol": "NIFTY25DEC25FUT", "exchange": "NFO", "action": "BUY", "quantity": 75}]',value:a.positionsJson||"",onChange:s=>l("positionsJson",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"marginResult",value:a.outputVariable||"marginResult",onChange:s=>l("outputVariable",s.target.value)})]})]}),o==="subscribeLtp"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"RELIANCE",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"ltp",value:a.outputVariable||"ltp",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Real-time: ","{{ltp}}"]})]})]}),o==="subscribeQuote"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"RELIANCE",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"quote",value:a.outputVariable||"quote",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{quote.ltp}}",", ","{{quote.open}}"]})]})]}),o==="subscribeDepth"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"RELIANCE",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"depth",value:a.outputVariable||"depth",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{depth.bids[0].price}}"]})]})]}),o==="unsubscribe"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Stream Type"}),e.jsxs(d,{value:a.streamType||"all",onValueChange:s=>l("streamType",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"ltp",children:"LTP Only"}),e.jsx(r,{value:"quote",children:"Quote Only"}),e.jsx(r,{value:"depth",children:"Depth Only"}),e.jsx(r,{value:"all",children:"All Streams"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"Empty = all symbols",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]})]}),o==="delay"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Wait Duration"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{type:"number",min:1,className:"h-8 flex-1",value:a.delayValue||1,onChange:s=>l("delayValue",parseInt(s.target.value)||1)}),e.jsxs(d,{value:a.delayUnit||"seconds",onValueChange:s=>l("delayUnit",s),children:[e.jsx(x,{className:"h-8 w-28",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"seconds",children:"Seconds"}),e.jsx(r,{value:"minutes",children:"Minutes"}),e.jsx(r,{value:"hours",children:"Hours"})]})]})]})]})}),o==="waitUntil"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Target Time"}),e.jsx(n,{type:"time",className:"h-8",value:a.targetTime||"09:30",onChange:s=>l("targetTime",s.target.value)}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Workflow pauses until this time"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Label"}),e.jsx(n,{className:"h-8",placeholder:"Wait for Entry",value:a.label||"",onChange:s=>l("label",s.target.value)})]})]}),o==="log"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Log Level"}),e.jsxs(d,{value:a.level||"info",onValueChange:s=>l("level",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:Ea.map(s=>e.jsx(r,{value:s.value,children:e.jsx("span",{className:s.color,children:s.label})},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Message"}),e.jsx(U,{className:"min-h-[80px]",placeholder:"Log message with {{variables}}",value:a.message||"",onChange:s=>l("message",s.target.value)})]})]}),o==="telegramAlert"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"OpenAlgo Username"}),e.jsx(n,{className:"h-8",placeholder:"Your login ID",value:a.username||"",onChange:s=>l("username",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Message"}),e.jsx(U,{className:"min-h-[80px]",placeholder:"Order placed for {{orderResult.symbol}}",value:a.message||"",onChange:s=>l("message",s.target.value)})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-2",children:[e.jsx("p",{className:"text-[10px] font-medium mb-1",children:"Variables:"}),e.jsxs("p",{className:"text-[9px] font-mono text-muted-foreground",children:["{{orderResult.orderid}}",", ","{{quote.ltp}}",", ","{{timestamp}}"]})]})]}),o==="variable"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Variable Name"}),e.jsx(n,{className:"h-8",placeholder:"myLTP",value:a.variableName||"",onChange:s=>l("variableName",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use: ",`{{${a.variableName||"varName"}}}`]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Operation"}),e.jsxs(d,{value:a.operation||"set",onValueChange:s=>l("operation",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:Ta.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),["set","add","subtract","multiply","divide","append","parse_json"].includes(a.operation)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:a.operation==="parse_json"?"JSON String":"Value"}),a.operation==="parse_json"?e.jsx(U,{className:"min-h-[80px] font-mono",placeholder:'{"key": "value"}',value:String(a.value||""),onChange:s=>l("value",s.target.value)}):e.jsx(n,{className:"h-8",placeholder:"Value or {{variable}}",value:String(a.value||""),onChange:s=>l("value",s.target.value)})]}),["get","stringify"].includes(a.operation)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Source Variable"}),e.jsx(n,{className:"h-8",placeholder:"quoteData",value:a.sourceVariable||"",onChange:s=>l("sourceVariable",s.target.value)})]}),a.operation==="get"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"JSON Path"}),e.jsx(n,{className:"h-8",placeholder:"data.ltp",value:a.jsonPath||"",onChange:s=>l("jsonPath",s.target.value)})]})]}),o==="mathExpression"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Expression"}),e.jsx(U,{className:"min-h-[80px] font-mono",placeholder:"({{ltp}} * {{lotSize}}) + {{brokerage}}",value:a.expression||"",onChange:s=>l("expression",s.target.value)}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Supports: +, -, *, /, %, ** (power)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"result",value:a.outputVariable||"result",onChange:s=>l("outputVariable",s.target.value)})]})]}),o==="httpRequest"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Method"}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:ka.map(s=>e.jsx("button",{type:"button",onClick:()=>l("method",s.value),className:S("rounded-md border py-1.5 text-[10px] font-bold",a.method===s.value?"bg-primary text-primary-foreground":"border-border bg-muted"),children:s.label},s.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"URL"}),e.jsx(n,{className:"h-8",placeholder:"https://api.example.com",value:a.url||"",onChange:s=>l("url",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Headers (JSON)"}),e.jsx(U,{className:"min-h-[60px] font-mono text-xs",placeholder:'{"Authorization": "Bearer {{token}}"}',value:a.headers||"",onChange:s=>l("headers",s.target.value)})]}),["POST","PUT","PATCH"].includes(a.method||"GET")&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Body (JSON)"}),e.jsx(U,{className:"min-h-[80px] font-mono text-xs",placeholder:'{"symbol": "{{webhook.symbol}}"}',value:a.body||"",onChange:s=>l("body",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Timeout (ms)"}),e.jsx(n,{type:"number",min:1e3,max:6e4,className:"h-8",value:a.timeout||3e4,onChange:s=>l("timeout",parseInt(s.target.value)||3e4)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Output Variable"}),e.jsx(n,{className:"h-8",placeholder:"apiResponse",value:a.outputVariable||"",onChange:s=>l("outputVariable",s.target.value)}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Use ","{{apiResponse.data}}"]})]})]}),o==="timeWindow"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Start Time"}),e.jsx(n,{type:"time",className:"h-8",value:a.startTime||"09:15",onChange:s=>l("startTime",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"End Time"}),e.jsx(n,{type:"time",className:"h-8",value:a.endTime||"15:30",onChange:s=>l("endTime",s.target.value)})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{children:[e.jsx(t,{className:"text-xs",children:"Invert Condition"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Trigger outside window"})]}),e.jsx(Me,{checked:a.invertCondition||!1,onCheckedChange:s=>l("invertCondition",s)})]})]}),o==="timeCondition"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Condition Type"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:wa.map(s=>e.jsx("button",{type:"button",onClick:()=>l("conditionType",s.value),className:S("rounded-lg border py-2 text-sm font-semibold",a.conditionType===s.value?s.value==="entry"?"bg-green-500/20 border-green-500 text-green-600":s.value==="exit"?"bg-red-500/20 border-red-500 text-red-600":"bg-primary text-primary-foreground":"border-border bg-muted"),children:s.label},s.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Operator"}),e.jsxs(d,{value:a.operator||">=",onValueChange:s=>l("operator",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:Oa.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Target Time"}),e.jsx(n,{type:"time",className:"h-8",value:a.targetTime||"09:30",onChange:s=>l("targetTime",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Label"}),e.jsx(n,{className:"h-8",placeholder:"Market Open Entry",value:a.label||"",onChange:s=>l("label",s.target.value)})]})]}),o==="priceCondition"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"RELIANCE",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Field"}),e.jsxs(d,{value:a.field||"ltp",onValueChange:s=>l("field",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"ltp",children:"LTP"}),e.jsx(r,{value:"open",children:"Open"}),e.jsx(r,{value:"high",children:"High"}),e.jsx(r,{value:"low",children:"Low"}),e.jsx(r,{value:"prev_close",children:"Prev Close"}),e.jsx(r,{value:"change_percent",children:"Change %"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Operator"}),e.jsxs(d,{value:a.operator||">",onValueChange:s=>l("operator",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:">",children:">"}),e.jsx(r,{value:"<",children:"<"}),e.jsx(r,{value:"==",children:"="}),e.jsx(r,{value:">=",children:">="}),e.jsx(r,{value:"<=",children:"<="}),e.jsx(r,{value:"!=",children:"!="})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Value"}),e.jsx(n,{type:"number",step:"0.05",className:"h-8",value:a.value||"",onChange:s=>l("value",parseFloat(s.target.value)||0)})]})]}),o==="positionCheck"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Symbol"}),e.jsx(n,{className:"h-8",placeholder:"RELIANCE",value:a.symbol||"",onChange:s=>l("symbol",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Exchange"}),e.jsxs(d,{value:a.exchange||"NSE",onValueChange:s=>l("exchange",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:w.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Product"}),e.jsxs(d,{value:a.product||"MIS",onValueChange:s=>l("product",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsx(h,{children:K.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Condition"}),e.jsxs(d,{value:a.condition||"exists",onValueChange:s=>l("condition",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"exists",children:"Has Position"}),e.jsx(r,{value:"not_exists",children:"No Position"}),e.jsx(r,{value:"quantity_above",children:"Qty Above"}),e.jsx(r,{value:"quantity_below",children:"Qty Below"}),e.jsx(r,{value:"pnl_above",children:"P&L Above"}),e.jsx(r,{value:"pnl_below",children:"P&L Below"})]})]})]}),["quantity_above","quantity_below","pnl_above","pnl_below"].includes(a.condition)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Threshold"}),e.jsx(n,{type:"number",className:"h-8",value:a.threshold||"",onChange:s=>l("threshold",parseFloat(s.target.value)||0)})]})]}),o==="fundCheck"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Minimum Available Funds"}),e.jsx(n,{type:"number",min:0,className:"h-8",placeholder:"10000",value:a.minAvailable||"",onChange:s=>l("minAvailable",parseFloat(s.target.value)||0)}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Checks if margin is above this"})]}),o==="andGate"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Number of Inputs"}),e.jsxs(d,{value:String(a.inputCount||2),onValueChange:s=>l("inputCount",parseInt(s)),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"2",children:"2 inputs"}),e.jsx(r,{value:"3",children:"3 inputs"}),e.jsx(r,{value:"4",children:"4 inputs"}),e.jsx(r,{value:"5",children:"5 inputs"})]})]})]}),e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 text-xs",children:[e.jsx("p",{className:"font-medium mb-1",children:"AND Gate"}),e.jsx("p",{className:"text-muted-foreground",children:"Yes only if ALL conditions true"})]})]}),o==="orGate"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Number of Inputs"}),e.jsxs(d,{value:String(a.inputCount||2),onValueChange:s=>l("inputCount",parseInt(s)),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"2",children:"2 inputs"}),e.jsx(r,{value:"3",children:"3 inputs"}),e.jsx(r,{value:"4",children:"4 inputs"}),e.jsx(r,{value:"5",children:"5 inputs"})]})]})]}),e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 text-xs",children:[e.jsx("p",{className:"font-medium mb-1",children:"OR Gate"}),e.jsx("p",{className:"text-muted-foreground",children:"Yes if ANY condition true"})]})]}),o==="notGate"&&e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 text-xs",children:[e.jsx("p",{className:"font-medium mb-1",children:"NOT Gate"}),e.jsx("p",{className:"text-muted-foreground",children:"Inverts the condition. True becomes False, False becomes True."})]}),o==="group"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Group Name"}),e.jsx(n,{className:"h-8",placeholder:"Entry Logic",value:a.label||"",onChange:s=>l("label",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Color"}),e.jsxs(d,{value:a.color||"default",onValueChange:s=>l("color",s),children:[e.jsx(x,{className:"h-8",children:e.jsx(u,{})}),e.jsxs(h,{children:[e.jsx(r,{value:"default",children:"Default"}),e.jsx(r,{value:"blue",children:"Blue"}),e.jsx(r,{value:"green",children:"Green"}),e.jsx(r,{value:"red",children:"Red"}),e.jsx(r,{value:"purple",children:"Purple"}),e.jsx(r,{value:"orange",children:"Orange"})]})]})]})]}),!De[o]&&e.jsxs(e.Fragment,{children:[F&&e.jsx("div",{className:"rounded-lg border bg-muted/30 p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ks,{className:"h-4 w-4 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium",children:F.label}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:F.description})]})]})}),e.jsx(Ne,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs",children:"Node Label"}),e.jsx(n,{className:"h-8",placeholder:"Enter label...",value:a.label||"",onChange:s=>l("label",s.target.value)})]})]}),e.jsx(Ne,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"text-xs text-muted-foreground",children:"Node ID"}),e.jsx("code",{className:"block text-[10px] bg-muted px-2 py-1 rounded font-mono",children:E.id})]})]})})]})}function Va({logs:c,status:b,onClose:i}){const j=()=>{switch(b){case"running":return e.jsx(re,{className:"h-4 w-4 animate-pulse text-amber-500"});case"success":return e.jsx(Ie,{className:"h-4 w-4 text-green-500"});case"error":return e.jsx(ue,{className:"h-4 w-4 text-red-500"});default:return e.jsx(ye,{className:"h-4 w-4 text-muted-foreground"})}},v=()=>{switch(b){case"running":return"Executing...";case"success":return"Completed";case"error":return"Failed";default:return"Ready"}},y=m=>{try{return new Date(m).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}catch{return m}},T=m=>{switch(m){case"error":return e.jsx(ue,{className:"h-3.5 w-3.5 text-red-500"});case"warning":return e.jsx($s,{className:"h-3.5 w-3.5 text-amber-500"});default:return e.jsx(Ie,{className:"h-3.5 w-3.5 text-green-500"})}};return e.jsxs("div",{className:"w-80 border-l border-border bg-card flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-border px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[j(),e.jsx("span",{className:"font-medium",children:"Execution Log"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:S("text-xs px-2 py-0.5 rounded-full",b==="running"&&"bg-amber-500/10 text-amber-500",b==="success"&&"bg-green-500/10 text-green-500",b==="error"&&"bg-red-500/10 text-red-500",b==="idle"&&"bg-muted text-muted-foreground"),children:v()}),e.jsx(D,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:i,children:e.jsx(_e,{className:"h-4 w-4"})})]})]}),e.jsx(fe,{className:"flex-1",children:e.jsx("div",{className:"p-3 space-y-2",children:c.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[e.jsx(ye,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No logs yet"}),e.jsx("p",{className:"text-xs mt-1",children:'Click "Run Now" to execute the workflow'})]}):c.map((m,E)=>e.jsx("div",{className:S("rounded-lg border p-2.5 text-sm",m.level==="error"&&"border-red-500/30 bg-red-500/5",m.level==="warning"&&"border-amber-500/30 bg-amber-500/5",m.level==="info"&&"border-border bg-background"),children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"mt-0.5",children:T(m.level)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("span",{className:"text-xs text-muted-foreground font-mono",children:y(m.time)})}),e.jsx("p",{className:S("text-sm break-words",m.level==="error"&&"text-red-500",m.level==="warning"&&"text-amber-500"),children:m.message})]})]})},E))})}),c.length>0&&e.jsx("div",{className:"border-t border-border px-4 py-2 text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[c.length," log entries"]}),e.jsxs("span",{children:[c.filter(m=>m.level==="error").length," errors"]})]})})]})}let qe=0;const Pa=()=>`node_${qe++}`;function Da(){const{id:c}=Ue(),b=na(),i=gs(),j=N.useRef(null),{screenToFlowPosition:v}=Fe(),{name:y,nodes:T,edges:m,selectedNodeId:E,isModified:P,setWorkflow:O,setName:l,onNodesChange:G,onEdgesChange:X,onConnect:_,addNode:F,selectNode:a,selectEdge:o,deleteSelected:W,markSaved:s,resetWorkflow:C}=Ce(),[k,q]=N.useState(!1),[J,Z]=N.useState(!1),[he,B]=N.useState([]),[Y,R]=N.useState("idle"),{isLoading:ee,data:I}=Ae({queryKey:te.workflow(Number(c)),queryFn:()=>xs(Number(c)),enabled:!!c});N.useEffect(()=>{if(I){const g=I.edges.map(M=>({...M,type:"insertable",animated:!0}));O({id:I.id,name:I.name,description:I.description||"",nodes:I.nodes,edges:g}),q(I.is_active),qe=Math.max(0,...I.nodes.map(M=>{const L=M.id.match(/node_(\d+)/);return L?parseInt(L[1]):0}))+1}},[I,O]),N.useEffect(()=>()=>{C()},[C]);const A=ce({mutationFn:()=>ns(Number(c),{name:y,nodes:T,edges:m}),onSuccess:()=>{s(),i.invalidateQueries({queryKey:te.workflows()}),V.success("Workflow saved")},onError:g=>{V.error(g.message)}}),se=ce({mutationFn:()=>is(Number(c)),onSuccess:()=>{q(!0),i.invalidateQueries({queryKey:te.workflow(Number(c))}),V.success("Workflow activated")},onError:g=>{V.error(g.message)}}),ae=ce({mutationFn:()=>cs(Number(c)),onSuccess:()=>{q(!1),i.invalidateQueries({queryKey:te.workflow(Number(c))}),V.success("Workflow deactivated")},onError:g=>{V.error(g.message)}}),ie=ce({mutationFn:()=>(R("running"),B([]),Z(!0),os(Number(c))),onSuccess:g=>{R(g.status==="success"?"success":"error"),g.logs&&B(g.logs),g.status==="success"?V.success(g.message||"Execution completed"):V.error(g.message||"Execution failed")},onError:g=>{R("error"),B([{time:new Date().toISOString(),message:g.message,level:"error"}]),V.error(g.message)}});N.useEffect(()=>{const g=f=>{const M=f.target;M.tagName==="INPUT"||M.tagName==="TEXTAREA"||M.isContentEditable||((f.key==="Delete"||f.key==="Backspace")&&E&&(f.preventDefault(),W()),(f.ctrlKey||f.metaKey)&&f.key==="s"&&(f.preventDefault(),P&&!A.isPending&&A.mutate()),f.key==="Escape"&&a(null))};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[E,W,a,P,A]);const pe=N.useCallback((g,f)=>{g.dataTransfer.setData("application/reactflow",f),g.dataTransfer.effectAllowed="move"},[]),me=N.useCallback(g=>{g.preventDefault(),g.dataTransfer.dropEffect="move"},[]),ge=N.useCallback(g=>{g.preventDefault();const f=g.dataTransfer.getData("application/reactflow");if(!f||!j.current)return;const M=v({x:g.clientX,y:g.clientY}),L=We[f]||{},Xe={id:Pa(),type:f,position:M,data:{...L}};F(Xe)},[v,F]),je=N.useCallback((g,f)=>{a(f.id)},[a]),Q=N.useCallback(()=>{a(null)},[a]),Ye=N.useCallback((g,f)=>{o(f.id)},[o]),Qe=N.useCallback(async()=>{try{const g=await ds(Number(c)),f=new Blob([JSON.stringify(g,null,2)],{type:"application/json"}),M=URL.createObjectURL(f),L=document.createElement("a");L.href=M,L.download=`${g.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()}.json`,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(M),V.success("Workflow exported")}catch(g){V.error(g instanceof Error?g.message:"Export failed")}},[c]);return ee?e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx(ne,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"flex h-screen flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-border bg-card px-4 py-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{variant:"ghost",size:"icon",onClick:()=>b("/flow"),children:e.jsx(Js,{className:"h-4 w-4"})}),e.jsx(n,{value:y,onChange:g=>l(g.target.value),className:"h-8 w-64 border-transparent bg-transparent px-2 font-medium hover:border-border focus:border-border"}),P&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"Unsaved"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>A.mutate(),disabled:A.isPending||!P,children:[A.isPending?e.jsx(ne,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Zs,{className:"mr-2 h-4 w-4"}),"Save"]}),k?e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>ae.mutate(),disabled:ae.isPending,children:[ae.isPending?e.jsx(ne,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(ea,{className:"mr-2 h-4 w-4"}),"Deactivate"]}):e.jsxs(D,{size:"sm",onClick:()=>se.mutate(),disabled:se.isPending,children:[se.isPending?e.jsx(ne,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(sa,{className:"mr-2 h-4 w-4"}),"Activate"]}),e.jsxs(Le,{children:[e.jsx(Be,{asChild:!0,children:e.jsx(D,{variant:"ghost",size:"icon",children:e.jsx(aa,{className:"h-4 w-4"})})}),e.jsxs(Re,{align:"end",children:[e.jsx(xe,{onClick:()=>ie.mutate(),disabled:ie.isPending,children:"Run Now"}),e.jsxs(xe,{onClick:()=>Z(!J),children:[e.jsx(ye,{className:"mr-2 h-4 w-4"}),J?"Hide Logs":"Show Logs"]}),e.jsxs(xe,{onClick:Qe,children:[e.jsx(la,{className:"mr-2 h-4 w-4"}),"Export Workflow"]})]})]})]})]}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsx("div",{className:"w-56 flex-shrink-0",children:e.jsx(ya,{onDragStart:pe})}),e.jsx("div",{ref:j,className:"flex-1",children:e.jsxs(es,{nodes:T,edges:m,onNodesChange:G,onEdgesChange:X,onConnect:_,onNodeClick:je,onEdgeClick:Ye,onPaneClick:Q,onDragOver:me,onDrop:ge,nodeTypes:ga,edgeTypes:Na,fitView:!0,snapToGrid:!0,snapGrid:[16,16],deleteKeyCode:null,defaultEdgeOptions:{type:"insertable",animated:!0},connectionLineStyle:{stroke:"hsl(var(--primary))",strokeWidth:2},children:[e.jsx(ss,{gap:16,size:1}),e.jsx(as,{}),e.jsx(ls,{nodeStrokeWidth:3,pannable:!0,zoomable:!0}),e.jsx(ts,{position:"bottom-center",className:"mb-4",children:e.jsxs("div",{className:S("flex items-center gap-2 rounded-lg border border-border bg-card px-3 py-2 text-sm",k&&"border-green-500/30 bg-green-500/5"),children:[e.jsx("div",{className:S("h-2 w-2 rounded-full",k?"bg-green-500":"bg-muted-foreground")}),e.jsx("span",{className:"text-muted-foreground",children:k?"Workflow active":"Workflow inactive"})]})})]})}),E&&e.jsx(Ma,{}),J&&!E&&e.jsx(Va,{logs:he,status:Y,onClose:()=>Z(!1)})]})]})}function Ka(){return e.jsx(Ze,{children:e.jsx(Da,{})})}export{Ka as default};
