import{r as a,j as e}from"./vendor-react-RhKMXzW9.js";import{t as i,e as y,B as d}from"./index-C9Wavwzw.js";import{a as b}from"./admin-DDTAZvsu.js";import{C as o,b as m,c as h,d as k,a as x}from"./card-RS00WnSr.js";import{I as v}from"./input-Ba3hZO0a.js";import{T as U,a as G,b as D,c as g,d as J,e as j}from"./table-C45c-EtF.js";import{A as K,P as Q,ak as V,X as Y,a1 as Z,S as ee}from"./vendor-icons-BPjpxhHr.js";import{L as se}from"./vendor-router-D7kKkCmL.js";import"./vendor-radix-Cue1hf3Z.js";function me(){const[F,H]=a.useState([]),[C,P]=a.useState([]),[A,I]=a.useState(""),[L,O]=a.useState(!0),[u,f]=a.useState(null),[c,T]=a.useState(""),[l,S]=a.useState(""),[$,w]=a.useState(!1),[r,q]=a.useState(""),[p,E]=a.useState(null),[M,_]=a.useState(!1);a.useEffect(()=>{B()},[]);const B=async()=>{try{const s=await b.getTimings();H(s.data),P(s.today_timings),I(s.today)}catch(s){console.error("Error fetching timings:",s),i.error("Failed to load market timings")}finally{O(!1)}},z=s=>{f(s.exchange),T(s.start_time),S(s.end_time)},R=async s=>{if(!c||!l){i.error("Please enter both start and end times");return}const t=/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/;if(!t.test(c)||!t.test(l)){i.error("Invalid time format. Use HH:MM");return}w(!0);try{const n=await b.editTiming(s,{start_time:c,end_time:l});n.status==="success"?(i.success(n.message||"Timing updated successfully"),f(null),B()):i.error(n.message||"Failed to update timing")}catch(n){const W=n;i.error(W.response?.data?.message||"Failed to update timing")}finally{w(!1)}},X=async()=>{if(!r){i.error("Please select a date");return}_(!0);try{const s=await b.checkTimings(r);E(s.timings)}catch(s){const t=s;i.error(t.response?.data?.message||"Failed to check timings")}finally{_(!1)}},N=s=>({NSE:"bg-blue-500",BSE:"bg-red-500",NFO:"bg-green-500",BFO:"bg-yellow-500",MCX:"bg-purple-500",CDS:"bg-orange-500",BCD:"bg-pink-500"})[s]||"bg-gray-500";return L?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"py-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(se,{to:"/admin",className:"text-muted-foreground hover:text-foreground",children:e.jsx(K,{className:"h-4 w-4"})}),e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(Q,{className:"h-6 w-6"}),"Market Timings"]})]}),e.jsx("p",{className:"text-muted-foreground",children:"Configure trading session timings for each exchange"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(o,{children:[e.jsxs(m,{children:[e.jsx(h,{children:"Default Timings"}),e.jsx(k,{children:"Configure the default trading session timings for each exchange"})]}),e.jsx(x,{children:e.jsx("div",{className:"border rounded-md",children:e.jsxs(U,{children:[e.jsx(G,{children:e.jsxs(D,{children:[e.jsx(g,{children:"Exchange"}),e.jsx(g,{children:"Start Time"}),e.jsx(g,{children:"End Time"}),e.jsx(g,{className:"w-[80px]",children:"Actions"})]})}),e.jsx(J,{children:F.map(s=>e.jsxs(D,{children:[e.jsx(j,{children:e.jsx(y,{className:`${N(s.exchange)} text-white`,children:s.exchange})}),e.jsx(j,{children:u===s.exchange?e.jsx(v,{type:"time",value:c,onChange:t=>T(t.target.value),className:"w-28 h-8"}):e.jsx("span",{className:"font-mono",children:s.start_time})}),e.jsx(j,{children:u===s.exchange?e.jsx(v,{type:"time",value:l,onChange:t=>S(t.target.value),className:"w-28 h-8"}):e.jsx("span",{className:"font-mono",children:s.end_time})}),e.jsx(j,{children:u===s.exchange?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(d,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>R(s.exchange),disabled:$,children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx(d,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>f(null),children:e.jsx(Y,{className:"h-4 w-4"})})]}):e.jsx(d,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>z(s),children:e.jsx(Z,{className:"h-4 w-4"})})})]},s.exchange))})]})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(o,{children:[e.jsxs(m,{children:[e.jsx(h,{children:"Today's Timings"}),e.jsxs(k,{children:["Actual market timings for ",A]})]}),e.jsx(x,{children:C.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-4",children:"Markets are closed today (Weekend/Holiday)"}):e.jsx("div",{className:"space-y-2",children:C.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded-md",children:[e.jsx(y,{className:`${N(s.exchange)} text-white`,children:s.exchange}),e.jsxs("span",{className:"font-mono text-sm",children:[s.start_time," - ",s.end_time]})]},s.exchange))})})]}),e.jsxs(o,{children:[e.jsxs(m,{children:[e.jsx(h,{children:"Check Timings for Date"}),e.jsx(k,{children:"Look up market timings for a specific date"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{type:"date",value:r,onChange:s=>{q(s.target.value),E(null)},className:"flex-1"}),e.jsxs(d,{onClick:X,disabled:M||!r,children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),M?"Checking...":"Check"]})]}),p!==null&&e.jsx("div",{className:"border-t pt-4",children:p.length===0?e.jsxs("div",{className:"text-center text-muted-foreground py-4",children:["Markets are closed on ",r," (Weekend/Holiday)"]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm font-medium mb-2",children:["Timings for ",r,":"]}),p.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded-md",children:[e.jsx(y,{className:`${N(s.exchange)} text-white`,children:s.exchange}),e.jsxs("span",{className:"font-mono text-sm",children:[s.start_time," - ",s.end_time]})]},s.exchange))]})})]})]})]})]}),e.jsxs(o,{children:[e.jsx(m,{children:e.jsx(h,{children:"About Market Timings"})}),e.jsx(x,{className:"prose prose-sm dark:prose-invert max-w-none",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-foreground mb-2",children:"Equity Markets (NSE, BSE)"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Pre-open session: 09:00 - 09:15"}),e.jsx("li",{children:"Normal market: 09:15 - 15:30"}),e.jsx("li",{children:"Post-close session: 15:40 - 16:00"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-foreground mb-2",children:"F&O Markets (NFO, BFO)"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Normal market: 09:15 - 15:30"}),e.jsx("li",{children:"Same timings as equity markets"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-foreground mb-2",children:"Currency Markets (CDS, BCD)"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Normal market: 09:00 - 17:00"}),e.jsx("li",{children:"Extended hours compared to equity"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-foreground mb-2",children:"Commodity Market (MCX)"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Normal market: 09:00 - 23:55"}),e.jsx("li",{children:"Extended trading into late evening"})]})]})]})})]})]})}export{me as default};
