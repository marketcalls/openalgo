import{r as n,j as e}from"./vendor-react-CCyQGCED.js";import{d as Fs,u as Ds,i as Ms,w as k,s as l,e as j,B as b,t as H}from"./index-D0023jFM.js";import{A as N,b as v,a as w}from"./alert-Dlgyh2fF.js";import{A as Rs,b as Is,c as Us,d as Ls,e as Bs,f as Os,h as $s}from"./alert-dialog-BDgJ3H--.js";import{S as Ye,a as Xe,b as Qe,c as Ze,d as Je}from"./select-DXT-lI-N.js";import{C as d,a as c,b as o,d as h,c as u}from"./card-CDguRyHx.js";import{C as es}from"./checkbox-CqSXqG4p.js";import{I as x}from"./input-D8_g_dg9.js";import{L as i}from"./label-BgxgrBuS.js";import{P as zs}from"./progress-BcnjzSlC.js";import{S as D}from"./switch-ByXWOYiO.js";import{T as Hs,a as qs,b as E,c as F}from"./tabs-ObqD9FGF.js";import{N as Ks,U as Vs,J as ee,K as se,B as ss,aa as as,ab as Gs,H as ae,A as rs,m as ts,X as Ws,Y as y,y as q,ac as Ys,ad as Xs,ae as Qs,W as Zs,C as Js,af as ea,a5 as sa,q as aa,r as ra,ag as ta,ah as na,a7 as ia,T as la}from"./vendor-icons-CCn_k3dF.js";import{L as da}from"./vendor-router-Dzc1xxhr.js";import"./vendor-charts-l0_txfiz.js";import"./vendor-radix-CYVJEJRR.js";const ca=[{value:"light",label:"Light",icon:aa,description:"Clean, bright interface for daytime trading"},{value:"dark",label:"Dark",icon:ra,description:"Reduced eye strain for extended sessions"}],oa=[{value:"zinc",label:"Zinc",color:"bg-zinc-500"},{value:"slate",label:"Slate",color:"bg-slate-500"},{value:"gray",label:"Gray",color:"bg-gray-500"},{value:"neutral",label:"Neutral",color:"bg-neutral-500"},{value:"green",label:"Green",color:"bg-green-500"},{value:"blue",label:"Blue",color:"bg-blue-500"},{value:"violet",label:"Violet",color:"bg-violet-500"},{value:"orange",label:"Orange",color:"bg-orange-500"}],ma=[{value:"top-left",label:"Top Left"},{value:"top-center",label:"Top Center"},{value:"top-right",label:"Top Right"},{value:"bottom-left",label:"Bottom Left"},{value:"bottom-center",label:"Bottom Center"},{value:"bottom-right",label:"Bottom Right"}],ha=[{key:"orders",label:"Order Notifications",description:"Real-time BUY/SELL order placement, cancellation, and modification alerts"},{key:"analyzer",label:"Analyzer Mode",description:"Real-time sandbox/analyzer mode operation notifications"},{key:"system",label:"System Alerts",description:"Password changes, master contract downloads, and system events"},{key:"actionCenter",label:"Action Center",description:"Pending order notifications in semi-auto mode"}],xa=[{key:"positions",label:"Positions",description:"Position close/update operations and P&L notifications"},{key:"strategy",label:"Strategy Management",description:"Strategy creation, symbol configuration, and webhook operations"},{key:"chartink",label:"Chartink",description:"Chartink strategy operations and scanner integrations"}],ua=[{key:"historify",label:"Historify",description:"Historical data jobs, file uploads, downloads, and schedules"},{key:"pythonStrategy",label:"Python Strategy",description:"Python strategy uploads, execution, logs, and scheduling"},{key:"flow",label:"Flow Workflows",description:"Visual workflow creation, execution, and management"}],pa=[{key:"telegram",label:"Telegram Bot",description:"Telegram bot operations, broadcasts, and user management"},{key:"admin",label:"Admin Panel",description:"Market timings, holidays, freeze quantities, and admin settings"},{key:"monitoring",label:"Monitoring",description:"Health monitor, latency dashboard, and security alerts"},{key:"clipboard",label:"Clipboard",description:"Copy to clipboard confirmation messages"}];function Fa(){const ns=Fs(s=>s.user),{mode:U,color:L,appMode:is,setMode:re,setColor:te}=Ds(),t=Ms(),[ls,ds]=n.useState("account"),[cs,os]=n.useState(!0),[A,ms]=n.useState(null),[K,ne]=n.useState(""),[M,ie]=n.useState(""),[R,le]=n.useState(""),[V,hs]=n.useState({length:!1,uppercase:!1,lowercase:!1,number:!1,special:!1}),[de,ce]=n.useState(!1),[oe,me]=n.useState("smtp.gmail.com"),[he,xe]=n.useState("587"),[ue,pe]=n.useState(""),[G,ge]=n.useState(""),[je,be]=n.useState(""),[fe,ye]=n.useState("smtp.gmail.com"),[Ne,ve]=n.useState(!0),[we,ke]=n.useState(!1),[W,Se]=n.useState(""),[_e,Ce]=n.useState(!1),[Te,Ae]=n.useState(!1),[P,B]=n.useState(null),[r,Y]=n.useState(null),[S,Pe]=n.useState(""),[_,Ee]=n.useState(""),[O,Fe]=n.useState(""),[$,De]=n.useState(""),[p,Me]=n.useState(""),[I,Re]=n.useState(!1),[C,Ie]=n.useState(""),[T,Ue]=n.useState(""),[Le,Be]=n.useState(!1),[Oe,$e]=n.useState(!1),[xs,z]=n.useState(!1),[f,us]=n.useState(null),[X,ze]=n.useState(!1),[He,qe]=n.useState(!1),g=is==="analyzer";n.useEffect(()=>{ps(),gs()},[]);const ps=async()=>{try{const s=await k.get("/auth/profile-data");if(s.data.status==="success"){ms(s.data.data);const a=s.data.data.smtp_settings;a&&(me(a.smtp_server||"smtp.gmail.com"),xe(String(a.smtp_port||587)),pe(a.smtp_username||""),be(a.smtp_from_email||""),ye(a.smtp_helo_hostname||"smtp.gmail.com"),ve(a.smtp_use_tls!==!1),Se(a.smtp_username||""))}}catch{l.error("Failed to load profile data","admin")}finally{os(!1)}},gs=async()=>{try{const s=await k.get("/api/broker/credentials");s.data.status==="success"&&(Y(s.data.data),Me(s.data.data.current_broker),Re(s.data.data.ngrok_allow),Ie(s.data.data.host_server),Ue(s.data.data.websocket_url||""))}catch{}},Q=async()=>{ze(!0);try{const s=await k.get("/api/system/permissions");s.data.status==="success"&&us(s.data.data)}catch{l.error("Failed to load permission status","admin")}finally{ze(!1)}},js=async()=>{qe(!0);try{const s=await k.post("/api/system/permissions/fix");if(s.data.status==="success"){const{fixed:a,failed:m,message:We}=s.data.data;a.length>0&&l.success(`Fixed ${a.length} permission issues`,"admin"),m.length>0&&l.warning(`${m.length} issues could not be fixed automatically`,"admin"),a.length===0&&m.length===0&&l.info(We,"admin"),await Q()}else l.error("Failed to fix permissions","admin")}catch{l.error("Failed to fix permissions","admin")}finally{qe(!1)}},Ke=s=>{const m=(r?.redirect_url||"http://127.0.0.1:5000").match(/^(https?:\/\/[^/]+)/);return`${m?m[1]:"http://127.0.0.1:5000"}/${s}/callback`},bs=async()=>{Be(!0);try{const s=new FormData;S&&s.append("broker_api_key",S),_&&s.append("broker_api_secret",_),O&&s.append("broker_api_key_market",O),$&&s.append("broker_api_secret_market",$),p&&p!==r?.current_broker&&s.append("redirect_url",Ke(p));const a=await k.post("/api/broker/credentials",s);a.data.status==="success"?(l.success(a.data.message,"admin"),r&&Y({...r,current_broker:p||r.current_broker,redirect_url:p!==r.current_broker?Ke(p):r.redirect_url,broker_api_key:S?`${S.slice(0,6)}${"*".repeat(Math.max(0,S.length-6))}`:r.broker_api_key,broker_api_key_raw_length:S?S.length:r.broker_api_key_raw_length,broker_api_secret:_?`${_.slice(0,4)}${"*".repeat(Math.max(0,_.length-4))}`:r.broker_api_secret,broker_api_secret_raw_length:_?_.length:r.broker_api_secret_raw_length}),Pe(""),Ee(""),Fe(""),De(""),z(!0)):l.error(a.data.message||"Failed to save credentials","admin")}catch(s){const a=s;l.error(a.response?.data?.message||"Failed to save broker credentials","admin")}finally{Be(!1)}},fs=!!(S||_||O||$||p&&p!==r?.current_broker),ys=!!(I!==r?.ngrok_allow||C&&C!==r?.host_server||T&&T!==r?.websocket_url),Ns=async()=>{$e(!0);try{const s={ngrok_allow:I?"TRUE":"FALSE"};C&&(s.host_server=C),T&&(s.websocket_url=T);const a=await k.post("/api/broker/credentials",s);a.data.status==="success"?(l.success(a.data.message,"admin"),r&&Y({...r,ngrok_allow:I,host_server:C||r.host_server,websocket_url:T||r.websocket_url}),z(!0)):l.error(a.data.message||"Failed to save settings","admin")}catch(s){const a=s;l.error(a.response?.data?.message||"Failed to save settings","admin")}finally{$e(!1)}},Ve=n.useCallback(s=>{const a={length:s.length>=8,uppercase:/[A-Z]/.test(s),lowercase:/[a-z]/.test(s),number:/[0-9]/.test(s),special:/[!@#$%^&*]/.test(s)};return hs(a),Object.values(a).every(Boolean)},[]);n.useEffect(()=>{Ve(M)},[M,Ve]);const vs=()=>{const s=Object.values(V).filter(Boolean).length;return s===0?{percentage:0,label:"None",color:"bg-gray-400"}:s<=2?{percentage:40,label:"Weak",color:"bg-red-500"}:s<=3?{percentage:60,label:"Fair",color:"bg-yellow-500"}:s<=4?{percentage:80,label:"Good",color:"bg-blue-500"}:{percentage:100,label:"Strong",color:"bg-green-500"}},Z=M===R&&R!=="",ws=Object.values(V).every(Boolean),Ge=Z&&ws&&K!=="",ks=async s=>{if(s.preventDefault(),!!Ge){ce(!0);try{const a=new FormData;a.append("old_password",K),a.append("new_password",M),a.append("confirm_password",R);const m=await k.post("/auth/change-password",a);m.data.status==="success"?(l.success(m.data.message||"Password changed successfully","system"),ne(""),ie(""),le("")):l.error(m.data.message||"Failed to change password","system")}catch(a){const m=a;l.error(m.response?.data?.message||"Failed to change password","system")}finally{ce(!1)}}},Ss=async s=>{s.preventDefault(),ke(!0);try{const a=new FormData;a.append("smtp_server",oe),a.append("smtp_port",he),a.append("smtp_username",ue),G&&a.append("smtp_password",G),a.append("smtp_from_email",je),a.append("smtp_helo_hostname",fe),Ne&&a.append("smtp_use_tls","on");const m=await k.post("/auth/smtp-config",a);m.data.status==="success"?(l.success(m.data.message||"SMTP settings saved successfully","admin"),ge("")):l.error(m.data.message||"Failed to save SMTP settings","admin")}catch(a){const m=a;l.error(m.response?.data?.message||"Failed to save SMTP settings","admin")}finally{ke(!1)}},_s=async()=>{if(!W){l.error("Please enter an email address to test","admin");return}Ce(!0),B(null);try{const s=new FormData;s.append("test_email",W);const a=await k.post("/auth/test-smtp",s);a.data.success?l.success(a.data.message||"Test email sent successfully","admin"):l.error(a.data.message||"Failed to send test email","admin")}catch(s){const a=s;l.error(a.response?.data?.message||"Failed to send test email","admin")}finally{Ce(!1)}},Cs=async()=>{Ae(!0),B(null);try{const s=await k.post("/auth/debug-smtp",{});B(s.data)}catch(s){B({success:!1,message:s.response?.data?.message||"Failed to debug SMTP",details:[]})}finally{Ae(!1)}},Ts=s=>{if(g){l.error("Cannot change theme while in Analyzer Mode","system");return}re(s),l.success(`Theme changed to ${s}`,"system")},As=s=>{if(g){l.error("Cannot change theme while in Analyzer Mode","system");return}te(s),l.success(`Accent color changed to ${s}`,"system")},Ps=()=>{if(g){l.error("Cannot change theme while in Analyzer Mode","system");return}re("light"),te("zinc"),l.success("Theme reset to default","system")},Es=s=>{navigator.clipboard.writeText(s).then(()=>{l.success("Copied to clipboard","clipboard")}).catch(()=>{l.error("Failed to copy","clipboard")})},J=vs();return cs?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"py-6 max-w-3xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(da,{to:"/dashboard",className:"text-muted-foreground hover:text-foreground",children:e.jsx(Ks,{className:"h-4 w-4"})}),e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(Vs,{className:"h-6 w-6"}),"Profile Settings"]})]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your account settings and security preferences"})]}),e.jsxs(Hs,{value:ls,onValueChange:s=>{ds(s),s==="permissions"&&!f&&Q()},children:[e.jsxs(qs,{className:"grid w-full grid-cols-7",children:[e.jsxs(E,{value:"account",className:"gap-1",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Account"})]}),e.jsxs(E,{value:"broker",className:"gap-1",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Broker"})]}),e.jsxs(E,{value:"alerts",className:"gap-1",children:[e.jsx(ss,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Alerts"})]}),e.jsxs(E,{value:"permissions",className:"gap-1",children:[e.jsx(as,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"System"})]}),e.jsxs(E,{value:"theme",className:"gap-1",children:[e.jsx(Gs,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Theme"})]}),e.jsxs(E,{value:"smtp",className:"gap-1",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"SMTP"})]}),e.jsxs(E,{value:"totp",className:"gap-1",children:[e.jsx(rs,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"TOTP"})]})]}),e.jsxs(F,{value:"account",className:"space-y-6",children:[e.jsxs(d,{children:[e.jsx(c,{children:e.jsx(o,{children:"Account Information"})}),e.jsxs(h,{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Username"}),e.jsx(x,{value:ns?.username||A?.username||"",disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Account Type"}),e.jsx("div",{className:"pt-2",children:e.jsx(j,{children:"Administrator"})})]})]})]}),e.jsxs(d,{children:[e.jsx(c,{children:e.jsx(o,{children:"Change Password"})}),e.jsx(h,{children:e.jsxs("form",{onSubmit:ks,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Current Password"}),e.jsx(x,{type:"password",placeholder:"Enter your current password",value:K,onChange:s=>ne(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"New Password"}),e.jsx(x,{type:"password",placeholder:"Enter your new password",value:M,onChange:s=>ie(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Confirm New Password"}),e.jsx(x,{type:"password",placeholder:"Confirm your new password",value:R,onChange:s=>le(s.target.value)}),R&&e.jsx("p",{className:`text-sm ${Z?"text-green-500":"text-red-500"}`,children:Z?"Passwords match":"Passwords do not match"})]}),e.jsxs("div",{className:"bg-muted rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Strength"}),e.jsx("span",{className:"font-medium",children:J.label})]}),e.jsx(zs,{value:J.percentage,className:J.color}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:Object.entries(V).map(([s,a])=>e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-full border ${a?"bg-green-500/10 border-green-500 text-green-600":"bg-muted border-border text-muted-foreground"}`,children:[a?e.jsx(ts,{className:"h-3 w-3"}):e.jsx(Ws,{className:"h-3 w-3"}),e.jsxs("span",{children:[s==="length"&&"8+ chars",s==="uppercase"&&"A-Z",s==="lowercase"&&"a-z",s==="number"&&"0-9",s==="special"&&"Special (@#$%^&*)"]})]},s))})]}),e.jsx(b,{type:"submit",disabled:!Ge||de,children:de?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-4 w-4 mr-2 animate-spin"}),"Changing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Change Password"]})})]})})]})]}),e.jsxs(F,{value:"broker",className:"space-y-6",children:[e.jsxs(N,{children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx(v,{children:"Broker API Credentials"}),e.jsx(w,{children:"Update your broker API credentials. Changes require an application restart to take effect. You will be logged out after saving."})]}),e.jsxs(d,{children:[e.jsxs(c,{children:[e.jsx(o,{children:"Current Configuration"}),e.jsx(u,{children:"Your currently configured broker and credentials"})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Current Broker"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(j,{variant:"outline",className:"text-base",children:r?.current_broker?.toUpperCase()||"Not configured"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Redirect URL"}),e.jsx("code",{className:"text-xs text-muted-foreground break-all",children:r?.redirect_url||"Not configured"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"API Key"}),e.jsx("code",{className:"text-xs text-muted-foreground",children:r?.broker_api_key||"(not set)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"API Secret"}),e.jsx("code",{className:"text-xs text-muted-foreground",children:r?.broker_api_secret||"(not set)"})]})]}),(r?.broker_api_key_market_raw_length??0)>0&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Market API Key"}),e.jsx("code",{className:"text-xs text-muted-foreground",children:r?.broker_api_key_market||"(not set)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Market API Secret"}),e.jsx("code",{className:"text-xs text-muted-foreground",children:r?.broker_api_secret_market||"(not set)"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2 border-t",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Ngrok Status"}),e.jsx(j,{variant:r?.ngrok_allow?"default":"secondary",children:r?.ngrok_allow?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Host Server"}),e.jsx("code",{className:"text-xs text-muted-foreground break-all",children:r?.host_server||"(not set)"})]})]})]})]}),e.jsxs(d,{children:[e.jsxs(c,{children:[e.jsx(o,{children:"Update Credentials"}),e.jsx(u,{children:"Enter new values to update. Leave fields empty to keep existing values."})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Select Broker"}),e.jsxs(Ye,{value:p,onValueChange:Me,children:[e.jsx(Xe,{children:e.jsx(Qe,{placeholder:"Select a broker"})}),e.jsx(Ze,{children:r?.valid_brokers.map(s=>e.jsx(Je,{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))})]}),p&&p!==r?.current_broker&&e.jsxs("p",{className:"text-sm text-yellow-600 dark:text-yellow-500",children:["Changing broker to: ",p.toUpperCase()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Broker API Key"}),e.jsx(x,{type:"password",value:S,onChange:s=>Pe(s.target.value),placeholder:"Enter new API key"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:(r?.broker_api_key_raw_length??0)>0?`Current: ${r?.broker_api_key_raw_length} chars`:"Not currently set"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Broker API Secret"}),e.jsx(x,{type:"password",value:_,onChange:s=>Ee(s.target.value),placeholder:"Enter new API secret"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:(r?.broker_api_secret_raw_length??0)>0?`Current: ${r?.broker_api_secret_raw_length} chars`:"Not currently set"})]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Market Data API (Optional)"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Required only for XTS API supported brokers (e.g., 5paisa XTS, Jainam XTS)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Market API Key"}),e.jsx(x,{type:"password",value:O,onChange:s=>Fe(s.target.value),placeholder:"Enter market API key"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Market API Secret"}),e.jsx(x,{type:"password",value:$,onChange:s=>De(s.target.value),placeholder:"Enter market API secret"})]})]})]}),p==="fivepaisa"&&e.jsxs(N,{className:"bg-blue-50 dark:bg-blue-950 border-blue-200",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx(v,{children:"5paisa API Key Format"}),e.jsxs(w,{children:["Format: ",e.jsx("code",{children:"User_Key:::User_ID:::client_id"})]})]}),p==="flattrade"&&e.jsxs(N,{className:"bg-blue-50 dark:bg-blue-950 border-blue-200",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx(v,{children:"Flattrade API Key Format"}),e.jsxs(w,{children:["Format: ",e.jsx("code",{children:"client_id:::api_key"})]})]}),p==="dhan"&&e.jsxs(N,{className:"bg-blue-50 dark:bg-blue-950 border-blue-200",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx(v,{children:"Dhan API Key Format"}),e.jsxs(w,{children:["Format: ",e.jsx("code",{children:"client_id:::api_key"})]})]}),e.jsx(b,{onClick:bs,disabled:!fs||Le,className:"w-full",children:Le?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Save Broker Credentials"]})})]})]}),r?.server_status&&e.jsxs(d,{children:[e.jsxs(c,{children:[e.jsx(o,{children:"Server Status"}),e.jsx(u,{children:"Running services and their configured ports"})]}),e.jsx(h,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center p-3 bg-muted rounded-lg",children:[e.jsx(j,{variant:"default",className:"mb-2 bg-green-600",children:"Running"}),e.jsx("span",{className:"text-sm font-medium",children:"Flask App"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[r.server_status.flask.host,":",r.server_status.flask.port]})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 bg-muted rounded-lg",children:[e.jsx(j,{variant:"default",className:"mb-2 bg-green-600",children:"Running"}),e.jsx("span",{className:"text-sm font-medium",children:"WebSocket"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[r.server_status.websocket.host,":",r.server_status.websocket.port]})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 bg-muted rounded-lg",children:[e.jsx(j,{variant:"default",className:"mb-2 bg-green-600",children:"Running"}),e.jsx("span",{className:"text-sm font-medium",children:"ZeroMQ"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[r.server_status.zmq.host,":",r.server_status.zmq.port]})]})]})})]}),e.jsxs(d,{children:[e.jsxs(c,{children:[e.jsx(o,{children:"Server Configuration"}),e.jsx(u,{children:"Configure ngrok for receiving webhook alerts from external services like TradingView, Chartink, GoCharting, etc."})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(es,{id:"ngrok_enabled",checked:I,onCheckedChange:s=>Re(s===!0)}),e.jsx(i,{htmlFor:"ngrok_enabled",children:"Enable Ngrok Tunnel"}),I!==r?.ngrok_allow&&e.jsx(j,{variant:"outline",className:"text-yellow-600",children:"Changed"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Host Server URL"}),e.jsx(x,{value:C,onChange:s=>Ie(s.target.value),placeholder:"https://your-domain.ngrok-free.app"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your ngrok domain or custom domain for receiving webhooks."}),C!==r?.host_server&&C&&e.jsxs(j,{variant:"outline",className:"text-yellow-600",children:["Changed from: ",r?.host_server]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"WebSocket URL"}),e.jsx(x,{value:T,onChange:s=>Ue(s.target.value),placeholder:"ws://127.0.0.1:8765"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"WebSocket server URL for real-time market data streaming."}),T!==r?.websocket_url&&T&&e.jsxs(j,{variant:"outline",className:"text-yellow-600",children:["Changed from: ",r?.websocket_url]})]}),e.jsx(b,{onClick:Ns,disabled:!ys||Oe,className:"w-full",children:Oe?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Save Ngrok Settings"]})})]})]})]}),e.jsxs(F,{value:"alerts",className:"space-y-6",children:[e.jsxs(N,{children:[e.jsx(ss,{className:"h-4 w-4"}),e.jsx(v,{children:"Toast Notification Settings"}),e.jsx(w,{children:"Configure how toast notifications appear. Useful for power users running multiple strategies who want to reduce notification spam."})]}),e.jsxs(d,{children:[e.jsxs(c,{children:[e.jsx(o,{children:"Master Controls"}),e.jsx(u,{children:"Enable or disable all toast notifications and sounds"})]}),e.jsxs(h,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(i,{htmlFor:"toasts-enabled",children:"Toast Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Show popup notifications for events"})]}),e.jsx(D,{id:"toasts-enabled",checked:t.toastsEnabled,onCheckedChange:t.setToastsEnabled})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs(i,{htmlFor:"sound-enabled",className:"flex items-center gap-2",children:[t.soundEnabled?e.jsx(Ys,{className:"h-4 w-4"}):e.jsx(Xs,{className:"h-4 w-4"}),"Sound Alerts"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Play audio alert for important events"})]}),e.jsx(D,{id:"sound-enabled",checked:t.soundEnabled,onCheckedChange:t.setSoundEnabled})]})]})]}),e.jsxs(d,{className:t.toastsEnabled?"":"opacity-60",children:[e.jsxs(c,{children:[e.jsx(o,{children:"Display Settings"}),e.jsx(u,{children:"Customize toast appearance and behavior"})]}),e.jsxs(h,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Toast Position"}),e.jsxs(Ye,{value:t.position,onValueChange:s=>t.setPosition(s),disabled:!t.toastsEnabled,children:[e.jsx(Xe,{children:e.jsx(Qe,{placeholder:"Select position"})}),e.jsx(Ze,{children:ma.map(s=>e.jsx(Je,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Maximum Visible Toasts"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(x,{type:"number",min:1,max:10,value:t.maxVisibleToasts,onChange:s=>t.setMaxVisibleToasts(Number(s.target.value)),disabled:!t.toastsEnabled,className:"w-24"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"(1-10) Additional toasts will be queued"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Auto-dismiss Duration"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(x,{type:"number",min:1,max:15,value:t.duration/1e3,onChange:s=>t.setDuration(Number(s.target.value)*1e3),disabled:!t.toastsEnabled,className:"w-24"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"seconds (1-15)"})]})]})]})]}),e.jsxs(d,{className:t.toastsEnabled?"":"opacity-60",children:[e.jsxs(c,{children:[e.jsx(o,{children:"Real-time Notifications"}),e.jsx(u,{children:"High-frequency alerts from Socket.IO events. Disable these to reduce notification spam during active trading."})]}),e.jsx(h,{className:"space-y-4",children:ha.map(s=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b last:border-0",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(i,{htmlFor:`category-${s.key}`,children:s.label}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),e.jsx(D,{id:`category-${s.key}`,checked:t.categories[s.key],onCheckedChange:a=>t.setCategoryEnabled(s.key,a),disabled:!t.toastsEnabled})]},s.key))})]}),e.jsxs(d,{className:t.toastsEnabled?"":"opacity-60",children:[e.jsxs(c,{children:[e.jsx(o,{children:"Trading Operations"}),e.jsx(u,{children:"Notifications from position management, strategies, and Chartink integrations"})]}),e.jsx(h,{className:"space-y-4",children:xa.map(s=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b last:border-0",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(i,{htmlFor:`category-${s.key}`,children:s.label}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),e.jsx(D,{id:`category-${s.key}`,checked:t.categories[s.key],onCheckedChange:a=>t.setCategoryEnabled(s.key,a),disabled:!t.toastsEnabled})]},s.key))})]}),e.jsxs(d,{className:t.toastsEnabled?"":"opacity-60",children:[e.jsxs(c,{children:[e.jsx(o,{children:"Data & Automation"}),e.jsx(u,{children:"Notifications from historical data, Python strategies, and workflow automation"})]}),e.jsx(h,{className:"space-y-4",children:ua.map(s=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b last:border-0",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(i,{htmlFor:`category-${s.key}`,children:s.label}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),e.jsx(D,{id:`category-${s.key}`,checked:t.categories[s.key],onCheckedChange:a=>t.setCategoryEnabled(s.key,a),disabled:!t.toastsEnabled})]},s.key))})]}),e.jsxs(d,{className:t.toastsEnabled?"":"opacity-60",children:[e.jsxs(c,{children:[e.jsx(o,{children:"Admin & Utilities"}),e.jsx(u,{children:"Notifications from admin panel, Telegram bot, monitoring, and clipboard operations"})]}),e.jsx(h,{className:"space-y-4",children:pa.map(s=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b last:border-0",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(i,{htmlFor:`category-${s.key}`,children:s.label}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),e.jsx(D,{id:`category-${s.key}`,checked:t.categories[s.key],onCheckedChange:a=>t.setCategoryEnabled(s.key,a),disabled:!t.toastsEnabled})]},s.key))})]}),e.jsxs(d,{children:[e.jsxs(c,{children:[e.jsx(o,{children:"Actions"}),e.jsx(u,{children:"Test and manage notifications"})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(b,{variant:"outline",onClick:()=>{H.success("This is a test success notification")},disabled:!t.toastsEnabled,children:"Test Toast"}),e.jsx(b,{variant:"outline",onClick:()=>{H.dismiss(),H.success("All notifications cleared")},children:"Clear All Toasts"}),e.jsxs(b,{variant:"outline",onClick:()=>{t.resetToDefaults(),H.success("Settings reset to defaults")},children:[e.jsx(Qs,{className:"h-4 w-4 mr-2"}),"Reset to Defaults"]})]}),e.jsxs("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Current Configuration"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Toasts:"}),e.jsx("span",{children:t.toastsEnabled?"Enabled":"Disabled"}),e.jsx("span",{className:"text-muted-foreground",children:"Sound:"}),e.jsx("span",{children:t.soundEnabled?"Enabled":"Disabled"}),e.jsx("span",{className:"text-muted-foreground",children:"Position:"}),e.jsx("span",{className:"capitalize",children:t.position.replace("-"," ")}),e.jsx("span",{className:"text-muted-foreground",children:"Max Visible:"}),e.jsxs("span",{children:[t.maxVisibleToasts," toasts"]}),e.jsx("span",{className:"text-muted-foreground",children:"Duration:"}),e.jsxs("span",{children:[t.duration/1e3," seconds"]})]})]})]})]}),e.jsxs(d,{children:[e.jsx(c,{children:e.jsx(o,{children:"Understanding Notification Categories"})}),e.jsxs(h,{className:"text-sm text-muted-foreground space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground mb-2",children:"Real-time Notifications (High Priority)"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Orders:"})," BUY/SELL alerts from Socket.IO - highest frequency during trading"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Analyzer:"})," Sandbox mode operations - can spam during paper trading"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"System:"})," Password changes, master contracts - infrequent but important"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Action Center:"})," Semi-auto pending orders - high frequency in managed accounts"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground mb-2",children:"Trading Operations"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Positions:"})," Position close/update notifications"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Strategy:"})," Strategy CRUD, symbol configuration, webhooks"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Chartink:"})," Chartink scanner and strategy integrations"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground mb-2",children:"Data & Automation"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Historify:"})," Historical data jobs, uploads, downloads (67 toasts - highest volume)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Python Strategy:"})," Strategy uploads, execution logs, scheduling"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Flow:"})," Visual workflow execution and management"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground mb-2",children:"Admin & Utilities"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Telegram:"})," Bot operations, broadcasts, user management"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Admin:"})," Market timings, holidays, freeze quantities"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Monitoring:"})," Health, latency, and security dashboards"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Clipboard:"})," Copy-to-clipboard confirmations"]})]})]}),e.jsxs("div",{className:"pt-3 border-t",children:[e.jsx("p",{className:"font-medium text-foreground mb-2",children:"Tips for Power Users"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:["Running 5+ strategies? Set max visible to ",e.jsx("strong",{children:"2-3"})," and duration to ",e.jsx("strong",{children:"2 seconds"})]}),e.jsxs("li",{children:["Disable ",e.jsx("strong",{children:"Analyzer"})," when not paper trading to reduce spam"]}),e.jsxs("li",{children:["Disable ",e.jsx("strong",{children:"Orders"})," if you prefer checking the order book manually"]}),e.jsxs("li",{children:["Disable ",e.jsx("strong",{children:"Historify"})," during large data imports to avoid notification flood"]}),e.jsxs("li",{children:["Keep ",e.jsx("strong",{children:"System"})," enabled for critical security alerts"]})]})]})]})]})]}),e.jsxs(F,{value:"permissions",className:"space-y-6",children:[e.jsxs(N,{children:[e.jsx(as,{className:"h-4 w-4"}),e.jsx(v,{children:"File Permissions Monitor"}),e.jsx(w,{children:"Check file and directory permissions for OpenAlgo components. Incorrect permissions may cause the application to malfunction."})]}),f&&e.jsx(d,{children:e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(o,{className:"flex items-center gap-2",children:["System Status",f.all_correct?e.jsx(j,{className:"bg-green-500",children:"All OK"}):e.jsx(j,{variant:"destructive",children:"Issues Found"})]}),e.jsxs(u,{children:["Platform: ",f.platform,f.is_windows&&" (Windows uses access-based checks)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:Q,disabled:X,children:X?e.jsx(y,{className:"h-4 w-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Refresh"]})}),!f.all_correct&&!f.is_windows&&e.jsx(b,{size:"sm",onClick:js,disabled:He,children:He?e.jsx(y,{className:"h-4 w-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Zs,{className:"h-4 w-4 mr-2"}),"Fix Issues"]})})]})]})})}),X&&!f&&e.jsx(d,{children:e.jsx(h,{className:"py-12 flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{children:"Checking permissions..."})]})})}),f&&e.jsxs(d,{children:[e.jsxs(c,{children:[e.jsx(o,{children:"Permission Details"}),e.jsx(u,{children:"Click on items with issues to see recommended fixes"})]}),e.jsx(h,{children:e.jsx("div",{className:"space-y-2",children:f.checks.map(s=>e.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg border ${s.is_correct?"bg-green-50 dark:bg-green-950/20 border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-950/20 border-red-200 dark:border-red-800"}`,children:[e.jsx("div",{className:"mt-0.5",children:s.is_correct?e.jsx(Js,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):s.exists?e.jsx(ea,{className:"h-5 w-5 text-red-600 dark:text-red-400"}):e.jsx(sa,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium font-mono text-sm",children:s.path}),s.is_sensitive&&e.jsxs(j,{variant:"outline",className:"text-xs",children:[e.jsx(ee,{className:"h-3 w-3 mr-1"}),"Sensitive"]}),s.is_directory&&e.jsx(j,{variant:"outline",className:"text-xs",children:"Directory"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-0.5",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Expected: ",e.jsx("code",{className:"bg-muted px-1 rounded",children:s.expected_mode}),e.jsxs("span",{className:"ml-1 text-muted-foreground/70",children:["(",s.expected_rwx,")"]})]}),s.exists&&s.actual_mode&&e.jsxs("span",{className:s.is_correct?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",children:["Actual: ",e.jsx("code",{className:`px-1 rounded ${s.is_correct?"bg-green-100 dark:bg-green-900":"bg-red-100 dark:bg-red-900"}`,children:s.actual_mode}),e.jsxs("span",{className:"ml-1 opacity-70",children:["(",s.actual_rwx,")"]})]})]}),s.issue&&e.jsxs("div",{className:"mt-2 p-2 bg-red-100 dark:bg-red-900/30 rounded text-sm",children:[e.jsx("p",{className:"text-red-700 dark:text-red-300 font-medium",children:s.issue}),!f.is_windows&&!s.exists&&e.jsx("p",{className:"text-red-600 dark:text-red-400 text-xs mt-1",children:"Fix: Create the directory or file"}),!f.is_windows&&s.exists&&s.actual_mode!==s.expected_mode&&e.jsxs("p",{className:"text-red-600 dark:text-red-400 text-xs mt-1",children:["Fix: ",e.jsxs("code",{className:"bg-red-200 dark:bg-red-800 px-1 rounded",children:["chmod ",s.expected_mode," ",s.path]})]})]}),s.warning&&!s.issue&&e.jsx("div",{className:"mt-2 p-2 bg-yellow-100 dark:bg-yellow-900/30 rounded text-sm",children:e.jsx("p",{className:"text-yellow-700 dark:text-yellow-300 font-medium",children:s.warning})})]})]},s.path))})})]}),e.jsxs(d,{children:[e.jsx(c,{children:e.jsx(o,{children:"Understanding Permissions"})}),e.jsxs(h,{className:"text-sm text-muted-foreground space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Permission Format (Unix/Linux/macOS)"}),e.jsx("p",{children:"Permissions are shown as a 3-digit number (e.g., 755) where:"}),e.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("code",{className:"bg-muted px-1 rounded",children:"7"})," = Read + Write + Execute (rwx)"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-muted px-1 rounded",children:"5"})," = Read + Execute (r-x)"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-muted px-1 rounded",children:"6"})," = Read + Write (rw-)"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-muted px-1 rounded",children:"4"})," = Read only (r--)"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-muted px-1 rounded",children:"0"})," = No permission (---)"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Sensitive Files"}),e.jsxs("p",{children:["Files marked as sensitive (like ",e.jsx("code",{className:"bg-muted px-1 rounded",children:".env"})," and ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"keys/"}),") should have restricted permissions (600 or 700) to prevent unauthorized access."]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Windows"}),e.jsx("p",{children:"On Windows, the system checks if files/directories are readable and writable instead of Unix-style permissions."})]})]})]})]}),e.jsxs(F,{value:"theme",className:"space-y-6",children:[g&&e.jsxs(N,{variant:"destructive",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx(v,{children:"Theme Changes Disabled"}),e.jsx(w,{children:"Theme customization is disabled while in Analyzer Mode. The purple theme is automatically applied for visual distinction. Switch back to Live Mode to change themes."})]}),e.jsx(d,{children:e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Current Theme"}),e.jsx(u,{children:g?"Analyzer Mode (Purple Theme)":`${U.charAt(0).toUpperCase()+U.slice(1)} Mode with ${L.charAt(0).toUpperCase()+L.slice(1)} accent`})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded bg-primary",title:"Primary"}),e.jsx("div",{className:"w-6 h-6 rounded bg-secondary",title:"Secondary"}),e.jsx("div",{className:"w-6 h-6 rounded bg-accent",title:"Accent"}),e.jsx("div",{className:"w-6 h-6 rounded bg-muted",title:"Muted"})]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:Ps,disabled:g||U==="light"&&L==="zinc",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Reset"]})]})]})})}),e.jsxs(d,{className:g?"opacity-60":"",children:[e.jsxs(c,{children:[e.jsx(o,{children:"Theme Mode"}),e.jsx(u,{children:"Choose between light and dark interface"})]}),e.jsx(h,{children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:ca.map(s=>{const a=s.icon,m=U===s.value&&!g;return e.jsxs("button",{type:"button",onClick:()=>Ts(s.value),disabled:g,className:`flex items-start gap-4 p-4 rounded-lg border-2 transition-all text-left ${m?"border-primary bg-primary/5":"border-border hover:border-primary/50"} ${g?"cursor-not-allowed":"cursor-pointer"}`,children:[e.jsx("div",{className:`p-2 rounded-lg ${m?"bg-primary text-primary-foreground":"bg-muted"}`,children:e.jsx(a,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s.label}),m&&e.jsx(ts,{className:"h-4 w-4 text-primary"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.description})]})]},s.value)})})})]}),e.jsxs(d,{className:g?"opacity-60":"",children:[e.jsxs(c,{children:[e.jsx(o,{children:"Accent Color"}),e.jsx(u,{children:"Customize the primary accent color"})]}),e.jsx(h,{children:e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-8 gap-3",children:oa.map(s=>{const a=L===s.value&&!g;return e.jsxs("button",{type:"button",onClick:()=>As(s.value),disabled:g,className:`flex flex-col items-center gap-2 p-3 rounded-lg border-2 transition-all ${a?"border-primary bg-primary/5":"border-border hover:border-primary/50"} ${g?"cursor-not-allowed":"cursor-pointer"}`,title:s.label,children:[e.jsx("div",{className:`w-8 h-8 rounded-full ${s.color} ring-2 ring-offset-2 ring-offset-background ${a?"ring-primary":"ring-transparent"}`}),e.jsx("span",{className:"text-xs font-medium",children:s.label})]},s.value)})})})]}),e.jsxs(d,{children:[e.jsx(c,{children:e.jsx(o,{children:"About Themes"})}),e.jsxs(h,{className:"text-sm text-muted-foreground space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Light Mode:"})," Optimized for daytime use with high contrast and readability."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Dark Mode:"})," Reduces eye strain during extended trading sessions, especially in low-light environments."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Analyzer Mode:"})," When in sandbox/analyzer mode, a distinct purple theme is applied automatically to clearly indicate you are not trading with real funds."]})]})]})]}),e.jsx(F,{value:"smtp",className:"space-y-6",children:e.jsxs(d,{children:[e.jsxs(c,{children:[e.jsx(o,{children:"SMTP Configuration"}),e.jsx(u,{children:"Configure email settings for password reset notifications"})]}),e.jsxs(h,{children:[e.jsxs(N,{className:"mb-6",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx(v,{children:"Gmail Configuration Tips"}),e.jsx(w,{children:e.jsxs("ul",{className:"text-sm list-disc list-inside mt-1 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Personal Gmail:"})," Server: smtp.gmail.com:587"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Password:"})," Use App Password (not your regular password)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Setup:"})," Google Account - Security - 2-Step Verification - App passwords"]})]})})]}),e.jsxs("form",{onSubmit:Ss,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"SMTP Server"}),e.jsx(x,{value:oe,onChange:s=>me(s.target.value),placeholder:"smtp.gmail.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"SMTP Port"}),e.jsx(x,{type:"number",value:he,onChange:s=>xe(s.target.value),placeholder:"587"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"587 (STARTTLS) or 465 (SSL/TLS)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Username/Email"}),e.jsx(x,{type:"email",value:ue,onChange:s=>pe(s.target.value),placeholder:"your-email@gmail.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Password/App Password"}),e.jsx(x,{type:"password",value:G,onChange:s=>ge(s.target.value),placeholder:A?.smtp_settings?.smtp_password?"Password is set (enter new to change)":"Enter your App Password"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"From Email"}),e.jsx(x,{type:"email",value:je,onChange:s=>be(s.target.value),placeholder:"your-email@gmail.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"HELO Hostname"}),e.jsx(x,{value:fe,onChange:s=>ye(s.target.value),placeholder:"smtp.gmail.com"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(es,{id:"smtp_tls",checked:Ne,onCheckedChange:s=>ve(s===!0)}),e.jsx(i,{htmlFor:"smtp_tls",children:"Use TLS/SSL"})]}),e.jsx(b,{type:"submit",disabled:we,children:we?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Save SMTP Settings"]})}),e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Test Configuration"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Send a test email to verify your SMTP settings."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{type:"email",value:W,onChange:s=>Se(s.target.value),placeholder:"Enter email address to test",className:"flex-1"}),e.jsx(b,{type:"button",variant:"outline",onClick:_s,disabled:_e,children:_e?e.jsx(y,{className:"h-4 w-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(ta,{className:"h-4 w-4 mr-1"}),"Send Test"]})}),e.jsx(b,{type:"button",variant:"ghost",onClick:Cs,disabled:Te,children:Te?e.jsx(y,{className:"h-4 w-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(na,{className:"h-4 w-4 mr-1"}),"Debug"]})})]}),P&&e.jsxs(N,{className:`mt-4 ${P.success?"border-green-500":"border-yellow-500"}`,children:[e.jsx(v,{children:P.success?"SMTP Debug Complete":"SMTP Connection Issues"}),e.jsxs(w,{children:[e.jsx("p",{children:P.message}),P.details&&P.details.length>0&&e.jsx("ul",{className:"text-xs mt-2 list-disc list-inside",children:P.details.map((s,a)=>e.jsx("li",{children:s},a))})]})]})]})]})]})]})}),e.jsx(F,{value:"totp",className:"space-y-6",children:e.jsxs(d,{children:[e.jsxs(c,{children:[e.jsx(o,{children:"TOTP Authentication"}),e.jsx(u,{children:"Manage your Two-Factor Authentication settings"})]}),e.jsxs(h,{className:"space-y-6",children:[e.jsxs(N,{children:[e.jsx(rs,{className:"h-4 w-4"}),e.jsx(v,{children:"About TOTP Authentication"}),e.jsx(w,{children:"TOTP (Time-based One-Time Password) provides an additional layer of security. You'll need an authenticator app like Google Authenticator or Authy to generate codes for password recovery."})]}),A?.qr_code&&A?.totp_secret?e.jsxs("div",{className:"bg-muted rounded-lg p-6 space-y-6",children:[e.jsx("h3",{className:"font-semibold text-center",children:"Your TOTP QR Code"}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"p-4 bg-white rounded-lg shadow",children:e.jsx("img",{src:`data:image/png;base64,${A.qr_code}`,alt:"TOTP QR Code",className:"w-48 h-48"})})}),e.jsxs("div",{className:"bg-background rounded-lg p-4 space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"Manual Entry"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Secret key for manual entry:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"flex-1 bg-muted p-2 rounded text-sm break-all",children:A.totp_secret}),e.jsx(b,{size:"icon",variant:"outline",onClick:()=>Es(A.totp_secret),children:e.jsx(ia,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium",children:"Setup Instructions:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-muted-foreground",children:[e.jsx("li",{children:"Install an authenticator app (Google Authenticator, Authy, etc.)"}),e.jsx("li",{children:"Scan the QR code above or enter the secret key manually"}),e.jsx("li",{children:"Save your backup codes in a safe place"}),e.jsx("li",{children:"You'll need the TOTP code to reset your password if you forget it"})]})]})]}):e.jsxs(N,{variant:"destructive",children:[e.jsx(v,{children:"TOTP Not Available"}),e.jsx(w,{children:"Unable to load TOTP setup. Please contact your administrator."})]})]})]})})]}),e.jsx(Rs,{open:xs,onOpenChange:z,children:e.jsxs(Is,{children:[e.jsxs(Us,{children:[e.jsxs(Ls,{className:"flex items-center gap-2",children:[e.jsx(la,{className:"h-5 w-5 text-yellow-500"}),"Restart Required"]}),e.jsxs(Bs,{className:"space-y-3",children:[e.jsxs("p",{children:["Your configuration has been saved to the ",e.jsx("code",{className:"bg-muted px-1 rounded",children:".env"})," file."]}),e.jsx("p",{children:"To apply these changes, please restart the OpenAlgo application using your usual method (terminal, service manager, or container orchestrator)."})]})]}),e.jsx(Os,{children:e.jsx($s,{onClick:()=>z(!1),children:"Got it"})})]})})]})}export{Fa as default};
