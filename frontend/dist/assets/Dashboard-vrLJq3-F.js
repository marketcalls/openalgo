import{r as o,j as e}from"./vendor-react-CCyQGCED.js";import{o as F,c,e as g}from"./index-D0023jFM.js";import{C as m,d as x}from"./card-CDguRyHx.js";import{S,F as A,p as I,i as P,v as T,Z as z}from"./vendor-icons-CCn_k3dF.js";import{L as j}from"./vendor-router-Dzc1xxhr.js";import"./vendor-charts-l0_txfiz.js";import"./vendor-radix-CYVJEJRR.js";function h(t){const a=typeof t=="string"?parseFloat(t):t;if(Number.isNaN(a))return"0.00";const i=a<0,n=Math.abs(a);let l;return n>=1e7?l=`${(n/1e7).toFixed(2)}Cr`:n>=1e5?l=`${(n/1e5).toFixed(2)}L`:l=n.toFixed(2),i?`-${l}`:l}function y(t){const a=typeof t=="string"?parseFloat(t):t;return a>0?"text-green-600 dark:text-green-400":a<0?"text-red-600 dark:text-red-400":"text-foreground"}function N(t){const a=typeof t=="string"?parseFloat(t):t;return a>0?"default":a<0?"destructive":"secondary"}function Z(){const[t,a]=o.useState(null),[i,n]=o.useState(!0),[l,f]=o.useState(null),[d,p]=o.useState({status:"pending"}),[C,k]=o.useState(!0),u=o.useCallback(async()=>{try{n(!0);const r=await fetch("/auth/dashboard-data",{credentials:"include"});if(r.status===401){k(!1),n(!1);return}const s=await r.json();s.status==="success"&&s.data?(a(s.data),f(null)):f(s.message||"Failed to fetch margin data")}catch{f("Failed to fetch margin data")}finally{n(!1)}},[]);o.useEffect(()=>{u();const r=setInterval(u,3e4);return()=>clearInterval(r)},[u]),o.useEffect(()=>{const r=F(()=>{u()});return()=>r()},[u]);const b=o.useCallback(async()=>{try{const r=await fetch("/api/master-contract/status",{credentials:"include",headers:{Accept:"application/json"}});if(r.status===401)return;const s=await r.json();p(s)}catch{p({status:"error",message:"Failed to check status"})}},[]);o.useEffect(()=>{b();const r=setInterval(()=>{p(s=>(s.status==="success"||b(),s))},5e3);return()=>clearInterval(r)},[b]);const w=()=>{switch(d.status){case"success":return"bg-green-500";case"downloading":return"bg-yellow-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-400 animate-pulse"}},M=()=>{switch(d.status){case"success":return d.total_symbols?`Ready (${d.total_symbols} symbols)`:"Ready";case"downloading":return"Downloading...";case"error":return"Error";default:return"Checking..."}},L=()=>{switch(d.status){case"success":return"text-green-600 dark:text-green-400";case"downloading":return"text-yellow-600 dark:text-yellow-400";case"error":return"text-red-600 dark:text-red-400";default:return"text-muted-foreground"}},B=[{href:"/search",label:"OpenAlgo Symbols",description:"Universal symbology across brokers",icon:S,gradient:"from-primary/10 to-primary/5 hover:from-primary/20 hover:to-primary/10",iconBg:"bg-primary/20",iconColor:"text-primary",borderColor:"border-primary/20 hover:border-primary/40"},{href:"/logs",label:"Live Logs",description:"Real-time trading activity logs",icon:A,gradient:"from-violet-500/10 to-violet-500/5 hover:from-violet-500/20 hover:to-violet-500/10",iconBg:"bg-violet-500/20",iconColor:"text-violet-500",borderColor:"border-violet-500/20 hover:border-violet-500/40"},{href:"https://docs.openalgo.in",label:"Documentation",description:"Tutorials, API docs & features",icon:I,gradient:"from-cyan-500/10 to-cyan-500/5 hover:from-cyan-500/20 hover:to-cyan-500/10",iconBg:"bg-cyan-500/20",iconColor:"text-cyan-500",borderColor:"border-cyan-500/20 hover:border-cyan-500/40",external:!0},{href:"/pnl-tracker",label:"P&L Tracker",description:"Live intraday MTM tracker",icon:P,gradient:"from-green-500/10 to-green-500/5 hover:from-green-500/20 hover:to-green-500/10",iconBg:"bg-green-500/20",iconColor:"text-green-500",borderColor:"border-green-500/20 hover:border-green-500/40"},{href:"/telegram",label:"Telegram Alerts",description:"Configure telegram notifications",icon:T,gradient:"from-blue-500/10 to-blue-500/5 hover:from-blue-500/20 hover:to-blue-500/10",iconBg:"bg-blue-500/20",iconColor:"text-blue-500",borderColor:"border-blue-500/20 hover:border-blue-500/40"},{href:"/logs/latency",label:"Latency Monitor",description:"Monitor order & API latency",icon:z,gradient:"from-orange-500/10 to-orange-500/5 hover:from-orange-500/20 hover:to-orange-500/10",iconBg:"bg-orange-500/20",iconColor:"text-orange-500",borderColor:"border-orange-500/20 hover:border-orange-500/40"}];return C?e.jsxs("div",{className:"space-y-6 md:space-y-12",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:"Trading Dashboard"}),e.jsx("p",{className:"text-muted-foreground mt-1 md:mt-2 text-sm md:text-base",children:"Overview of your trading account and market positions"})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-3 bg-muted rounded-lg px-3 md:px-4 py-2 md:py-3 w-fit lg:ml-auto lg:self-start",children:[e.jsx("span",{className:"text-xs md:text-sm font-medium whitespace-nowrap",children:"Master Contract:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:c("w-2.5 h-2.5 md:w-3 md:h-3 rounded-full",w())}),e.jsx("span",{className:c("text-xs md:text-sm",L()),title:d.message,children:M()})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-5 gap-4 md:gap-6",children:[e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Available Balance"}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:i?"...":t?h(t.availablecash):"0.00"}),e.jsx(g,{variant:"secondary",className:"mt-2",children:"Cash Balance"})]})})}),e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Collateral"}),e.jsx("p",{className:"text-2xl font-bold text-violet-500 dark:text-violet-400",children:i?"...":t?h(t.collateral):"0.00"}),e.jsx(g,{variant:"secondary",className:"mt-2",children:"Total Collateral"})]})})}),e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Unrealized P&L"}),e.jsx("p",{className:c("text-2xl font-bold",t?y(t.m2munrealized):""),children:i?"...":t?h(t.m2munrealized):"0.00"}),e.jsx(g,{variant:t?N(t.m2munrealized):"secondary",className:"mt-2",children:"Mark to Market"})]})})}),e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Realized P&L"}),e.jsx("p",{className:c("text-2xl font-bold",t?y(t.m2mrealized):""),children:i?"...":t?h(t.m2mrealized):"0.00"}),e.jsx(g,{variant:t?N(t.m2mrealized):"secondary",className:"mt-2",children:"Booked P&L"})]})})}),e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Utilised Margin"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-500 dark:text-cyan-400",children:i?"...":t?h(t.utiliseddebits):"0.00"}),e.jsx(g,{variant:"outline",className:"mt-2 border-cyan-500/50 text-cyan-600 dark:text-cyan-400",children:"Used Margin"})]})})})]}),l&&e.jsx(m,{className:"border-destructive bg-destructive/5",children:e.jsx(x,{className:"pt-6",children:e.jsx("p",{className:"text-destructive text-sm",children:l})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl md:text-2xl font-semibold mb-4 md:mb-6",children:"Quick Access"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 md:gap-5",children:B.map(r=>{const s=c("block rounded-lg border transition-all duration-300 hover:shadow-lg",`bg-gradient-to-br ${r.gradient}`,r.borderColor),v=e.jsx("div",{className:"p-4 md:p-5",children:e.jsxs("div",{className:"flex items-start gap-3 md:gap-4",children:[e.jsx("div",{className:c("p-2.5 md:p-3 rounded-lg flex-shrink-0",r.iconBg),children:e.jsx(r.icon,{className:c("h-5 w-5 md:h-6 md:w-6",r.iconColor)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold mb-1 text-base md:text-lg",children:r.label}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]})]})});return r.external?e.jsx("a",{href:r.href,target:"_blank",rel:"noopener noreferrer",className:s,children:v},r.href):e.jsx(j,{to:r.href,className:s,children:v},r.href)})})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[50vh] space-y-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Session Expired"}),e.jsx("p",{className:"text-muted-foreground",children:"Please log in to access the dashboard."}),e.jsx(j,{to:"/login",className:"text-primary hover:underline",children:"Go to Login"})]})}export{Z as default};
