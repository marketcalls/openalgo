import{r as n,j as e}from"./vendor-react-RhKMXzW9.js";import{B as p,e as t}from"./index-DIYLftG1.js";import{C as d,b as j,c as u,a as c}from"./card-QZ1-djoA.js";import{D as $,b as J,c as P,d as V}from"./dialog-Ldu0SwYW.js";import{I as S}from"./input-BHNumB0b.js";import{L as C}from"./label-CCs3mRQE.js";import{T as X,a as M,b as g,c as l,d as G,e as r}from"./table-CK4hMSU8.js";import{J as _}from"./json-editor-D48tyMHD.js";import{am as Y,p as q,al as K,T as E,g as Q,an as W,v as Z,t as ee}from"./vendor-icons-Ca5eNZvr.js";import"./vendor-router-DdyOoyPF.js";import"./vendor-radix-gKv__6YA.js";const se={NSE:"bg-cyan-500/10 text-cyan-600 border-cyan-500/30",NFO:"bg-purple-500/10 text-purple-600 border-purple-500/30",CDS:"bg-blue-500/10 text-blue-600 border-blue-500/30",BSE:"bg-gray-500/10 text-gray-600 border-gray-500/30",BFO:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",BCD:"bg-red-500/10 text-red-600 border-red-500/30",MCX:"bg-primary/10 text-primary border-primary/30",NCDEX:"bg-green-500/10 text-green-600 border-green-500/30"};function he(){const[f,R]=n.useState(null),[T,b]=n.useState(!0),[o,z]=n.useState(""),[x,O]=n.useState(""),[m,A]=n.useState(null),[B,y]=n.useState(!1);n.useEffect(()=>{N()},[]);const N=async(s,a)=>{b(!0);try{const i=new URLSearchParams;s&&i.append("start_date",s),a&&i.append("end_date",a);const U=i.toString()?`/analyzer/api/data?${i}`:"/analyzer/api/data",w=await fetch(U,{credentials:"include"});if(w.ok){const D=await w.json();D.status==="success"&&R(D.data)}}catch(i){console.error("Error fetching analyzer data:",i)}finally{b(!1)}},F=s=>{s.preventDefault(),N(o,x)},L=()=>{const s=new URLSearchParams;o&&s.append("start_date",o),x&&s.append("end_date",x);const a=s.toString()?`/analyzer/export?${s}`:"/analyzer/export";window.location.href=a},I=s=>{A(s),y(!0)},k=s=>{if(s.api_type==="cancelorder")return`OrderID: ${s.orderid}`;let a=s.symbol||"";return s.quantity&&(a+=` (${s.quantity})`),s.api_type==="placesmartorder"&&s.position_size&&(a+=` [Size: ${s.position_size}]`),a},H=s=>{const a={...s};return delete a.apikey,a};if(T)return e.jsx("div",{className:"container mx-auto py-8 px-4 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const h=f?.stats||{total_requests:0,issues:{total:0},symbols:[],sources:[]},v=f?.requests||[];return e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Sandbox Request Monitor"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Review and validate your sandbox API requests before going live"})]}),e.jsxs("form",{onSubmit:F,className:"flex flex-wrap gap-4 items-end mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"start_date",children:"Start Date"}),e.jsx(S,{id:"start_date",type:"date",value:o,onChange:s=>z(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"end_date",children:"End Date"}),e.jsx(S,{id:"end_date",type:"date",value:x,onChange:s=>O(s.target.value)})]}),e.jsxs(p,{type:"submit",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Filter"]}),e.jsxs(p,{type:"button",variant:"secondary",onClick:L,children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Export to CSV"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsxs(d,{children:[e.jsx(j,{className:"pb-2",children:e.jsxs(u,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),"Total Requests"]})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:h.total_requests}),e.jsx(t,{className:"mt-1",children:"Last 24 hours"})]})]}),e.jsxs(d,{children:[e.jsx(j,{className:"pb-2",children:e.jsxs(u,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"Issues Found"]})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-500",children:h.issues.total}),e.jsx(t,{variant:"secondary",className:"mt-1",children:"Needs Attention"})]})]}),e.jsxs(d,{children:[e.jsx(j,{className:"pb-2",children:e.jsxs(u,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"Unique Symbols"]})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold",children:h.symbols.length}),e.jsx(t,{variant:"outline",className:"mt-1",children:"Tracked"})]})]}),e.jsxs(d,{children:[e.jsx(j,{className:"pb-2",children:e.jsxs(u,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4"}),"Active Sources"]})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold",children:h.sources.length}),e.jsx(t,{variant:"outline",className:"mt-1",children:"Connected"})]})]})]}),e.jsx(d,{children:e.jsx(c,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(X,{children:[e.jsx(M,{children:e.jsxs(g,{children:[e.jsx(l,{children:"Timestamp"}),e.jsx(l,{children:"API Type"}),e.jsx(l,{children:"Source"}),e.jsx(l,{children:"Details"}),e.jsx(l,{children:"Exchange"}),e.jsx(l,{children:"Action"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"View"})]})}),e.jsx(G,{children:v.length===0?e.jsx(g,{children:e.jsx(r,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No requests found"})}):v.map((s,a)=>e.jsxs(g,{className:"hover:bg-muted/50",children:[e.jsx(r,{className:"text-sm",children:s.timestamp}),e.jsx(r,{children:e.jsx(t,{variant:"default",children:s.api_type})}),e.jsx(r,{children:e.jsx(t,{variant:"secondary",className:"truncate max-w-[120px]",children:s.source})}),e.jsx(r,{className:"font-medium",children:k(s)}),e.jsx(r,{children:s.exchange&&e.jsx(t,{className:se[s.exchange]||"",variant:"outline",children:s.exchange})}),e.jsx(r,{children:s.action&&e.jsx(t,{variant:s.action==="BUY"?"default":"destructive",children:s.action})}),e.jsx(r,{children:s.analysis.issues?e.jsxs(t,{variant:"secondary",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",children:[e.jsx(E,{className:"h-3 w-3 mr-1"}),"Error"]}):e.jsxs(t,{variant:"secondary",className:"bg-green-500/10 text-green-600 border-green-500/30",children:[e.jsx(Z,{className:"h-3 w-3 mr-1"}),"Success"]})}),e.jsx(r,{children:e.jsxs(p,{size:"sm",onClick:()=>I(s),children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),"View"]})})]},a))})]})})})}),e.jsx($,{open:B,onOpenChange:y,children:e.jsxs(J,{className:"max-w-7xl",children:[e.jsx(P,{children:e.jsx(V,{children:"Request Details"})}),m&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Request Data"}),e.jsx("div",{className:"rounded-lg overflow-hidden border bg-card/50 h-[400px]",children:e.jsx(_,{value:JSON.stringify(H(m.request_data),null,2),readOnly:!0})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Response Data"}),e.jsx("div",{className:"rounded-lg overflow-hidden border bg-card/50 h-[400px]",children:e.jsx(_,{value:JSON.stringify(m.response_data||m.analysis,null,2),readOnly:!0})})]})]})]})})]})}export{he as default};
