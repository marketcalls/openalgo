import{r,j as e}from"./vendor-react-CCyQGCED.js";import{B as t,e as a,s as n}from"./index-NHrG-O_Z.js";import{c as U}from"./chartink-BPDHJ2xG.js";import{A as p,b as f,a as N}from"./alert-BoGaKMRC.js";import{C as l,d as c,a as v,b as w,c as k}from"./card-Cn20bp_v.js";import{S as o}from"./skeleton-BWYif6yq.js";import{Y as T,aI as b,T as O,aW as A,Z as B,V as H,m as I,a7 as W,k as V,x as $}from"./vendor-icons-CCn_k3dF.js";import{a as Y,L as C}from"./vendor-router-Dzc1xxhr.js";import"./vendor-charts-l0_txfiz.js";import"./vendor-radix-CYVJEJRR.js";function Q(){const d=Y(),[m,y]=r.useState([]),[S,h]=r.useState(!0),[R,x]=r.useState(null),[j,u]=r.useState(null),g=async()=>{try{h(!0);const s=await U.getStrategies();y(s)}catch{n.error("Failed to load Chartink strategies","chartink")}finally{h(!1)}};r.useEffect(()=>{(async()=>{try{const L=await(await fetch("/api/config/host",{credentials:"include"})).json();u(L)}catch{u({host_server:window.location.origin,is_localhost:window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"})}})()},[]),r.useEffect(()=>{g()},[]);const _=s=>`${j?.host_server||window.location.origin}/chartink/webhook/${s}`,E=async s=>{const i=_(s);try{await navigator.clipboard.writeText(i),x(s),n.success("Webhook URL copied to clipboard","clipboard"),setTimeout(()=>x(null),2e3)}catch{n.error("Failed to copy URL","clipboard")}};return S?e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(o,{className:"h-8 w-48"}),e.jsx(o,{className:"h-10 w-32"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(s=>e.jsx(o,{className:"h-48"},s))})]}):e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Chartink Strategies"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your Chartink webhook integrations"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(t,{variant:"outline",size:"sm",onClick:g,children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(t,{onClick:()=>d("/chartink/new"),children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"New Strategy"]})]})]}),j?.is_localhost&&e.jsxs(p,{variant:"destructive",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx(f,{children:"Webhook URL not accessible!"}),e.jsxs(N,{children:["Chartink cannot send alerts to localhost. Use ",e.jsx("strong",{children:"ngrok"}),","," ",e.jsx("strong",{children:"Cloudflare Tunnel"}),", ",e.jsx("strong",{children:"VS Code Dev Tunnel"}),", or a"," ",e.jsx("strong",{children:"custom domain"})," to expose your OpenAlgo instance to the internet. Update ",e.jsx("code",{children:"HOST_SERVER"})," in your ",e.jsx("code",{children:".env"})," file with your external URL."]})]}),e.jsxs(p,{children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx(f,{children:"Chartink Webhook"}),e.jsxs(N,{children:["Receive alerts from Chartink screeners. Use these keywords in your alert name:",e.jsx("code",{className:"bg-muted px-1 mx-1 rounded",children:"BUY"}),",",e.jsx("code",{className:"bg-muted px-1 mx-1 rounded",children:"SELL"}),",",e.jsx("code",{className:"bg-muted px-1 mx-1 rounded",children:"SHORT"}),",",e.jsx("code",{className:"bg-muted px-1 mx-1 rounded",children:"COVER"})]})]}),m.length===0?e.jsx(l,{className:"py-12",children:e.jsxs(c,{className:"flex flex-col items-center justify-center text-center",children:[e.jsx(B,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Chartink Strategies"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Create your first Chartink strategy to receive screener alerts."}),e.jsxs(t,{onClick:()=>d("/chartink/new"),children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Create Strategy"]})]})}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:m.map(s=>e.jsxs(l,{className:"relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 left-0 right-0 h-1 ${s.is_active?"bg-green-500":"bg-gray-300 dark:bg-gray-600"}`}),e.jsx(v,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(w,{className:"text-lg",children:s.name}),e.jsx(k,{children:"Chartink"})]}),e.jsx(a,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"})]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a,{variant:"outline",className:"font-normal",children:s.is_intraday?"Intraday":"Positional"}),e.jsx(a,{variant:"outline",className:"font-normal",children:"NSE/BSE Only"})]}),s.is_intraday&&s.start_time&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.start_time," - ",s.end_time,s.squareoff_time&&` (SqOff: ${s.squareoff_time})`]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(t,{variant:"outline",size:"sm",className:"flex-1 justify-start text-xs font-mono truncate",onClick:()=>E(s.webhook_id),children:[R===s.webhook_id?e.jsx(I,{className:"h-3 w-3 mr-2 text-green-500"}):e.jsx(W,{className:"h-3 w-3 mr-2"}),e.jsxs("span",{className:"truncate",children:[".../",s.webhook_id.slice(0,8),"..."]})]})}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(t,{variant:"outline",size:"sm",className:"flex-1",asChild:!0,children:e.jsxs(C,{to:`/chartink/${s.id}/configure`,children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Symbols"]})}),e.jsx(t,{variant:"default",size:"sm",className:"flex-1",asChild:!0,children:e.jsxs(C,{to:`/chartink/${s.id}`,children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"View"]})})]})]})]},s.id))}),e.jsxs(l,{children:[e.jsxs(v,{children:[e.jsx(w,{className:"text-lg",children:"Alert Keywords Reference"}),e.jsx(k,{children:"Include these keywords in your Chartink alert name to trigger orders"})]}),e.jsxs(c,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(a,{className:"bg-green-500",children:"BUY"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Open long position"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(a,{className:"bg-red-500",children:"SELL"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Close long position"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(a,{className:"bg-orange-500",children:"SHORT"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Open short position"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(a,{className:"bg-blue-500",children:"COVER"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Close short position"})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm",children:e.jsx("strong",{children:"Example Alert Names:"})}),e.jsxs("ul",{className:"text-sm text-muted-foreground mt-2 space-y-1",children:[e.jsx("li",{children:'• "BUY - RSI Oversold Stocks" → triggers BUY orders'}),e.jsx("li",{children:'• "SELL Signal - Moving Average Cross" → triggers SELL orders'}),e.jsx("li",{children:'• "SHORT - Bearish Breakout" → triggers SHORT orders'})]})]})]})]})]})}export{Q as default};
