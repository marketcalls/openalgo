import{r as i,j as e}from"./vendor-react-RhKMXzW9.js";import{t as h,B as d,c as v,e as $}from"./index-DJwClDQW.js";import{I as ne}from"./input-Bq8Eye_d.js";import{S as Oe}from"./scroll-area-D4nOsGv8.js";import{T as ie,a as re,b as q,c as J}from"./tabs-nq2B-S21.js";import{j as Re,X as Ee,ay as Ae,J as Be,K as H,S as Ie,w as Le,V as Pe,E as qe,s as Je,a0 as le,R as ce,a4 as oe,N as Ue,D as Ke,am as De}from"./vendor-icons-2oyLmcSr.js";import{L as V}from"./vendor-router-DdyOoyPF.js";import"./vendor-syntax-D6hV6JR3.js";import"./vendor-radix-B_grJx4K.js";async function Fe(){return(await(await fetch("/auth/csrf-token",{credentials:"include"})).json()).csrf_token}function Ge(n){if(n.length>100*1024)return[{text:n,type:"plain"}];const c=[],f=/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?)/g;let u=0,x=f.exec(n);for(;x!==null;){x.index>u&&c.push({text:n.slice(u,x.index),type:"plain"});const g=x[0];let j="number";/^"/.test(g)?j=/:$/.test(g)?"key":"string":/true|false/.test(g)?j="boolean":/null/.test(g)&&(j="null"),c.push({text:g,type:j}),u=f.lastIndex,x=f.exec(n)}return u<n.length&&c.push({text:n.slice(u),type:"plain"}),c}function $e(n){switch(n){case"key":return"text-sky-400";case"string":return"text-emerald-400";case"number":return"text-orange-400";case"boolean":return"text-purple-400";case"null":return"text-red-400";default:return""}}function He(n){if(n.startsWith("/api/")||n.startsWith("/playground/"))return{valid:!0};try{const c=new URL(n,window.location.origin);return c.origin!==window.location.origin?{valid:!1,error:"Only same-origin requests are allowed"}:!c.pathname.startsWith("/api/")&&!c.pathname.startsWith("/playground/")?{valid:!1,error:"Only /api/ and /playground/ endpoints are allowed"}:{valid:!0}}catch{return{valid:!1,error:"Invalid URL format"}}}function ss(){const[n,c]=i.useState(""),[f,u]=i.useState(!1),[x,g]=i.useState({}),[j,de]=i.useState(new Set),[B,xe]=i.useState(""),[S,U]=i.useState([]),[k,C]=i.useState(null),[b,T]=i.useState("POST"),[p,O]=i.useState(""),[o,z]=i.useState(""),[K,D]=i.useState(!1),[y,R]=i.useState(null),[W,I]=i.useState(null),[_,F]=i.useState(null),[w,E]=i.useState(null),[M,X]=i.useState({}),[Q,he]=i.useState(!0),pe=i.useRef(null);i.useEffect(()=>{me(),fe()},[]);const me=async()=>{try{const s=await fetch("/playground/api-key",{credentials:"include"});if(s.ok){const t=await s.json();c(t.api_key||"")}}catch{}},fe=async()=>{try{const s=await fetch("/playground/endpoints",{credentials:"include"});if(s.ok){const t=await s.json();g(t)}}catch{h.error("Failed to load endpoints")}},Z=i.useCallback(s=>{let t={};return s.method==="GET"&&s.params?t={...s.params}:s.body&&(t={...s.body}),n&&!t.apikey&&(t.apikey=n),JSON.stringify(t,null,2)},[n]),Y=s=>{const t=S.find(a=>a.endpoint.path===s.path);if(t)C(t.id),T(t.endpoint.method),O(t.endpoint.path),z(t.requestBody);else{const a={id:`${s.path}-${Date.now()}`,endpoint:s,requestBody:Z(s),modified:!1};U(r=>[...r,a]),C(a.id),T(s.method),O(s.path),z(a.requestBody)}E(null),R(null),I(null),F(null)},ue=(s,t)=>{t.stopPropagation();const a=S.findIndex(l=>l.id===s),r=S.filter(l=>l.id!==s);if(U(r),k===s)if(r.length>0){const l=Math.min(a,r.length-1),m=r[l];C(m.id),T(m.endpoint.method),O(m.endpoint.path),z(m.requestBody)}else C(null),T("POST"),O(""),z("")},ge=s=>{C(s.id),T(s.endpoint.method),O(s.endpoint.path),z(s.requestBody),E(null),R(null)},ee=s=>{z(s),k&&U(t=>t.map(a=>a.id===k?{...a,requestBody:s,modified:s!==Z(a.endpoint)}:a))},je=s=>{de(t=>{const a=new Set(t);return a.has(s)?a.delete(s):a.add(s),a})},be=()=>{try{const s=JSON.parse(o),t=JSON.stringify(s,null,2);ee(t),h.success("JSON prettified")}catch{h.error("Invalid JSON - cannot prettify")}},Ne=async()=>{if(!p){h.warning("Please select an endpoint");return}const s=He(p);if(!s.valid){h.error(s.error);return}D(!0),E(null),R(null),I(null),F(null),X({});const t=Date.now();try{const a={method:b,credentials:"include",headers:{Accept:"application/json"}};let r=p;if(b==="GET"){if(o.trim())try{const A=JSON.parse(o),L=new URL(p,window.location.origin);Object.entries(A).forEach(([Te,P])=>{P!=null&&P!==""&&L.searchParams.append(Te,String(P))}),r=L.toString()}catch{h.error("Invalid JSON for query parameters"),D(!1);return}}else{const A=await Fe();a.headers["Content-Type"]="application/json",a.headers["X-CSRFToken"]=A,o.trim()&&(a.body=o)}const l=await fetch(r,a),m=Date.now()-t,N={};l.headers.forEach((A,L)=>{N[L]=A}),X(N);let G;const te=l.headers.get("content-type");te?.includes("application/json")?G=await l.json():G={text:await l.text(),contentType:te};const ae=JSON.stringify(G,null,2);R(l.status),I(m),F(new Blob([ae]).size),E(ae)}catch(a){const r=Date.now()-t;R(0),I(r),E(JSON.stringify({error:a instanceof Error?a.message:"Unknown error"},null,2))}finally{D(!1)}},ve=()=>{w&&(navigator.clipboard.writeText(w),h.success("Response copied!"))},ze=()=>{n&&(navigator.clipboard.writeText(n),h.success("API key copied!"))},ye=()=>{if(!p)return;let s=p;if(b==="GET"&&o.trim())try{const r=JSON.parse(o),l=new URL(p,window.location.origin);Object.entries(r).forEach(([m,N])=>{N!=null&&N!==""&&l.searchParams.append(m,String(N))}),s=l.toString()}catch{h.error("Invalid JSON for query parameters");return}const t=new URL(s,window.location.origin).href;let a=`curl -X ${b} "${t}"`;a+=` \\
  -H "Accept: application/json"`,b!=="GET"&&o.trim()&&(a+=` \\
  -H "Content-Type: application/json"`,a+=` \\
  -d '${o.replace(/'/g,"'\\''")}'`),navigator.clipboard.writeText(a),h.success("Copied as cURL")},we=Object.entries(x).reduce((s,[t,a])=>{if(!B)s[t]=a;else{const r=a.filter(l=>l.name.toLowerCase().includes(B.toLowerCase())||l.path.toLowerCase().includes(B.toLowerCase()));r.length&&(s[t]=r)}return s},{}),Se=s=>s?s>=200&&s<300?"text-emerald-400":s>=400?"text-red-400":"text-yellow-400":"text-zinc-500",ke=s=>s?s>=200&&s<300?"bg-emerald-500/10":s>=400?"bg-red-500/10":"bg-yellow-500/10":"bg-zinc-500/10",Ce=s=>s>=1024?`${(s/1024).toFixed(1)}KB`:`${s}B`,se=S.find(s=>s.id===k);return e.jsxs("div",{className:"h-full flex flex-col bg-zinc-950 text-zinc-100",children:[e.jsxs("div",{className:"h-12 border-b border-zinc-800 flex items-center px-2 bg-zinc-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{variant:"ghost",size:"icon",className:"h-8 w-8 text-zinc-400 hover:text-zinc-100 hover:bg-zinc-800",onClick:()=>he(!Q),children:e.jsx(Re,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-2 px-2",children:[e.jsx("img",{src:"/images/android-chrome-192x192.png",alt:"OpenAlgo",className:"w-6 h-6"}),e.jsx("span",{className:"font-semibold text-sm",children:"openalgo"})]})]}),e.jsxs("div",{className:"flex-1 flex items-center gap-1 px-4 overflow-x-auto",children:[S.map(s=>e.jsxs("div",{className:v("flex items-center gap-2 px-3 py-1.5 rounded-md text-xs cursor-pointer group","hover:bg-zinc-800",s.id===k?"bg-zinc-800 text-zinc-100":"text-zinc-400"),onClick:()=>ge(s),children:[e.jsx($,{variant:"outline",className:v("text-[9px] px-1 py-0 h-4 border-0 font-semibold",s.endpoint.method==="GET"?"bg-sky-500/20 text-sky-400":"bg-emerald-500/20 text-emerald-400"),children:s.endpoint.method}),e.jsx("span",{className:"truncate max-w-[100px]",children:s.endpoint.name}),s.modified&&e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-amber-500"}),e.jsx("button",{type:"button",className:"opacity-0 group-hover:opacity-100 hover:text-zinc-100 p-0.5 -mr-1",onClick:t=>ue(s.id,t),children:e.jsx(Ee,{className:"h-3 w-3"})})]},s.id)),e.jsx(d,{variant:"ghost",size:"icon",className:"h-6 w-6 text-zinc-500 hover:text-zinc-100 hover:bg-zinc-800",onClick:()=>{const s=Object.keys(x)[0];s&&x[s]?.[0]&&Y(x[s][0])},children:e.jsx(Ae,{className:"h-3.5 w-3.5"})})]}),e.jsxs("div",{className:"flex items-center gap-2 px-2",children:[e.jsx(d,{variant:"ghost",size:"sm",className:"h-7 text-xs text-zinc-400 hover:text-zinc-100 hover:bg-zinc-800",asChild:!0,children:e.jsxs(V,{to:"/dashboard",children:[e.jsx(Be,{className:"h-3.5 w-3.5 mr-1.5"}),"Dashboard"]})}),e.jsx(d,{variant:"ghost",size:"sm",className:"h-7 text-xs text-zinc-400 hover:text-zinc-100 hover:bg-zinc-800",asChild:!0,children:e.jsxs(V,{to:"/apikey",children:[e.jsx(H,{className:"h-3.5 w-3.5 mr-1.5"}),"API Keys"]})})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:v("w-56 border-r border-zinc-800 bg-zinc-900/30 flex flex-col overflow-hidden","transition-all duration-200",Q?"translate-x-0":"-translate-x-full absolute h-full z-50"),children:[e.jsx("div",{className:"p-2 border-b border-zinc-800 shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ie,{className:"h-3.5 w-3.5 absolute left-2.5 top-1/2 -translate-y-1/2 text-zinc-500"}),e.jsx(ne,{placeholder:"search",className:"h-7 pl-8 text-xs bg-zinc-800/50 border-zinc-700 text-zinc-100 placeholder:text-zinc-500",value:B,onChange:s=>xe(s.target.value)})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:e.jsx("div",{className:"p-2",children:Object.entries(we).map(([s,t])=>e.jsxs("div",{className:"mb-2",children:[e.jsxs("button",{type:"button",className:"flex items-center gap-1.5 w-full px-2 py-1 rounded text-[11px] font-medium uppercase tracking-wider text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800/50",onClick:()=>je(s),children:[j.has(s)?e.jsx(Le,{className:"h-3 w-3"}):e.jsx(Pe,{className:"h-3 w-3"}),s]}),!j.has(s)&&e.jsx("div",{className:"mt-0.5 space-y-0.5",children:t.map((a,r)=>e.jsxs("button",{type:"button",className:v("w-full flex items-center gap-2 px-2 py-1 rounded text-left text-xs hover:bg-zinc-800/50",se?.endpoint.path===a.path&&"bg-zinc-800 text-zinc-100"),onClick:()=>Y(a),children:[e.jsx($,{variant:"outline",className:v("text-[9px] px-1 py-0 h-4 border-0 font-semibold shrink-0",a.method==="GET"?"bg-sky-500/20 text-sky-400":"bg-emerald-500/20 text-emerald-400"),children:a.method}),e.jsx("span",{className:"truncate text-zinc-300",children:a.name})]},r))})]},s))})}),e.jsx("div",{className:"p-2 border-t border-zinc-800 shrink-0",children:e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded bg-zinc-800/50",children:[e.jsx(H,{className:"h-3 w-3 text-zinc-500"}),e.jsx(ne,{type:f?"text":"password",value:n,readOnly:!0,className:"flex-1 h-5 text-[10px] font-mono bg-transparent border-none p-0 text-zinc-400",placeholder:"No API key"}),e.jsx(d,{variant:"ghost",size:"icon",className:"h-5 w-5 text-zinc-500 hover:text-zinc-300",onClick:()=>u(!f),children:f?e.jsx(qe,{className:"h-3 w-3"}):e.jsx(Je,{className:"h-3 w-3"})}),e.jsx(d,{variant:"ghost",size:"icon",className:"h-5 w-5 text-zinc-500 hover:text-zinc-300",onClick:ze,children:e.jsx(le,{className:"h-3 w-3"})})]})})]}),e.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:se?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border-b border-zinc-800 bg-zinc-900/30",children:[e.jsx($,{variant:"outline",className:v("text-xs px-2 py-0.5 border-0 font-semibold",b==="GET"?"bg-sky-500/20 text-sky-400":"bg-emerald-500/20 text-emerald-400"),children:b}),e.jsxs("div",{className:"flex-1 flex items-center gap-1 px-3 py-1.5 rounded bg-zinc-800/50 font-mono text-sm",children:[e.jsx("span",{className:"text-zinc-500",children:"http://127.0.0.1:5000"}),e.jsx("span",{className:"text-zinc-100",children:p})]}),e.jsx(d,{size:"sm",className:"h-8 px-4 bg-emerald-600 hover:bg-emerald-700 text-white",onClick:Ne,disabled:K,children:K?e.jsx(ce,{className:"h-4 w-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"h-3.5 w-3.5 mr-1.5"}),"Send"]})})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"flex-1 flex flex-col border-r border-zinc-800 min-w-0",children:e.jsxs(ie,{defaultValue:"body",className:"flex-1 flex flex-col min-h-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-1.5 border-b border-zinc-800 bg-zinc-900/30",children:[e.jsxs(re,{className:"h-7 bg-transparent p-0 gap-2",children:[e.jsx(q,{value:"body",className:"h-6 px-2 text-xs data-[state=active]:bg-zinc-800 data-[state=active]:text-zinc-100 text-zinc-500",children:"Body"}),e.jsx(q,{value:"headers",className:"h-6 px-2 text-xs data-[state=active]:bg-zinc-800 data-[state=active]:text-zinc-100 text-zinc-500",children:"Headers"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-[10px] text-zinc-500 mr-2",children:"JSON"}),e.jsx(d,{variant:"ghost",size:"sm",className:"h-6 text-[10px] text-zinc-400 hover:text-zinc-100 hover:bg-zinc-800",onClick:be,children:"Prettify"})]})]}),e.jsx(J,{value:"body",className:"flex-1 m-0 overflow-hidden",children:e.jsxs("div",{className:"h-full flex bg-zinc-950",children:[e.jsx("div",{className:"w-10 bg-zinc-900/50 text-zinc-600 text-xs font-mono py-3 px-2 text-right select-none overflow-hidden border-r border-zinc-800",children:o.split(`
`).map((s,t)=>e.jsx("div",{className:"leading-5",children:t+1},t))}),e.jsx("textarea",{ref:pe,className:"flex-1 p-3 font-mono text-xs bg-transparent border-none outline-none resize-none text-zinc-100 leading-5",placeholder:'{"apikey": ""}',value:o,onChange:s=>ee(s.target.value),spellCheck:!1})]})}),e.jsx(J,{value:"headers",className:"flex-1 m-0 p-4 overflow-auto bg-zinc-950",children:e.jsxs("div",{className:"text-xs font-mono space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-500",children:"Content-Type:"}),e.jsx("span",{className:"text-zinc-300",children:"application/json"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-500",children:"Accept:"}),e.jsx("span",{className:"text-zinc-300",children:"application/json"})]})]})})]})}),e.jsx("div",{className:"flex-1 flex flex-col min-w-0",children:e.jsxs(ie,{defaultValue:"response",className:"flex-1 flex flex-col min-h-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-1.5 border-b border-zinc-800 bg-zinc-900/30",children:[e.jsxs(re,{className:"h-7 bg-transparent p-0 gap-2",children:[e.jsx(q,{value:"response",className:"h-6 px-2 text-xs data-[state=active]:bg-zinc-800 data-[state=active]:text-zinc-100 text-zinc-500",children:"Response"}),e.jsx(q,{value:"headers",className:"h-6 px-2 text-xs data-[state=active]:bg-zinc-800 data-[state=active]:text-zinc-100 text-zinc-500",children:"Headers"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs font-mono",children:[y!==null&&e.jsxs("span",{className:v("px-2 py-0.5 rounded",ke(y),Se(y)),children:[y," ",y>=200&&y<300?"OK":"Error"]}),W!==null&&e.jsxs("span",{className:"text-zinc-500 flex items-center gap-1",children:[e.jsx(Ue,{className:"h-3 w-3"}),W,"ms"]}),_!==null&&e.jsxs("span",{className:"text-zinc-500 flex items-center gap-1",children:[e.jsx(Ke,{className:"h-3 w-3"}),Ce(_)]}),e.jsxs(d,{variant:"ghost",size:"sm",className:"h-6 text-[10px] text-zinc-500 hover:text-zinc-100 hover:bg-zinc-800",onClick:ye,children:[e.jsx(De,{className:"h-3 w-3 mr-1"}),"cURL"]}),w&&e.jsx(d,{variant:"ghost",size:"icon",className:"h-6 w-6 text-zinc-500 hover:text-zinc-100",onClick:ve,children:e.jsx(le,{className:"h-3 w-3"})})]})]}),e.jsx(J,{value:"response",className:"flex-1 m-0 overflow-hidden",children:e.jsx("div",{className:"h-full flex bg-zinc-950",children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-10 bg-zinc-900/50 text-zinc-600 text-xs font-mono py-3 px-2 text-right select-none overflow-hidden border-r border-zinc-800",children:w.split(`
`).map((s,t)=>e.jsx("div",{className:"leading-5",children:t+1},t))}),e.jsx(Oe,{className:"flex-1 p-3",children:e.jsx("pre",{className:"text-xs font-mono whitespace-pre-wrap break-words leading-5",children:Ge(w).map((s,t)=>e.jsx("span",{className:$e(s.type),children:s.text},t))})})]}):e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center text-center",children:K?e.jsx(ce,{className:"h-8 w-8 text-zinc-700 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"h-10 w-10 text-zinc-800 mb-3"}),e.jsx("p",{className:"text-zinc-600 text-sm",children:"No response yet"}),e.jsx("p",{className:"text-zinc-700 text-xs mt-1",children:"Click Send to make a request"})]})})})}),e.jsx(J,{value:"headers",className:"flex-1 m-0 p-4 overflow-auto bg-zinc-950",children:Object.keys(M).length>0?e.jsx("div",{className:"text-xs font-mono space-y-2",children:Object.entries(M).map(([s,t])=>e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("span",{className:"text-zinc-500",children:[s,":"]}),e.jsx("span",{className:"text-zinc-300 break-all",children:t})]},s))}):e.jsx("div",{className:"text-xs text-zinc-600",children:"No headers to display"})})]})})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center bg-zinc-950",children:[e.jsx("img",{src:"/images/android-chrome-192x192.png",alt:"OpenAlgo",className:"w-16 h-16 mb-4"}),e.jsx("h2",{className:"text-lg font-semibold text-zinc-300 mb-2",children:"API Playground"}),e.jsx("p",{className:"text-zinc-500 text-sm mb-4",children:"Select an endpoint from the sidebar to get started"}),!n&&e.jsx(d,{variant:"outline",size:"sm",className:"border-zinc-700 text-zinc-300",asChild:!0,children:e.jsxs(V,{to:"/apikey",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Generate API Key"]})})]})})]})]})}export{ss as default};
