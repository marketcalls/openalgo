import{r as t,j as e}from"./vendor-react--vsXx8_n.js";import{t as r,B as d,e as m}from"./index-DzBD42tN.js";import{a as A}from"./admin-iEUgm_aY.js";import{A as K,b as Q,c as U,d as W,e as X,f as Z,g as $,h as ee}from"./alert-dialog-WXI1bS8l.js";import{C as u,a as p,b as se,c as ae,d as le}from"./card-Ywi_iHZP.js";import{C as te}from"./checkbox-DBlv3wZG.js";import{D as ie,b as re,c as de,d as ne,e as ce,f as oe}from"./dialog-Bcr5s5zH.js";import{I}from"./input-Czj9uzdI.js";import{L as g}from"./label-BQxrr3CD.js";import{S as w,a as L,b as E,c as Y,d as k}from"./select-erwAHFOz.js";import{T as he,a as xe,b as v,c as h,d as me,e as n}from"./table-BSQggPNp.js";import{A as je,am as ue,aC as pe,a4 as ge,j as ye,ag as fe}from"./vendor-icons-BPoFgeym.js";import{L as Ne}from"./vendor-router-CclZ5Z6W.js";import"./vendor-charts-l0_txfiz.js";import"./vendor-radix-DIebA-qg.js";const De=[{value:"TRADING_HOLIDAY",label:"Trading Holiday"},{value:"SETTLEMENT_HOLIDAY",label:"Settlement Holiday"},{value:"SPECIAL_SESSION",label:"Special Session"}];function Re(){const[c,O]=t.useState([]),[y,R]=t.useState([]),[C,F]=t.useState([]),[i,f]=t.useState(new Date().getFullYear()),[G,H]=t.useState(!0),[P,j]=t.useState(!1),[l,o]=t.useState({date:"",description:"",holiday_type:"TRADING_HOLIDAY",closed_exchanges:[]}),[b,S]=t.useState(!1),[x,N]=t.useState(null),[_,T]=t.useState(!1);t.useEffect(()=>{D(i)},[i]);const D=async s=>{H(!0);try{const a=await A.getHolidays(s);O(a.data),R(a.years),F(a.exchanges)}catch(a){console.error("Error fetching holidays:",a),r.error("Failed to load holidays")}finally{H(!1)}},B=async()=>{if(!l.date||!l.description){r.error("Please fill in date and description");return}if(l.holiday_type==="TRADING_HOLIDAY"&&l.closed_exchanges.length===0){r.error("Please select at least one exchange to close");return}S(!0);try{const s=await A.addHoliday({date:l.date,description:l.description,holiday_type:l.holiday_type,closed_exchanges:l.closed_exchanges});s.status==="success"?(r.success(s.message||"Holiday added successfully"),j(!1),o({date:"",description:"",holiday_type:"TRADING_HOLIDAY",closed_exchanges:[]}),D(i)):r.error(s.message||"Failed to add holiday")}catch(s){const a=s;r.error(a.response?.data?.message||"Failed to add holiday")}finally{S(!1)}},z=async()=>{if(x){T(!0);try{const s=await A.deleteHoliday(x.id);s.status==="success"?(r.success(s.message||"Holiday deleted successfully"),N(null),D(i)):r.error(s.message||"Failed to delete holiday")}catch(s){const a=s;r.error(a.response?.data?.message||"Failed to delete holiday")}finally{T(!1)}}},M=s=>{o(a=>({...a,closed_exchanges:a.closed_exchanges.includes(s)?a.closed_exchanges.filter(J=>J!==s):[...a.closed_exchanges,s]}))},V=()=>{o(s=>({...s,closed_exchanges:C}))},q=s=>{switch(s){case"TRADING_HOLIDAY":return e.jsx(m,{variant:"destructive",children:"Trading Holiday"});case"SETTLEMENT_HOLIDAY":return e.jsx(m,{variant:"secondary",children:"Settlement Holiday"});case"SPECIAL_SESSION":return e.jsx(m,{className:"bg-purple-500 hover:bg-purple-600",children:"Special Session"});default:return e.jsx(m,{variant:"outline",children:s})}};return G?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ne,{to:"/admin",className:"text-muted-foreground hover:text-foreground",children:e.jsx(je,{className:"h-4 w-4"})}),e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(ue,{className:"h-6 w-6"}),"Market Holidays"]})]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage trading holidays for all supported exchanges"})]}),e.jsxs(d,{onClick:()=>j(!0),children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Add Holiday"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(u,{children:e.jsxs(p,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:c.length}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Total Holidays (",i,")"]})]})}),e.jsx(u,{children:e.jsxs(p,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:c.filter(s=>s.holiday_type==="TRADING_HOLIDAY").length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Trading Holidays"})]})}),e.jsx(u,{children:e.jsxs(p,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:c.filter(s=>s.holiday_type!=="TRADING_HOLIDAY").length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Special Days"})]})})]}),e.jsxs(u,{children:[e.jsxs(se,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{children:"Holiday Calendar"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{variant:"outline",size:"icon",onClick:()=>f(s=>s-1),disabled:!y.includes(i-1),children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsxs(w,{value:i.toString(),onValueChange:s=>f(parseInt(s,10)),children:[e.jsx(L,{className:"w-[120px]",children:e.jsx(E,{})}),e.jsx(Y,{children:y.map(s=>e.jsx(k,{value:s.toString(),children:s},s))})]}),e.jsx(d,{variant:"outline",size:"icon",onClick:()=>f(s=>s+1),disabled:!y.includes(i+1),children:e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsxs(le,{children:[c.length," holidays in ",i]})]}),e.jsx(p,{children:e.jsx("div",{className:"border rounded-md",children:e.jsxs(he,{children:[e.jsx(xe,{children:e.jsxs(v,{children:[e.jsx(h,{children:"Date"}),e.jsx(h,{children:"Day"}),e.jsx(h,{children:"Description"}),e.jsx(h,{children:"Type"}),e.jsx(h,{children:"Closed Exchanges"}),e.jsx(h,{className:"w-[80px]",children:"Actions"})]})}),e.jsx(me,{children:c.length===0?e.jsx(v,{children:e.jsxs(n,{colSpan:6,className:"text-center text-muted-foreground py-8",children:["No holidays configured for ",i]})}):c.map(s=>e.jsxs(v,{children:[e.jsx(n,{className:"font-medium",children:s.date}),e.jsx(n,{children:s.day_name}),e.jsx(n,{children:s.description}),e.jsx(n,{children:q(s.holiday_type)}),e.jsx(n,{children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.closed_exchanges.length===0?e.jsx("span",{className:"text-muted-foreground text-sm",children:"-"}):s.closed_exchanges.map(a=>e.jsx(m,{variant:"outline",className:"text-xs",children:a},a))})}),e.jsx(n,{children:e.jsx(d,{size:"icon",variant:"ghost",className:"h-8 w-8 text-destructive hover:text-destructive",onClick:()=>N(s),children:e.jsx(fe,{className:"h-4 w-4"})})})]},s.id))})]})})})]}),e.jsx(ie,{open:P,onOpenChange:j,children:e.jsxs(re,{className:"max-w-md",children:[e.jsxs(de,{children:[e.jsx(ne,{children:"Add Holiday"}),e.jsx(ce,{children:"Add a new market holiday entry."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Date"}),e.jsx(I,{type:"date",value:l.date,onChange:s=>o({...l,date:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Description"}),e.jsx(I,{placeholder:"e.g., Republic Day",value:l.description,onChange:s=>o({...l,description:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Holiday Type"}),e.jsxs(w,{value:l.holiday_type,onValueChange:s=>o({...l,holiday_type:s}),children:[e.jsx(L,{children:e.jsx(E,{})}),e.jsx(Y,{children:De.map(s=>e.jsx(k,{value:s.value,children:s.label},s.value))})]})]}),l.holiday_type==="TRADING_HOLIDAY"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{children:"Closed Exchanges"}),e.jsx(d,{variant:"link",size:"sm",className:"h-auto p-0",onClick:V,children:"Select All"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:C.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{id:s,checked:l.closed_exchanges.includes(s),onCheckedChange:()=>M(s)}),e.jsx("label",{htmlFor:s,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:s})]},s))})]})]}),e.jsxs(oe,{children:[e.jsx(d,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsx(d,{onClick:B,disabled:b,children:b?"Adding...":"Add Holiday"})]})]})}),e.jsx(K,{open:!!x,onOpenChange:()=>N(null),children:e.jsxs(Q,{children:[e.jsxs(U,{children:[e.jsx(W,{children:"Delete Holiday?"}),e.jsxs(X,{children:['Are you sure you want to delete "',x?.description,'" on'," ",x?.date,"? This action cannot be undone."]})]}),e.jsxs(Z,{children:[e.jsx($,{children:"Cancel"}),e.jsx(ee,{onClick:z,disabled:_,children:_?"Deleting...":"Delete"})]})]})})]})}export{Re as default};
