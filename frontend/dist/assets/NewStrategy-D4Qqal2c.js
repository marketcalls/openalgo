import{r as c,j as e}from"./vendor-react-CCyQGCED.js";import{B as x,s as m}from"./index-NHrG-O_Z.js";import{s as w}from"./strategy-CA9O9jDh.js";import{A as q,a as F}from"./alert-BoGaKMRC.js";import{C as T,a as L,b as A,c as D,d as E}from"./card-Cn20bp_v.js";import{I as d}from"./input-BylzFlgY.js";import{L as n}from"./label-_1WWiomg.js";import{S as h,a as f,b as u,c as p,d as o}from"./select-DcHsBqkV.js";import{P as I,T as v}from"./strategy-B77UYF5_.js";import{N as k,Z as P,I as O}from"./vendor-icons-CCn_k3dF.js";import{a as M,L as V}from"./vendor-router-Dzc1xxhr.js";import"./vendor-charts-l0_txfiz.js";import"./vendor-radix-CYVJEJRR.js";function Y(){const g=M(),[y,j]=c.useState(!1),[t,i]=c.useState({name:"",platform:"",strategy_type:"intraday",trading_mode:"LONG",start_time:"09:15",end_time:"15:00",squareoff_time:"15:15"}),[r,S]=c.useState({}),b=()=>{const a={};if(t.name.trim()?t.name.length<3||t.name.length>50?a.name="Name must be between 3 and 50 characters":/^[a-zA-Z0-9\s\-_]+$/.test(t.name)||(a.name="Name can only contain letters, numbers, spaces, hyphens, and underscores"):a.name="Strategy name is required",t.platform||(a.platform="Please select a platform"),t.strategy_type==="intraday"){const s=t.start_time,l=t.end_time,N=t.squareoff_time;!s||!l||!N?a.time="All time fields are required for intraday strategies":s>=l?a.time="Start time must be before end time":l>=N&&(a.time="End time must be before square off time")}return S(a),Object.keys(a).length===0},C=async a=>{if(a.preventDefault(),!b()){m.error("Please fix the form errors","strategy");return}try{j(!0);const s=await w.createStrategy({name:t.name,platform:t.platform,strategy_type:t.strategy_type,trading_mode:t.trading_mode,...t.strategy_type==="intraday"&&{start_time:t.start_time,end_time:t.end_time,squareoff_time:t.squareoff_time}});s.status==="success"?(m.success("Strategy created successfully","strategy"),g(`/strategy/${s.data?.strategy_id}`)):m.error(s.message||"Failed to create strategy","strategy")}catch(s){const l=s instanceof Error?s.message:"Failed to create strategy";m.error(l,"strategy")}finally{j(!1)}},_=t.platform&&t.name?`${t.platform}_${t.name.toLowerCase().replace(/\s+/g,"_")}`:"";return e.jsxs("div",{className:"container mx-auto py-6 max-w-2xl space-y-6",children:[e.jsx(x,{variant:"ghost",asChild:!0,children:e.jsxs(V,{to:"/strategy",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Back to Strategies"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Create New Strategy"}),e.jsx("p",{className:"text-muted-foreground",children:"Set up a new webhook strategy to receive trading alerts"})]}),e.jsxs(T,{children:[e.jsxs(L,{children:[e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5"}),"Strategy Details"]}),e.jsx(D,{children:"Configure your webhook strategy settings"})]}),e.jsx(E,{children:e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"name",children:"Strategy Name"}),e.jsx(d,{id:"name",placeholder:"My Trading Strategy",value:t.name,onChange:a=>i({...t,name:a.target.value}),className:r.name?"border-red-500":""}),r.name&&e.jsx("p",{className:"text-sm text-red-500",children:r.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"3-50 characters. Letters, numbers, spaces, hyphens, and underscores only."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"platform",children:"Platform"}),e.jsxs(h,{value:t.platform,onValueChange:a=>i({...t,platform:a}),children:[e.jsx(f,{className:r.platform?"border-red-500":"",children:e.jsx(u,{placeholder:"Select platform"})}),e.jsx(p,{children:I.map(a=>e.jsx(o,{value:a.value,children:a.label},a.value))})]}),r.platform&&e.jsx("p",{className:"text-sm text-red-500",children:r.platform})]}),_&&e.jsxs(q,{children:[e.jsx(O,{className:"h-4 w-4"}),e.jsxs(F,{children:["Final strategy name:"," ",e.jsx("code",{className:"bg-muted px-1 rounded font-mono",children:_})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"strategy_type",children:"Strategy Type"}),e.jsxs(h,{value:t.strategy_type,onValueChange:a=>i({...t,strategy_type:a}),children:[e.jsx(f,{children:e.jsx(u,{placeholder:"Select type"})}),e.jsxs(p,{children:[e.jsx(o,{value:"intraday",children:"Intraday"}),e.jsx(o,{value:"positional",children:"Positional"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Intraday strategies have trading hours and auto square-off."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"trading_mode",children:"Trading Mode"}),e.jsxs(h,{value:t.trading_mode,onValueChange:a=>i({...t,trading_mode:a}),children:[e.jsx(f,{children:e.jsx(u,{placeholder:"Select mode"})}),e.jsx(p,{children:v.map(a=>e.jsx(o,{value:a.value,children:e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{children:a.label})})},a.value))})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:v.find(a=>a.value===t.trading_mode)?.description})]}),t.strategy_type==="intraday"&&e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/50",children:[e.jsx("h4",{className:"font-medium",children:"Trading Hours"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"start_time",children:"Start Time"}),e.jsx(d,{id:"start_time",type:"time",value:t.start_time,onChange:a=>i({...t,start_time:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"end_time",children:"End Time"}),e.jsx(d,{id:"end_time",type:"time",value:t.end_time,onChange:a=>i({...t,end_time:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"squareoff_time",children:"Square Off"}),e.jsx(d,{id:"squareoff_time",type:"time",value:t.squareoff_time,onChange:a=>i({...t,squareoff_time:a.target.value})})]})]}),r.time&&e.jsx("p",{className:"text-sm text-red-500",children:r.time}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Orders will only be placed during trading hours. Positions will be squared off at the specified time."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(x,{type:"button",variant:"outline",className:"flex-1",onClick:()=>g("/strategy"),children:"Cancel"}),e.jsx(x,{type:"submit",className:"flex-1",disabled:y,children:y?"Creating...":"Create Strategy"})]})]})})]})]})}export{Y as default};
